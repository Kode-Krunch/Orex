{"version":3,"file":"static/js/3988.f3b729f7.chunk.js","mappings":"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","sources":["views/Controls/Loader.js","views/Programming/PatternMaster/PatternEdit.js"],"sourcesContent":["import { Spinner } from 'components/ui';\r\nimport React from 'react';\r\n\r\nfunction Loader({ showLoader }) {\r\n  return (\r\n    <>\r\n      {showLoader ? (\r\n        <div className=\"dialog-overlay flex justify-center items-center z-50\">\r\n          <Spinner size=\"3.25rem\" />\r\n        </div>\r\n      ) : (\r\n        <></>\r\n      )}\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Loader;\r\n","import React, { useEffect, useState } from 'react';\r\nimport { useSelector } from 'react-redux';\r\nimport { Button, Card, Input, Select, Table, Tag } from 'components/ui';\r\nimport { FaRegSave, FaTrashAlt } from 'react-icons/fa';\r\nimport { MdArrowBack } from 'react-icons/md';\r\nimport {\r\n  apiGetpatterndetailsmasterbyid,\r\n  PostpatternDeatilsNew,\r\n  PostpatternNew,\r\n  PutpatternNew,\r\n} from 'services/ProgrammingService';\r\nimport {\r\n  formatOnHHMMSSFFBlur,\r\n  handleChangeWithFrameSingleValue,\r\n  openNotification,\r\n  parseDuration,\r\n} from 'views/Controls/GLOBALFUNACTION';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport Loader from 'views/Controls/Loader';\r\n\r\nconst { Tr, Th, Td, THead, TBody } = Table;\r\n\r\nconst MiniFormatOptions = Array.from({ length: 12 }, (_, i) => ({\r\n  value: `${(i + 1) * 5}`,\r\n  label: `${(i + 1) * 5}`,\r\n}));\r\n\r\nconst PatternEdit = () => {\r\n  const navigate = useNavigate();\r\n  const { Content } = useSelector((state) => state.base.common);\r\n  const ChannelSetting = useSelector(\r\n    (state) => state.auth.session.ChannelSetting,\r\n  );\r\n  const [settings, setSettings] = useState([]);\r\n  const [showLoader, setShowLoader] = useState(false);\r\n  const [name, setName] = useState(Content?.PatternName || '');\r\n  const [format, setFormat] = useState(Content?.minFormat || '');\r\n  const [commercialDuration, setCommercialDuration] = useState('');\r\n  const [breakNumber, setBreakNumber] = useState(1);\r\n  const [segmentNumber, setSegmentNumber] = useState(1);\r\n\r\n  const formatFramesToDuration = (frames) => {\r\n    const totalSeconds = Math.floor(frames / 25);\r\n    const remainingFrames = frames % 25;\r\n    const hours = Math.floor(totalSeconds / 3600);\r\n    const minutes = Math.floor((totalSeconds % 3600) / 60);\r\n    const seconds = totalSeconds % 60;\r\n\r\n    return [hours, minutes, seconds, remainingFrames]\r\n      .map((v) => String(v).padStart(2, '0'))\r\n      .join(':');\r\n  };\r\n\r\n  const parseDurationToFrames = (duration) => {\r\n    const [hours, minutes, seconds, frames] = duration.split(':').map(Number);\r\n    return hours * 3600 * 25 + minutes * 60 * 25 + seconds * 25 + frames;\r\n  };\r\n\r\n  const calculateTotalDuration = () => {\r\n    const totalFrames = settings.reduce((total, item) => {\r\n      return total + (item.EventType === 'BREAK' ? parseDurationToFrames(item.EventDuration) : 0);\r\n    }, 0);\r\n    return formatFramesToDuration(totalFrames);\r\n  };\r\n\r\n  const handleAddItem = (type) => {\r\n    const newItem = {\r\n      PatternCode: 0,\r\n      OrderNo: settings.length,\r\n      EventCode: 0,\r\n      EventType: type,\r\n      EventDuration: type === 'BREAK' ? commercialDuration : '00:00:00:00',\r\n      StartTime: new Date().toISOString(),\r\n      PatternType: 'NA',\r\n      SegComNumber: type === 'Content Segment' ? segmentNumber : 0,\r\n      ComBreakNumber: type === 'BREAK' ? breakNumber : 0,\r\n      IsActive: 1,\r\n    };\r\n\r\n    setSettings([...settings, newItem]);\r\n    if (type === 'BREAK') setBreakNumber(breakNumber + 1);\r\n    if (type === 'Content Segment') setSegmentNumber(segmentNumber + 1);\r\n  };\r\n\r\n  const handleRemoveItem = (index) => {\r\n    setSettings(settings.filter((_, i) => i !== index));\r\n  };\r\n\r\n  const fetchPatternDetails = async () => {\r\n    if (Content?.PatternCode) {\r\n      const response = await apiGetpatterndetailsmasterbyid(Content.PatternCode);\r\n      const formattedOptions = response.data.map((option) => ({\r\n        ...option,\r\n        IsActive: 1,\r\n      }));\r\n      setSettings(formattedOptions);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchPatternDetails();\r\n  }, []);\r\n\r\n  const handleSaveOrUpdate = async () => {\r\n    setShowLoader(true);\r\n    const saveData = {\r\n      PatternName: name,\r\n      ActualDuration: '08:59:12.638Z',\r\n      TotalDuration: calculateTotalDuration(),\r\n      minFormat: format,\r\n      NoOfSeg: 0,\r\n      CommercialDuration: calculateTotalDuration(),\r\n      SegmentDuration: '00:00:00:00',\r\n      TotalDurInSec: parseDuration(calculateTotalDuration()),\r\n      KillDate: '2024-12-27T08:59:12.638Z',\r\n      ProgramType: 0,\r\n      IsActive: 1,\r\n    };\r\n\r\n    const response = Content?.PatternCode\r\n      ? await PutpatternNew(saveData, Content.PatternCode)\r\n      : await PostpatternNew(saveData);\r\n\r\n    if (response.status === 200) {\r\n      const patternCode = Content?.PatternCode || response.data.PatternCode;\r\n      const mergedData = settings.map((item) => ({\r\n        ...item,\r\n        PatternCode: patternCode,\r\n        StartTime: new Date(),\r\n      }));\r\n\r\n      const detailsResponse = await PostpatternDeatilsNew(mergedData, patternCode);\r\n\r\n      if (detailsResponse.status === 200) {\r\n        openNotification('success', 'Pattern Saved Successfully');\r\n        navigate('/BreakPatternMaster')\r\n        setShowLoader(false);\r\n      } else {\r\n        openNotification('error', 'Pattern Details already exist');\r\n        setShowLoader(false);\r\n      }\r\n    } else {\r\n      openNotification('error', 'Pattern Name already exists');\r\n      setShowLoader(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Card header='Add Break Pattern'>\r\n      <Loader showLoader={showLoader} />\r\n      <div className=\"grid grid-cols-3 gap-4\">\r\n        <div>\r\n          <h6>Name</h6>\r\n          <Input size='sm' value={name} onChange={(e) => setName(e.target.value)} />\r\n        </div>\r\n        <div>\r\n          <h6>Format (Mins)</h6>\r\n          <Select\r\n            size='sm'\r\n            options={MiniFormatOptions}\r\n            value={MiniFormatOptions.find((option) => option.value === format)}\r\n            onChange={(option) => setFormat(option.value)}\r\n          />\r\n        </div>\r\n        <div>\r\n          <h6>Commercial Duration</h6>\r\n          <Input\r\n            size='sm'\r\n            value={commercialDuration}\r\n            onChange={(e) => handleChangeWithFrameSingleValue(e, setCommercialDuration)}\r\n            onBlur={(e) => setCommercialDuration(formatOnHHMMSSFFBlur(e.target.value, Number(ChannelSetting[0]?.FramePerSec || 24)))}\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      <div className='flex justify-end mt-5 mb-5'>\r\n        <Button variant='solid' size='sm' className='mr-2' onClick={() => handleAddItem('BREAK')}>\r\n          Add Break\r\n        </Button>\r\n        <Button variant='twoTone' size='sm' onClick={() => handleAddItem('Content Segment')}>\r\n          Add Segment\r\n        </Button>\r\n      </div>\r\n\r\n      <Card header='Pattern Details'>\r\n        <Table compact borderlessRow={false}>\r\n          <THead>\r\n            <Tr>\r\n              <Th>Sr No</Th>\r\n              <Th>EventType</Th>\r\n              <Th>EventDuration</Th>\r\n              <Th>SegComNumber</Th>\r\n              <Th>ComBreakNumber</Th>\r\n              <Th>Action</Th>\r\n            </Tr>\r\n          </THead>\r\n          <TBody>\r\n            {settings.length > 0 ? (\r\n              settings.map((setting, index) => (\r\n                <Tr key={index}>\r\n                  <Td>{setting.OrderNo + 1}</Td>\r\n                  <Td>{setting.EventType}</Td>\r\n                  <Td>{setting.EventDuration}</Td>\r\n                  <Td>{setting.SegComNumber}</Td>\r\n                  <Td>{setting.ComBreakNumber}</Td>\r\n                  <Td>\r\n                    <Button\r\n                      size='xs'\r\n                      type='button'\r\n                      onClick={() => handleRemoveItem(index)}\r\n                      icon={<FaTrashAlt />}\r\n                    />\r\n                  </Td>\r\n                </Tr>\r\n              ))\r\n            ) : (\r\n              <Tr>\r\n                <Td colSpan='6'>No Rows Found</Td>\r\n              </Tr>\r\n            )}\r\n          </TBody>\r\n        </Table>\r\n      </Card>\r\n\r\n      <div className='flex justify-between mt-5 mb-5'>\r\n        <div className='flex items-center space-x-2'>\r\n          <Button size='sm' className='mr-2' icon={<MdArrowBack />} onClick={() => navigate('/BreakPatternMaster')}>\r\n            Discard\r\n          </Button>\r\n          <Button\r\n            variant='solid'\r\n            size='sm'\r\n            icon={<FaRegSave />}\r\n            onClick={handleSaveOrUpdate}\r\n          >\r\n            Save\r\n          </Button></div>\r\n        <Tag\r\n          showCloseButton={false}\r\n          className=\"text-xl bg-emerald-100 text-emerald-600 dark:bg-emerald-500/20 dark:text-emerald-100 border-0 rounded\"\r\n        >\r\n          Total Duration: {calculateTotalDuration()}\r\n        </Tag>\r\n      </div>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default PatternEdit;\r\n"],"names":["showLoader","className","size","Tr","Th","Td","THead","TBody","Table","MiniFormatOptions","Array","from","length","_","i","value","label","navigate","useNavigate","Content","useSelector","state","base","common","ChannelSetting","auth","session","settings","setSettings","useState","setShowLoader","name","setName","PatternName","format","setFormat","minFormat","commercialDuration","setCommercialDuration","breakNumber","setBreakNumber","segmentNumber","setSegmentNumber","calculateTotalDuration","frames","totalSeconds","Math","floor","remainingFrames","map","v","String","padStart","join","formatFramesToDuration","reduce","total","item","EventType","duration","hours","minutes","seconds","split","Number","parseDurationToFrames","EventDuration","handleAddItem","type","newItem","PatternCode","OrderNo","EventCode","StartTime","Date","toISOString","PatternType","SegComNumber","ComBreakNumber","IsActive","useEffect","async","formattedOptions","apiGetpatterndetailsmasterbyid","data","option","fetchPatternDetails","header","onChange","e","target","options","find","handleChangeWithFrameSingleValue","onBlur","formatOnHHMMSSFFBlur","FramePerSec","variant","onClick","compact","borderlessRow","setting","index","filter","handleRemoveItem","icon","colSpan","saveData","ActualDuration","TotalDuration","NoOfSeg","CommercialDuration","SegmentDuration","TotalDurInSec","parseDuration","KillDate","ProgramType","response","PutpatternNew","PostpatternNew","status","patternCode","mergedData","PostpatternDeatilsNew","openNotification","showCloseButton"],"sourceRoot":""}