import React, { useState } from 'react';
import ReportsTableContext from './ReportsTableContext';
import { reportsTableEnum } from '../enums/ReportsTableEnums';

const ReportsTableContextProvider = ({ children }) => {
  /* STATES */
  // Table States
  const [originalTableData, setOriginalTableData] = useState([]);
  const [tableName, setTableName] = useState('');
  const [formattedTableData, setFormattedTableData] = useState([]);
  const [originalTableColumns, setOriginalTableColumns] = useState([]);
  const [originalTableExportFileName, setOriginalTableExportFileName] =
    useState('');
  const [selectedFilters, setSelectedFilters] = useState([]);
  const [externalGlobalFilter, setExternalGlobalFilter] = useState(null);
  const [fetchedColumnSetting, setFetchedColumnSetting] = useState([]);
  // Groupby States
  const [groupByOptions, setGroupbyOptions] = useState([]);
  const [selectedGroups, setSelectedGroups] = useState([]);
  const [groupedTableData, setGroupedTableData] = useState({
    type: 'group',
    data: [],
  });
  // UI States
  const [showGlobalToolbar, setShowGlobalToolbar] = useState(false);
  const [curView, setCurView] = useState(reportsTableEnum.currentView.ORIGINAL);
  const [toolbarOptions, setToolbarOptions] = useState(null);
  const [toolbarExtraContent, setToolbarExtraContent] = useState(null);
  const [exportFile, setExportFile] = useState(true);
  const [tableType, setTableType] = useState(
    reportsTableEnum.tableTypes.DEFAULT,
  );
  const [isGroupedTableAccordionTabOpen, setIsGroupedTableAccordionTabOpen] =
    useState(false);
  const [hideMaxPageSelector, setHideMaxPageSelector] = useState(false);

  /* HELPER FUNCTIONS */
  const resetGroupedTableData = () => {
    try {
      setGroupedTableData({
        type: 'group',
        data: [],
      });
    } catch (error) {
      throw error;
    }
  };

  return (
    <ReportsTableContext.Provider
      value={{
        originalTableData,
        tableName,
        formattedTableData,
        originalTableColumns,
        originalTableExportFileName,
        selectedFilters,
        externalGlobalFilter,
        fetchedColumnSetting,
        groupByOptions,
        selectedGroups,
        groupedTableData,
        showGlobalToolbar,
        curView,
        toolbarOptions,
        toolbarExtraContent,
        exportFile,
        tableType,
        isGroupedTableAccordionTabOpen,
        hideMaxPageSelector,
        setOriginalTableData,
        setTableName,
        setFormattedTableData,
        setOriginalTableColumns,
        setOriginalTableExportFileName,
        setSelectedFilters,
        setExternalGlobalFilter,
        setFetchedColumnSetting,
        setGroupbyOptions,
        setSelectedGroups,
        setGroupedTableData,
        setShowGlobalToolbar,
        setCurView,
        resetGroupedTableData,
        setToolbarOptions,
        setToolbarExtraContent,
        setExportFile,
        setTableType,
        setIsGroupedTableAccordionTabOpen,
        setHideMaxPageSelector,
      }}
    >
      {children}
    </ReportsTableContext.Provider>
  );
};

export default ReportsTableContextProvider;
