import { Button, Dialog } from 'components/ui';
import React, { useContext } from 'react';
import {
  getUniqueObjects,
  openNotification,
} from 'views/Controls/GLOBALFUNACTION';
import { operationTypesEnum } from 'views/Scheduling/Scheduler/enum';
import SchedulerContext from 'views/Scheduling/SchedulerOld/context/SchedulerContext';
// import SchedulerContext from 'views/Scheduling/Scheduler/context/SchedulerContext';

function ReplaceAllDialog({ isDialogOpen, setIsDialogOpen }) {
  /* CONTEXT */
  const {
    schedulingTableSelectedRows,
    secondaryTableSelectedRows,
    executeOperation,
  } = useContext(SchedulerContext);

  /* EVENT HANDLERS */
  const onDialogClose = () => setIsDialogOpen(false);

  const handleReplaceAll = () => {
    try {
      executeOperation({
        operation: operationTypesEnum.REPLACE_ALL_ROW,
      });
      openNotification('success', 'Events replaced successfully');
      setIsDialogOpen(false);
    } catch (error) {
      openNotification('danger', 'Something went wrong while replacing events');
      console.error(error);
    }
  };

  return (
    <>
      {secondaryTableSelectedRows.length > 0 && schedulingTableSelectedRows && (
        <Dialog
          isOpen={isDialogOpen}
          onClose={onDialogClose}
          onRequestClose={onDialogClose}
        >
          <h5 className="mb-4">Replace All</h5>
          <p>
            Do you wish to replace below items with{' '}
            <span className="font-semibold">
              "{secondaryTableSelectedRows[0].Event_Name}"
            </span>
            ?
          </p>
          <div className="mt-6 flex flex-col gap-3">
            {getUniqueObjects(schedulingTableSelectedRows, 'Event_Name').map(
              (row) => (
                <div
                  key={row.rowId}
                  className="flex items-center gap-3 font-semibold"
                >
                  <span className="bg-gray-600 rounded-full w-2.5 h-2.5"></span>
                  <span>{row.Event_Name}</span>
                </div>
              ),
            )}
          </div>
          <div className="text-right mt-8">
            <Button variant="solid" onClick={handleReplaceAll}>
              Replace All
            </Button>
          </div>
        </Dialog>
      )}
    </>
  );
}

export default ReplaceAllDialog;
