import React, { forwardRef, useEffect, useRef, useState } from 'react';
import { Field, Form, Formik } from 'formik';
import * as Yup from 'yup';
import {
  Button,
  Card,
  Checkbox,
  DatePicker,
  FormContainer,
  FormItem,
  Input,
  Notification,
  Select,
  Steps,
  Switcher,
  Upload,
} from 'components/ui';
import Tabs from 'components/ui/Tabs';
import {
  compareDates,
  formatOnHHMMSSBlur,
  handleChangeWithOutFrameNew,
  hideCursorLoader,
  isTimeBetween,
  showCursorLoader,
} from 'views/Controls/GLOBALFUNACTION';
import { convertDateToYMD, validate } from 'components/validators';
import { StickyFooter } from 'components/shared';
import { useDispatch, useSelector } from 'react-redux';
import {
  apiGetbindstartnendtime,
  apiGetdealdetailId,
  apiGetsponsortypemasterdrop,
  apiGetspottypemasterdrop,
  apiGetExchangeRatesForBaseCurrency,
  apiUSP_Sch_DealConsumptionCheck,
  apiUSP_Sch_DealConsumptionMonthwise,
  apidealmasterBYID,
} from 'services/DealServices';
import {
  apiGetContentmasterDrop,
  apiGetSpotSpotPreferencedrop,
  apiGetfpcorgrepmasterdrop,
  apiGetweekdaysweekendsmaster,
  apisendnotification,
} from 'services/ProgrammingService';
import { apiGetNTCtypedropdown } from 'services/NTCService';
import {
  apiGetAgencyCityIDCITY,
  apiGetChannelmasterdrop,
  apiGetCurrencymasterdrop,
  apiGetZonemasterDrop,
  apiGetclientcitymasterdropmaster,
  apiGetempmasterdropmaster,
} from 'services/MasterService';
import {
  DealCard,
  DealDetailsComponentAdd,
  DealDetailsComponentEdit,
} from './DealDetailsComponent';
import './App.css';
import { setdateForm } from 'store/locale/localeSlice';
import DealHeader from './DealHeader';
import NotificationToast from 'views/Controls/NotificationToast';
import { toast as toa } from 'components/ui';
import appConfig from 'configs/app.config';
import FileItem from 'components/ui/Upload/FileItem';
import { useNavigate } from 'react-router-dom';
import dayjs from 'dayjs';
import {
  PostDealMaster,
  PutDealMaster,
  apiGetAgencygetagencyasperclient,
  apiGetDealtypemasterDrop,
  apiGetPayroutemaster,
  apiGetTimeBandmasterdrop3,
  apiGetclientmasterdropmaster,
  apiGetdeallineItemtypemasterDrop,
} from 'services/CreditcontrolService';
import { HiBackspace } from 'react-icons/hi';

import { AiOutlineSave } from 'react-icons/ai';
import { IoMdArrowRoundForward } from 'react-icons/io';
import Loader from 'views/Controls/Loader';
import { isMultiChannelSelectionEnabled } from './constants';
import { CLIENT } from 'views/Controls/clientListEnum';
import MultiCurrencyDropdown from './MultiCurrencyDropdown';
import { apiCallstoreprocedure } from 'services/CommonService';
const { TabNav, TabList, TabContent } = Tabs;

/* CONSTANTS */
const ContentDemo = [{ value: '', label: 'Data Not Found' }];
const maxUpload = 1;
const SECONDS_FOR_RATE_OPTIONS = [
  { value: 10, label: '10 Seconds' },
  { value: 20, label: '20 Seconds' },
  { value: 30, label: '30 Seconds' },
  { value: 40, label: '40 Seconds' },
  { value: 50, label: '50 Seconds' },
];
const IS_CHANNEL_SEL_ENABLED_FOR_DEAL_DETAILS = true;

const DealMasterAdd = forwardRef(() => {
  /* REDUX */
  const Channel = useSelector((state) => state.locale.selectedChannel);
  const channelOptions = useSelector((state) => state.locale.channelList);
  const LoginId = useSelector((state) => state.auth.session.LoginId);
  const { Content } = useSelector((state) => state.base.common);
  const token = useSelector((state) => state.auth.session.token);
  const Username = useSelector((state) => state.auth.session.Username);
  const dispatch = useDispatch();

  /* STATES */
  const [showLoader, setShowLoader] = useState(false);
  const [datg, setdatg] = useState(null);
  const [CurrencySysmbol, setCurrencySysmbol] = useState('');
  const [SponsorType, setSponsorType] = useState([]);
  const [ContentList, setContentList] = useState([]);
  const [SpotType, setSpotType] = useState([]);
  const [NTCType, setNTCType] = useState([]);
  const [DealType, setDealType] = useState([]);
  const [Client, setClient] = useState([]);
  const [ClientCity, setClientCity] = useState([]);
  const [AgencyCity, setAgencyCity] = useState([]);
  const [Currency, setCurrency] = useState([]);
  const [PayRoute, setPayRoute] = useState([]);
  const [Executive, setExecutive] = useState([]);
  const [Weekdays, setWeekdays] = useState([]);
  const [Zone, setZone] = useState([]);
  const [Agency, setAgency] = useState([]);
  const [TimeBand, setTimeBand] = useState([]);
  const [SpotPreference, setSpotPreference] = useState([]);
  const [RODP, setRODP] = useState([]);
  const [formState, setFormState] = useState({});
  const [secondsForRate, setSecondsForRate] = useState(10);
  const [formStateCopy, setFormStateCopy] = useState({});
  const [findId, setfindId] = useState();
  const [DataDisplay, setDataDisplay] = useState([]);
  const [Start, setStart] = useState([]);
  const [End, setEnd] = useState([]);
  const [Menu, setMenu] = useState([]);
  const [chart, setchart] = useState([]);
  const [chart2, setchart2] = useState([]);
  const [selectedFile, setSelectedFile] = useState(null);
  const [dateVdaid, setdateVdaid] = useState(true);
  const [currentTab, setCurrentTab] = useState(Content.length != 0 ? 0 : 2);
  const [step, setStep] = useState(0);
  const [step2, setStep2] = useState(3);
  const [collapse, setCollapse] = useState(false);
  const [Hover, setHover] = useState(false);
  const [channelsSelectorOptions, setChannelsSelectorOptions] = useState([]);
  const [fetchedExchRatesForBaseCur, setFetchedExchRatesForBaseCur] =
    useState(null);
  const [actualExchRatesForBaseCur, setActualExchRatesForBaseCur] = useState(
    [],
  );
  console.log('selectedFile', selectedFile);

  /* HOOKS */
  const formikRef = useRef();
  const navigate = useNavigate();
  const formSubmit = () => {
    formikRef.current?.submitForm();
  };
  const toast = useRef(null);

  /* USE EFFECTS */
  useEffect(() => {
    setShowLoader(true);
    (async () => {
      setChannelsSelectorOptions(await getChannelsSelectorOptions());
    })();
    dispatch(setdateForm(['value', 'Deal Master']));
    const gboxElement2 = document.getElementsByClassName('Gbox2')[0];
    if (gboxElement2) {
      gboxElement2.style.display = 'block';
    } // Optionally, you might want to revert the change when the component unmounts
    setShowLoader(false);
    (async () => {
      const response = await apidealmasterBYID(Content.DealNumber);
      if (response.status === 200) {
        setActualExchRatesForBaseCur(response.data.Currencies);
      } else setActualExchRatesForBaseCur([]);
    })();
    return () => {
      if (gboxElement2) {
        gboxElement2.style.display = 'none';
      }
    };
  }, []);

  useEffect(() => {
    setShowLoader(true);
    (async () => {
      if (Content && !Array.isArray(Content)) {
        ClientPlaceCodeGetApi(Content.ClientCode);
        AgencyCityCodeGetApi(Content.AgencyCode);
        Getagencyasperclient(Content.ClientCode);
        const data = await apiUSP_Sch_DealConsumptionCheck(Content.DealNumber);
        const keys = Object.keys(data.data[0]);
        const valuess = Object.values(data.data[0]);
        setchart([keys, valuess]);
        // const data2 = await apiUSP_Sch_DealConsumptionMonthwise(
        //   Content.DealNumber,
        // );
        setchart2([keys, valuess]);
        const data1 = await apiGetdealdetailId(Content.DealNumber);
        setShowLoader(false);
        const transformedData = data1.data.map((item) => ({
          channel: channelOptions.filter(
            (channel) => channel.ChannelCode === item.ChannelCode,
          )[0],
          name: item.DealLineItemTypeCode,
          EndTime: item.EndTime,
          StartTime: item.StartTime,
          NTCTotalSpots: item.NTCTotalSpots,
          TotalSpots: item.TotalSpots,
          LineItemCancelStatus: item.LineItemCancelStatus,
          ConsumedAmount: item.ConsumedAmount,
          ConsumedSeconds: item.ConsumedSeconds,
          BalancedAmount: item.BalancedAmount,
          BalancedSeconds: item.BalancedSeconds,
          TimeBandCode: {
            value: item.TimeBandCode,
            label: item.TimeBandName || 'NA',
          },
          SponsorTypeCode: {
            value: item.SponsorTypeCode,
            label: item.SponsorTypeName || 'NA',
          },
          NTCTypeCode: {
            value: item.NTCTypeCode,
            label: item.NTCTypeName || 'NA',
          },
          ContentCode: {
            value: item.ContentCode,
            label: item.ContentName || 'NA',
          },
          OriginalRepeatCode: {
            value: item.OriginalRepeatCode,
            label: item.OriginalRepeatName || 'NA',
          },
          StartTimeDrop: {
            value: item.StartTime,
            label: item.StartTime || 'NA',
          },
          EndTimeDrop: {
            value: item.EndTime,
            label: item.EndTime || 'NA',
          },
          SpotTypeCode: {
            value: item.SpotTypeCode,
            label: item.SpotTypeName || 'NA',
          },
          NoWeeks: item.NoWeeks,
          WeekDayCode: {
            value: item.WeekdaysCode,
            label: item.WeekdaysName,
          },
          IsNTC: item.IsNTC,
          Rate: item.Rate,
          Second: item.Seconds,
          Amount: item.Amount,
          NetAmount: item.NetAmount,
          InternalRate: item.InternalRate,
          LineItemRemark: item.LineItemRemark,
          DealLineItemNo: item.DealLineItemNo,
          SpotPreferenceCode: {
            value: item.SpotPreferenceCode,
            label: item.SpotPreferenceName,
          },
          DealLineItemType: {
            value: item.DealLineItemTypeCode,
            label: item.DealLineItemTypeName,
          },
        }));
        setDataDisplay(transformedData);
      }
    })();
    setShowLoader(false);
  }, [Content]);

  useEffect(() => {
    if (formState.channel) {
      (async (values) => {
        const Content = await apiCallstoreprocedure('USP_Deal_GetProgramList', {
          LocationCode: formState.channel.value.split("-")[1],
          ChannelCode: formState.channel.value.split("-")[0],
          FromDate: datg?.DealPeriodFromDate,
          ToDate: datg?.DealPeriodToDate,
        });
        const formattedOptions = Content.data.map((option) => ({
          value: option.ContentCode,
          label: option.ContentName,
        }));
        setContentList(formattedOptions);
      })();
    }
    else {
      (async (values) => {
        const Content = await await apiCallstoreprocedure('USP_Deal_GetProgramList', {
          LocationCode: Channel.LocationCode,
          ChannelCode: Channel.ChannelCode,
          FromDate: datg?.DealPeriodFromDate,
          ToDate: datg?.DealPeriodToDate,
        });

        const formattedOptions = Content.data.map((option) => ({
          value: option.ContentCode,
          label: option.ContentName,
        }));
        setContentList(formattedOptions);
      })();
    }
  }, [formState.channel]);

  useEffect(() => {
    (async (values) => {
      const Client = await apiGetclientmasterdropmaster(values);
      const formattedOptions = Client.data.map((option) => ({
        value: option.ClientCode,
        label: option.ClientName,
      }));
      setClient(formattedOptions);
    })();
    (async (values) => {
      const Menu = await apiGetdeallineItemtypemasterDrop(values);
      const formattedOptions = Menu.data.map((option) => ({
        value: option.DealLineItemTypeCode,
        label: option.DealLineItemTypeName,
      }));
      setMenu(formattedOptions);
    })();
    (async (values) => {
      const PayRoute = await apiGetPayroutemaster(values);
      const formattedOptions = PayRoute.data.map((option) => ({
        value: option.PayRouteCode,
        label: option.PayRouteName,
        AgencyShare: option.AgencyShare,
      }));
      setPayRoute(formattedOptions);
    })();
    (async () => {
      try {
        const Currency = await apiGetCurrencymasterdrop();
        if (Currency && Currency.data) {
          const formattedOptions = Currency.data.map((option) => ({
            value: option.CurrencyCode,
            label: option.CurrencyName,
            symbol: option.CurrencySymbol, // Make sure keys are consistent (using 'symbol' instead of 'Symbol')
            shortName: option.ShortName,
          }));

          const Menur = formattedOptions.find(
            (obj) => obj.value == Content.CurrencyCode,
          );

          if (Menur) {
            setCurrencySysmbol(Menur.symbol); // Ensure correct key usage here as well
          } else {
            console.error(
              `Currency code ${Content.CurrencyCode} not found in the options`,
            );
          }
          setCurrency(formattedOptions);
          await setExchRatesForBaseCurFn(Menur.shortName);
        } else {
          console.error('No data received from apiGetCurrencymasterdrop');
        }
      } catch (error) {
        console.error('Error fetching currency data:', error);
      }
    })();

    (async (values) => {
      const DealType = await apiGetDealtypemasterDrop(values);
      const formattedOptions = DealType.data.map((option) => ({
        value: option.DealTypeCode,
        label: option.DealTypeName,
      }));
      setDealType(formattedOptions);
    })();

    (async (values) => {
      const Zone = await apiGetZonemasterDrop(values);
      const formattedOptions = Zone.data.map((option) => ({
        value: option.ZoneCode,
        label: option.ZoneName,
      }));
      setZone(formattedOptions);
    })();

    (async (values) => {
      const Executive = await apiGetempmasterdropmaster(values);
      const formattedOptions = Executive.data.map((option) => ({
        value: option.EmployeeCode,
        label: option.Emp_FirstName,
      }));
      setExecutive(formattedOptions);
    })();

    (async (values) => {
      const SponsorTyp = await apiGetsponsortypemasterdrop(values);
      const formattedOptions = SponsorTyp.data.map((option) => ({
        value: option.SponsorTypeCode,
        label: option.SponsorTypeName,
      }));
      setSponsorType(formattedOptions);
    })();

    (async (values) => {
      const SpotType = await apiGetspottypemasterdrop(values);
      const formattedOptions = SpotType.data.map((option) => ({
        value: option.SpotTypeCode,
        label: option.SpotTypeName,
      }));
      setSpotType(formattedOptions);
    })();
    (async (values) => {
      const NTCType = await apiGetNTCtypedropdown(values);
      const formattedOptions = NTCType.data.map((option) => ({
        value: option.NTCTypeCode,
        label: option.NTCTypeName,
      }));
      setNTCType(formattedOptions);
    })();
    (async (values) => {
      const Weekdays = await apiGetweekdaysweekendsmaster(values);
      const formattedOptions = Weekdays.data.map((option) => ({
        value: option.WeekdaysCode,
        label: option.WeekdaysName,
      }));
      setWeekdays(formattedOptions);
    })();
    (async (values) => {
      const TimeBand = await apiGetfpcorgrepmasterdrop(values);
      const formattedOptions = TimeBand.data.map((option) => ({
        value: option.OriginalRepeatCode,
        label: option.OriginalRepeatName,
      }));
      setTimeBand(formattedOptions);
    })();
    (async (values) => {
      const SpotSpotPreference = await apiGetSpotSpotPreferencedrop(values);
      const formattedOptions = SpotSpotPreference.data.map((option) => ({
        value: option.SpotPreferenceCode,
        label: option.SpotPreferenceName,
      }));
      setSpotPreference(formattedOptions);
    })();

    (async (values) => {
      const TimeBand = await apiGetTimeBandmasterdrop3(values);
      const formattedOptions = TimeBand.data.map((option) => ({
        value: option.TimeBandCode,
        StartTime: option.StartTime,
        EndTime: option.EndTime,
        label: option.TimeBandName,
      }));
      setRODP(formattedOptions);
    })();
  }, []);

  useEffect(() => {
    if (Content.ChannelCode) {
      if (
        !(
          Channel.ChannelCode == Content.ChannelCode &&
          Channel.LocationCode == Channel.LocationCode
        )
      ) {
        navigate('/DealMaster');
      }
    }
  }, [Channel]);

  useEffect(() => {
    if (formState.ContentCode?.value) {
      Bindstartnendtime(
        formState.ContentCode?.value,
        formState.OriginalRepeatCode?.value,
        formState?.channel?.value?.split("-")[0] ? formState?.channel?.value?.split("-")[0] : Channel.ChannelCode
      );
    }
  }, [formState.ContentCode?.value, formState.OriginalRepeatCode?.value,]);

  useEffect(() => {
    if (formState.Rate && formState.Second && secondsForRate) {
      calculateValue(formState.Rate, formState.Second);
    }
  }, [secondsForRate]);

  /* HELPER FUNCTIONS */

  const openNotification = (message, type, duration) => {
    return toa.push(
      <NotificationToast message={message} type={type} duration={duration} />,
    );
  };

  const triggerMessage = (msg) => {
    toa.push(
      <Notification type="success" duration={2000}>
        {msg}
      </Notification>,
      {
        placement: 'top-center',
      },
    );
  };

  const beforeUpload = (file, fileList) => {
    let valid = true;
    const MAX_FILE_SIZE = 500000;
    if (Number(fileList.length) == 0) {
      triggerMessage('Your file has been uploaded');
      setSelectedFile(file[0]);
    }
    if (fileList.length >= maxUpload) {

      return `You can only upload ${maxUpload} file(s)`;

    }
    if (file) {
      for (const f of file) {
        if (f.size >= MAX_FILE_SIZE) {
          setSelectedFile(null);
          valid = 'Upload image cannot more then 500kb!';
        }
      }
    }

    return valid;
  };

  const uploadFolder = async (DealCode, DealNumber,) => {
    const headersList = {
      Accept: '*/*',
      Authorization: `Bearer ${token}`,
    };
    const bodyContent = new FormData();
    try {
      const arrayBuffer = await selectedFile.arrayBuffer();
      const blob = new Blob([arrayBuffer], { type: selectedFile.type });
      bodyContent.append('files', blob, selectedFile.name);

      const response = await fetch(
        `${appConfig.apiPrefix}/dealmaster/uploadattachment/${DealNumber}?Dealcode=${DealCode}`,
        {
          method: 'POST',
          body: bodyContent,
          headers: headersList,
        },
      );

      if (response.status == 200) {
        closeAfter2000ms();
      } else {
        console.error('Error uploading file:', response.statusText);
      }
    } catch (error) {
      console.error('Error uploading file:', error);
    }

  };

  async function getChannelsSelectorOptions() {
    try {
      let channelsSelectorOptions = [];
      const resp = await apiGetChannelmasterdrop(LoginId);
      if (resp.status === 200) {
        channelsSelectorOptions = resp.data.map((item) => ({
          value: item.ChannelCode + '-' + item.LocationCode,
          label: item.LocationName + ' ' + item.ChannelName,
          ChannelCode: item.ChannelCode,
          LocationCode: item.LocationCode,
          ChannelName: item.ChannelName,
          ColorClass: 'bg-rose-500',
          LocationName: item.LocationName,
          imgPath: item.Channel_Image,
        }));
      } else if (!resp.status === 204) {
        openNotification(
          'danger',
          `Unable to fetch channels. Server responded with status code ${resp.status}`,
        );
      }
      return channelsSelectorOptions;
    } catch (error) {
      throw error;
    }
  }

  function DealLineAddValidation(LineData, currentTab) {
    if (currentTab == 1) {
      //Sponsor
      if (!LineData?.SponsorTypeCode?.value > 0) {
        openNotification('Please Select Sponsor Type!!', 'danger');
        return false;
      }
      if (!LineData.ContentCode?.value > 0) {
        openNotification('Please Select Program!!', 'danger');
        return false;
      }
      if (!LineData.OriginalRepeatCode?.value > 0) {
        openNotification('Please Select Original/Repeat!!', 'danger');
        return false;
      }
      if (!LineData.StartTime > 0) {
        openNotification('Please Select Start Time!!', 'danger');
        return false;
      }
      if (!LineData.EndTime > 0) {
        openNotification('Please Select End Time!!', 'danger');
        return false;
      }
      if (!LineData?.Second > 0) {
        openNotification('Please enter Seconds!!', 'danger');
        return false;
      }
      if (!LineData?.NoWeeks > 0) {
        openNotification('Please Select No of Week!!', 'danger');
        return false;
      }
    }
    if (currentTab == 2) {
      //RODP
      if (LineData?.IsCommited == 1) {
        if (!LineData?.CommitedStartTime || !LineData?.CommitedEndTime) {
          openNotification('Please enter Commited Time !!', 'danger');
          return false;
        }
      }
      if (!LineData?.Second > 0) {
        openNotification('Please enter Seconds!!', 'danger');
        return false;
      }
      if (!LineData.TimeBandCode?.value > 0) {
        openNotification('Please Select TimeBand!!', 'danger');
        return false;
      }
      if (!LineData.Second > 0) {
        openNotification('Please enter Seconds!!', 'danger');
        return false;
      }
      if (LineData?.SpotPreferenceCode <= 0) {
        openNotification('Please select Spot Preference !!', 'danger');
        return false;
      }
    }
    if (currentTab == 3) {
      //Program wise
      if (!LineData.ContentCode?.value > 0) {
        openNotification('Please Select Program!!', 'danger');
        return false;
      }
      if (!LineData.OriginalRepeatCode?.value > 0) {
        openNotification('Please Select Original/Repeat!!', 'danger');
        return false;
      }
      if (!LineData.StartTime > 0) {
        openNotification('Please Select Start Time!!', 'danger');
        return false;
      }
      if (!LineData.EndTime > 0) {
        openNotification('Please Select End Time!!', 'danger');
        return false;
      }
    }
    if (currentTab == 4) {
      //NTC
      if (!LineData.TimeBandCode?.value > 0) {
        openNotification('Please Select TimeBand!!', 'danger');
        return false;
      }

      if (!LineData.NTCTypeCode?.value > 0) {
        openNotification('Please Select NTC Type!!', 'danger');
        return false;
      }
    }
    if (currentTab == 5) {
      //Slot Wise
      if (!LineData.ContentCode?.value > 0) {
        openNotification('Please Select Program!!', 'danger');
        return false;
      }
      if (!LineData?.TotalSpots > 0) {
        openNotification('Please enter Slot!!', 'danger');
        return false;
      }
      if (!LineData.OriginalRepeatCode?.value > 0) {
        openNotification('Please Select Original/Repeat!!', 'danger');
        return false;
      }
      if (!LineData.StartTime > 0) {
        openNotification('Please Select Start Time!!', 'danger');
        return false;
      }
      if (!LineData.EndTime > 0) {
        openNotification('Please Select End Time!!', 'danger');
        return false;
      }
    }
    if (currentTab == 6) {
      //Slot RODP
      if (!LineData.TimeBandCode?.value > 0) {
        openNotification('Please Select TimeBand!!', 'danger');
        return false;
      }
      if (!LineData?.TotalSpots > 0) {
        openNotification('Please enter Slot!!', 'danger');
        return false;
      }
      if (LineData?.SpotPreferenceCode <= 0) {
        openNotification('Please select Spot Preference !!', 'danger');
        return false;
      }
    }
    if (!LineData.SpotTypeCode?.value > 0) {
      openNotification('Please Select Spot Type!!', 'danger');
      return false;
    }
    if (LineData?.SpotTypeCode?.value == 1) {
      if (LineData.Rate <= 0 || LineData.Rate == undefined) {
        openNotification('Rate should be greater than 0 !!', 'danger');
        return false;
      }
    }
    if (!LineData.WeekDayCode?.value > 0) {
      openNotification('Please Select WeekDays!!', 'danger');
      return false;
    }
    return true;
  }

  function calculateValue(inputValue, Second) {
    const result = (Number(Second) / secondsForRate) * Number(inputValue);
    const roundedResult = parseFloat(result.toFixed(2));
    setFormState((prevFormState) => ({
      ...prevFormState,
      Amount: roundedResult,
      NetAmount: roundedResult,
    }));
    return roundedResult;
  }

  function calculateValueX(inputValue, Second) {
    const result = (Number(Second) / secondsForRate) * Number(inputValue);
    setFormState((prevFormState) => ({
      ...prevFormState,
      Amount: result,
      NetAmount: result,
    }));
    return result;
  }

  function calculateValueXSpot(inputValue, Second) {
    const result = Number(Second) * Number(inputValue);
    setFormState((prevFormState) => ({
      ...prevFormState,
      Amount: result,
      NetAmount: result,
    }));
    return result;
  }

  const Bindstartnendtime = async (Prog, Org, ChannelCode) => {
    if (Prog && Org) {
      const Start = await apiGetbindstartnendtime(
        datg.DealPeriodToDate,
        datg.DealPeriodFromDate,
        Prog,
        Org,
        Channel.LocationCode,
        ChannelCode,
      );
      if (Start.status == 204) {
        openNotification('Start Time & End Time Not Found Please Change Org/Rep ', 'info');
        setStart([]);
        setEnd([]);
        return;
      }
      const StartTime = Start.data.TelecastStartTime.map((time) => ({
        value: time,
        label: time, // Assuming you want the key to be a string
      }));
      const StartEnd = Start.data.TelecastEndTime.map((time) => ({
        value: time,
        label: time, // Assuming you want the key to be a string
      }));
      setStart(StartTime);
      setEnd(StartEnd);
    }
  };

  const ClientPlaceCodeGetApi = async (ID) => {
    const ClientCity = await apiGetclientcitymasterdropmaster(ID);
    const formattedOptions = ClientCity.data.map((option) => ({
      value: option.Place.PlaceCode,
      label: option.Place.PlaceName,
    }));
    setClientCity(formattedOptions);
  };

  const Getagencyasperclient = async (ID) => {
    const Agency = await apiGetAgencygetagencyasperclient(ID);
    const formattedOptions = Agency.data.map((option) => ({
      value: option.AgencyCode,
      label: option.AgencyName,
      IsCredit: option.IsCredit,
      IsAdvPmt: option.IsAdvPmt,
      IsPDC: option.IsPDC,
      CreditDays: option.CreditDays,
      BusinessTypeCode: option.BusinessType.BusinessTypeCode,
      BusinessTypeName: option.BusinessType.BusinessTypeName,
    }));
    setAgency(formattedOptions);
  };

  const AgencyCityCodeGetApi = async (ID) => {
    const AgencyCity = await apiGetAgencyCityIDCITY(ID);
    const formattedOptions = AgencyCity.data.map((option) => ({
      value: option.Place.PlaceCode,
      label: option.Place.PlaceName,
      Country: option.Country.CountryCode,
      State: option.State.StateCode,
      Place: option.Place.PlaceCode,
      Address1: option.AddressLine1,
      Address2: option.AddressLine2,
      Address2: option.AddressLine2,
      PlaceName: option.Place.PlaceName,
      StateName: option.State.StateName,
      GSTN_id: option.GSTN_id,
    }));
    setAgencyCity(formattedOptions);
  };

  const handleInputChange = (value, name) => {
    setFormState((prevFormState) => ({
      ...prevFormState,
      [name]: value,
    }));
  };

  const handleBlur = (event) => {
    const { name, value } = event.target;
    const formattedValue = formatOnHHMMSSBlur(value);
    if (name == 'CommitedStartTime' && name == 'CommitedEndTime') {
      if (
        isTimeBetween(formattedValue, formState.StartTime, formState.EndTime)
      ) {
        setFormState((prevFormState) => ({
          ...prevFormState,
          [name]: formattedValue,
        }));
      } else {
        openNotification('Please enter correct Commited Time', 'danger');
        setFormState((prevFormState) => ({
          ...prevFormState,
          [name]: '',
        }));
      }
    } else {
      setFormState((prevFormState) => ({
        ...prevFormState,
        [name]: formattedValue,
      }));
    }
  };

  const handleSwitchChange = (value, name) => {
    setFormState((prevFormState) => ({
      ...prevFormState,
      [name]: !value ? 1 : 0,
    }));
  };

  const handleSelectChange = (value, name) => {
    if (name == 'TimeBandCode') {
      setFormState((prevFormState) => ({
        ...prevFormState,
        EndTime: value.EndTime,
        StartTime: value.StartTime,
        TimeBandCode: value,
        CommitedStartTime: value.StartTime,
        CommitedEndTime: value.EndTime,
      }));
      return;
    }
    if (name == 'SpotTypeCode' && value.value === 2) {
      setFormState((prevFormState) => ({
        ...prevFormState,
        Rate: 0,
        Amount: 0,
        SpotTypeCode: value,
      }));
      return;
    }
    setFormState((prevFormState) => ({
      ...prevFormState,
      [name]: value,
    }));
  };

  const validationSchema = Yup.object().shape({
    // DepartmentCode: Yup.string().required('Department Required'),
    PayRouteCode1: Yup.string().required('Pay Route Required'),
    AgencyPlaceCode1: Yup.string().required('Agency City Required'),
    CurrencyCode1: Yup.string().required('Currency Required'),
    DealTypeCode1: Yup.string().required('Deal Type Required'),
    AgencyCode1: Yup.string().required('Agency Required'),
    ZoneCode1: Yup.string().required('Zone Required'),
    SalesExcutiveCode1: Yup.string().required('Sales Excutive Required'),
    ClientCode1: Yup.string().required('Client Required'),
    ClientPlaceCode1: Yup.string().required('Client Place Required'),
    DealPeriodFromDate: Yup.string().nullable().required('From Date Required'),
    DealPeriodToDate: Yup.string().nullable().required('To Date Required'),
    DealCreatedDate: Yup.string().nullable().required('Deal Date Required'),
    DealReferenceNumber: Yup.string()
      .min(1, 'Too Short!')
      .max(15, 'Too Long!')
      .required('Deal Reference Required'),
    Channels1: Yup.array().min(1, 'Channel Required'),
    // <br/>IsActive: Yup.string().required('<br/>IsActives Required'),
  });

  const compareDatesV = (form) => {
    if (!dateVdaid) {
      form.setFieldValue('DealPeriodFromDate', null);
      form.setFieldValue('DealPeriodToDate', null);
      setdateVdaid(true);
    }
  };

  const onChange = (nextStep) => {
    if (nextStep < 0) {
      setStep(0);
    } else if (nextStep > 3) {
      setStep(3);
    } else {
      setStep(nextStep);
    }
  };

  const onNext = () => {
    formSubmit();
  };

  const onFinalSave = async () => {
    const res = DealDetailsComponentEdit(
      datg,
      DataDisplay,
      actualExchRatesForBaseCur,
    );
    setStep2(4);
    if (res.Deal && parseInt(res.Deal.DealNumber) > 0) {
      const resp = await PutDealMaster(res, token);
      if (resp.status === 200) {
        uploadFolder(Content.DealCode, Content.DealNumber);
        openNotification('Deal Update Successfully.', 'success', 1000);
        await apisendnotification({
          NotificationId: (Math.random() + 1).toString(36).substring(7),
          user_ids: [2],
          message: Content.DealCode + ' Deal Modified.',
          image: '',
          type: '1',
          location: 'Deal Modified.',
          locationLabel: Username,
          Status: '1',
          isGroup: 1,
          Ispriority: 1,
          readed: 0,
        });

        navigate('/DealMaster');
        setStep2(3);
      }
    } else {
      const resk = DealDetailsComponentAdd(
        datg,
        DataDisplay,
        actualExchRatesForBaseCur,
      );
      const resp = await PostDealMaster(resk, token);
      if (resp.status === 200) {
        uploadFolder(resp.data.DealCode, resp.data.DealNumber);
        openNotification(
          'Deal Added Successfully.\n' + resp.data.DealCode,
          'success',
          1000,
        );
        await apisendnotification({
          NotificationId: (Math.random() + 1).toString(36).substring(7),
          user_ids: [2],
          message: Content.DealCode + ' Deal Added.',
          image: '',
          type: '1',
          location: 'Deal Added.',
          locationLabel: Username,
          Status: '1',
          isGroup: 1,
          Ispriority: 1,
          readed: 0,
        });

        navigate('/DealMaster');

        setStep2(3);
      }
    }
  };

  const onDialogClose = (e) => {
    setFormState({ channel: Channel });
    setCurrentTab(0);
    setfindId();
  };

  const onCollapse = () => {
    setCollapse(!collapse);
  };

  let totalSeconds = 0;
  let totalSlotAndNTC = 0;
  let totalAmount = 0;
  // DataDisplay.forEach(item => {
  //     totalSeconds += Number(item.Second) || 0;
  //     totalAmount += Number(item.Amount) || 0;
  // });

  DataDisplay.forEach((item) => {
    if (item.LineItemCancelStatus != 1) {
      totalSeconds += Number(item.Second) || 0;
      totalSlotAndNTC +=
        Number(item.NTCTotalSpots) || Number(item.TotalSpots) || 0;
      totalAmount += Number(item.Amount) || 0;
    }
  });

  const handleHover = () => {
    setHover(!Hover);
  };

  const onPrevious = () => {
    onChange(step - 1);
    handleHover();
  };

  const onPrevious2 = () => {
    setStep(0);
    handleHover();
  };

  function closeAfter2000ms() {
    toast.push(
      <Notification closable type="success" duration={2000}>
        Success
      </Notification>,
    );
  }

  const AddDetails = () => {
    const { Rate, SpotTypeCode } = formState;
    // Check the values

    const indexToUpdate = DataDisplay.findIndex(
      (obj, index) => index === findId,
    );
    const Menur = Menu.findIndex((obj, index) => obj.value === currentTab);
    if (indexToUpdate !== -1) {
      const updatedItem = {
        ...DataDisplay[indexToUpdate],
        name: currentTab,
        DealLineItemType: {
          value: currentTab,
          label: Menu[Menur].label,
        },
        DealLineItemNo: findId,
        ...formState,
      };
      const updatedDataDisplay = [...DataDisplay];
      updatedDataDisplay[indexToUpdate] = updatedItem;
      setDataDisplay(updatedDataDisplay);
      setfindId();
      onDialogClose();
      setFormStateCopy({ channel: Channel });
    } else {
      if (DealLineAddValidation(formState, currentTab)) {
        setDataDisplay([
          ...DataDisplay,
          {
            name: currentTab,
            DealLineItemType: {
              value: currentTab,
              label: Menu[Menur].label,
            },
            DealLineItemNo: DataDisplay.length + 1,
            ID: DataDisplay.length + 1,
            ...formState,
          },
        ]);
        onDialogClose();
        setFormStateCopy({ channel: Channel });
      }
    }
  };

  const setExchRatesForBaseCurFn = async (baseCurShortName) => {
    try {
      showCursorLoader();
      const response = await apiGetExchangeRatesForBaseCurrency(
        baseCurShortName,
      );
      if (response.status === 200) {
        setFetchedExchRatesForBaseCur(response.data);
      } else throw new Error(response);
    } catch (error) {
      console.error(error);
      setFetchedExchRatesForBaseCur(null);
      // openNotification(
      //   `Something went wrong while fetching today's currency rates`,
      //   'danger',
      // );
    } finally {
      hideCursorLoader();
    }
  };

  return (
    <>
      <Loader showLoader={showLoader} />
      <Card className="mb-2">
        <div>
          <Steps current={step}>
            <Steps.Item title="Make Deal" />
            <Steps.Item title="Deal Details" />
            <Steps.Item title="Attachments" />
            <Steps.Item title="Approved" />
          </Steps>
        </div>
      </Card>
      <Card>
        <>
          {(() => {
            switch (step) {
              case 0:
                return (
                  <div
                    className=" dark:!bg-gray-700 bg-gray-100 rounded mt-5"
                    style={{ height: 'auto', padding: 10 }}
                  >
                    {channelsSelectorOptions.length > 0 && (
                      <Formik
                        innerRef={formikRef}
                        initialValues={
                          !datg
                            ? {
                              CancelStatus:
                                Content.CancelStatus == 1 ? true : false,
                              LocationCode:
                                Content.LocationCode || Channel.LocationCode,
                              ChannelCode:
                                Content.ChannelCode || Channel.ChannelCode,
                              DealReferenceNumber:
                                Content.DealReferenceNumber || '',
                              PayRouteCode:
                                {
                                  value: Number(Content.PayRouteCode),
                                  label: Content.PayRouteName,
                                } || '',
                              PayRouteCode1: Content.PayRouteCode || '',
                              DealTypeCode:
                                {
                                  value: Number(Content.DealTypeCode),
                                  label: Content.DealTypeName,
                                } || '',

                              DealTypeCode1:
                                Number(Content.DealTypeCode) || '',
                              CurrencyCode:
                                {
                                  value: Number(Content.CurrencyCode),
                                  label: Content.CurrencyName,
                                } || '',
                              CurrencyCode1: Content.CurrencyCode || '',
                              ZoneCode:
                                {
                                  value: Number(Content.ZoneCode),
                                  label: Content.ZoneName,
                                } || '',
                              ZoneCode1: Content.ZoneCode || '',
                              SalesExcutiveCode:
                                {
                                  value: Number(Content.SalesExcutiveCode),
                                  label: Content.Emp_FirstName,
                                } || '',
                              SalesExcutiveCode1:
                                Number(Content.SalesExcutiveCode) || '',
                              ClientCode:
                                {
                                  value: Number(Content.ClientCode),
                                  label: Content.ClientName,
                                } || '',
                              ClientCode1: Content.ClientCode || '',
                              ClientPlaceCode:
                                {
                                  value: Number(Content.ClientPlaceCode),
                                  label: Content.ClientPlaceName,
                                } || '',
                              ClientPlaceCode1:
                                Number(Content.ClientPlaceCode) || '',
                              AgencyCode:
                                {
                                  value: Number(Content.AgencyCode),
                                  label: Content.AgencyName,
                                  IsCredit: Content.IsCredit,
                                  CreditDays: Content.CreditDays,
                                  IsAdvPmt: Content.IsAdvPmt,
                                  IsPDC: Content.IsPDC,
                                  BusinessTypeName: Content.BusinessTypeName,
                                  BusinessTypeCode: Content.BusinessTypeCode,
                                } || '',
                              AgencyCode1: Content.AgencyCode || '',
                              AgencyPlaceCode:
                                {
                                  value: Number(Content.AgencyPlaceCode),
                                  label: Content.AgencyPlaceName,
                                  Address1: Content.Address1,
                                  Address2: Content.Address2,
                                  GSTN_id: Content.GSTN_id,
                                } || '',
                              AgencyPlaceCode1:
                                Number(Content.AgencyPlaceCode) || '',
                              DealPeriodFromDate:
                                Content.DealPeriodFromDate || null,
                              DealPeriodToDate:
                                Content.DealPeriodToDate || null,
                              DealCreatedDate:
                                Content.DealCreatedDate || null,
                              IsWebDeal: Content.IsWebDeal || 1,
                              DealNumber: Content.DealNumber || '',
                              IPAddress: Content.IPAddress || '',
                              Channels1:
                                Content.Channels ||
                                channelsSelectorOptions.filter(
                                  (option) =>
                                    option.ChannelCode ===
                                    Channel.ChannelCode &&
                                    option.LocationCode ===
                                    Channel.LocationCode,
                                ),
                            }
                            : datg
                        }
                        validationSchema={validationSchema}
                        onSubmit={(values, { resetForm, setSubmitting }) => {
                          // setTimeout(() => {
                          setdatg(values);
                          onChange(step + 1);
                          setSubmitting(true);
                          if (step === 0) {
                            setFormState({ channel: Channel });
                            setFormStateCopy({ channel: Channel });
                          }
                          // setdisplayInfo(false)
                          //     resetForm()
                          // }, 400)
                        }}
                      >
                        {({ values, touched, errors }) => (
                          <Form>
                            <FormContainer>
                              {Content.DealCode ? (
                                <div
                                  className="dark:!bg-[#1d2939] !bg-[#fff] dark:!border-[#374558] dark:!border mb-2"
                                  style={{
                                    padding: '10px',
                                    borderRadius: '.5rem',
                                    display: 'flex',
                                    alignItems: 'center',
                                  }}
                                >
                                  <p
                                    style={{
                                      fontWeight: 500,
                                      color: 'white',
                                      marginRight: 10,
                                    }}
                                  >
                                    {' '}
                                    Deal Number
                                  </p>
                                  <div className="dark:text-gray-300 text-white">
                                    {Content.DealCode}
                                  </div>
                                </div>
                              ) : null}

                              <div className="grid grid-cols-3 gap-3">
                                <div
                                  className="col-span-2 dark:!bg-[#1d2939] !bg-[#fff] dark:!border-[#374558] dark:!border"
                                  style={{
                                    padding: '10px',
                                    borderRadius: '.5rem',
                                  }}
                                >
                                  <div className="grid grid-cols-4 gap-3  mt-2">
                                    <FormItem
                                      asterisk
                                      label="Deal Type"
                                      invalid={
                                        errors.DealTypeCode1 &&
                                        touched.DealTypeCode1
                                      }
                                      errorMessage={errors.DealTypeCode1}
                                    >
                                      <Field name="DealTypeCode1">
                                        {({ field, form }) => (
                                          <Select
                                            field={field}
                                            form={form}
                                            options={DealType}
                                            value={DealType.filter(
                                              (option) =>
                                                option.value ==
                                                values.DealTypeCode1,
                                            )}
                                            onChange={(option) => {
                                              form.setFieldValue(
                                                field.name,
                                                option?.value,
                                              );
                                              form.setFieldValue(
                                                'DealTypeCode',
                                                option,
                                              );
                                            }}
                                          />
                                        )}
                                      </Field>
                                    </FormItem>
                                    <FormItem
                                      asterisk
                                      label="Ref No"
                                      invalid={
                                        errors.DealReferenceNumber &&
                                        touched.DealReferenceNumber
                                      }
                                      errorMessage={errors.DealReferenceNumber}
                                    >
                                      <Field name="DealReferenceNumber">
                                        {({ field, form }) => (
                                          <Input
                                            type="text"
                                            placeholder="Ref No"
                                            maxlength="20"
                                            size="sm"
                                            value={values.DealReferenceNumber}
                                            name="DealReferenceNumber"
                                            onChange={(e) => {
                                              const newValue = e.target.value;

                                              // if (
                                              //   newValue.length < 20 &&
                                              //   /^[a-zA-Z0-9]+$/.test(newValue)
                                              // ) 
                                              if (
                                                newValue.length < 20 &&
                                                /^[a-zA-Z0-9@_-]*$/.test(newValue)
                                              ) {
                                                form.setFieldValue(
                                                  field.name,
                                                  newValue,
                                                );
                                              }
                                              if (newValue == '') {
                                                form.setFieldValue(
                                                  field.name,
                                                  '',
                                                );
                                              }
                                            }}
                                          />
                                        )}
                                      </Field>
                                    </FormItem>

                                    <FormItem
                                      asterisk
                                      label="Executive"
                                      invalid={
                                        errors.SalesExcutiveCode1 &&
                                        touched.SalesExcutiveCode1
                                      }
                                      errorMessage={errors.SalesExcutiveCode1}
                                    >
                                      <Field name="SalesExcutiveCode1">
                                        {({ field, form }) => (
                                          <Select
                                            field={field}
                                            form={form}
                                            options={Executive}
                                            value={Executive.filter(
                                              (option) =>
                                                option.value ===
                                                values.SalesExcutiveCode1,
                                            )}
                                            onChange={(option) => {
                                              form.setFieldValue(
                                                'SalesExcutiveCode',
                                                option,
                                              );
                                              form.setFieldValue(
                                                field.name,
                                                option?.value,
                                              );
                                            }}
                                          />
                                        )}
                                      </Field>
                                    </FormItem>
                                    <FormItem
                                      asterisk
                                      label="Zone"
                                      invalid={
                                        errors.ZoneCode1 && touched.ZoneCode1
                                      }
                                      errorMessage={errors.ZoneCode1}
                                    >
                                      <Field name="ZoneCode1">
                                        {({ field, form }) => (
                                          <Select
                                            field={field}
                                            form={form}
                                            options={Zone}
                                            value={Zone.filter(
                                              (option) =>
                                                option.value ==
                                                values.ZoneCode1,
                                            )}
                                            onChange={(option) => {
                                              form.setFieldValue(
                                                'ZoneCode',
                                                option,
                                              );
                                              form.setFieldValue(
                                                field.name,
                                                option?.value,
                                              );
                                            }}
                                          />
                                        )}
                                      </Field>
                                    </FormItem>
                                  </div>
                                  <div className="grid grid-cols-4 gap-3 mt-2">
                                    <div className="col-span-3 ">
                                      <FormItem
                                        asterisk
                                        label="Client"
                                        invalid={
                                          errors.ClientCode1 &&
                                          touched.ClientCode1
                                        }
                                        errorMessage={errors.ClientCode1}
                                      >
                                        <Field name="ClientCode1">
                                          {({ field, form }) => (
                                            <Select
                                              field={field}
                                              form={form}
                                              options={Client}
                                              value={Client.filter(
                                                (option) =>
                                                  option.value ==
                                                  values.ClientCode1,
                                              )}
                                              onChange={(option) => {
                                                form.setFieldValue(
                                                  'ClientCode',
                                                  option,
                                                );
                                                form.setFieldValue(
                                                  field.name,
                                                  option?.value,
                                                );
                                                ClientPlaceCodeGetApi(
                                                  option.value,
                                                );
                                                Getagencyasperclient(
                                                  option.value,
                                                );
                                              }}
                                            />
                                          )}
                                        </Field>
                                      </FormItem>
                                    </div>
                                    <FormItem
                                      asterisk
                                      label="Client City"
                                      invalid={
                                        errors.ClientPlaceCode1 &&
                                        touched.ClientPlaceCode1
                                      }
                                      errorMessage={errors.ClientPlaceCode1}
                                    >
                                      <Field name="ClientPlaceCode1">
                                        {({ field, form }) => (
                                          <Select
                                            field={field}
                                            form={form}
                                            options={ClientCity}
                                            value={ClientCity.filter(
                                              (option) =>
                                                option.value ==
                                                values.ClientPlaceCode1,
                                            )}
                                            onChange={(option) => {
                                              form.setFieldValue(
                                                field.name,
                                                option?.value,
                                              );
                                              form.setFieldValue(
                                                'ClientPlaceCode',
                                                option,
                                              );
                                            }}
                                          />
                                        )}
                                      </Field>
                                    </FormItem>
                                    <div className="col-span-3 mt-2">
                                      <FormItem
                                        asterisk
                                        label="Agency"
                                        invalid={
                                          errors.AgencyCode1 &&
                                          touched.AgencyCode1
                                        }
                                        errorMessage={errors.AgencyCode1}
                                      >
                                        <Field name="AgencyCode1">
                                          {({ field, form }) => (
                                            <Select
                                              field={field}
                                              form={form}
                                              options={Agency}
                                              value={Agency.filter(
                                                (option) =>
                                                  option.value ==
                                                  values.AgencyCode1,
                                              )}
                                              onChange={(option) => {
                                                form.setFieldValue(
                                                  'AgencyCode',
                                                  option,
                                                );
                                                form.setFieldValue(
                                                  'BusinessTypeCode',
                                                  option.BusinessTypeCode,
                                                );

                                                form.setFieldValue(
                                                  field.name,
                                                  option?.value,
                                                );
                                                AgencyCityCodeGetApi(
                                                  option.value,
                                                );
                                              }}
                                            />
                                          )}
                                        </Field>
                                      </FormItem>
                                    </div>
                                    <FormItem
                                      asterisk
                                      label="Agency City"
                                      className=" mt-2"
                                      invalid={
                                        errors.AgencyPlaceCode1 &&
                                        touched.AgencyPlaceCode1
                                      }
                                      errorMessage={errors.AgencyPlaceCode1}
                                    >
                                      <Field name="AgencyPlaceCode1">
                                        {({ field, form }) => (
                                          // <><Tooltip title={<h1>Akkaksa AkkaksaAkka ksaAkkak saAkkaksaAkkaksaAk kaksaAkkaksaA kkaksaAkkaksa</h1>}>
                                          <Select
                                            field={field}
                                            form={form}
                                            options={AgencyCity}
                                            value={AgencyCity.filter(
                                              (option) =>
                                                option.value ==
                                                values.AgencyPlaceCode1,
                                            )}
                                            onChange={(option) => {
                                              form.setFieldValue(
                                                'AgencyPlaceCode',
                                                option,
                                              );
                                              form.setFieldValue(
                                                field.name,
                                                option?.value,
                                              );
                                            }}
                                          />
                                          // </Tooltip></>
                                        )}
                                      </Field>
                                    </FormItem>
                                  </div>
                                  <div className="grid grid-cols-4 gap-3 mt-2">
                                    <div>
                                      <FormItem
                                        asterisk
                                        label="Pay Route"
                                        invalid={
                                          errors.PayRouteCode1 &&
                                          touched.PayRouteCode1
                                        }
                                        errorMessage={errors.PayRouteCode1}
                                      >
                                        <Field name="PayRouteCode1">
                                          {({ field, form }) => (
                                            <Select
                                              field={field}
                                              form={form}
                                              options={PayRoute}
                                              value={PayRoute.filter(
                                                (option) =>
                                                  option.value ==
                                                  values.PayRouteCode1,
                                              )}
                                              onChange={(option) => {
                                                form.setFieldValue(
                                                  'PayRouteCode',
                                                  option,
                                                );
                                                form.setFieldValue(
                                                  field.name,
                                                  option?.value,
                                                );
                                              }}
                                            />
                                          )}
                                        </Field>
                                      </FormItem>
                                    </div>
                                    {/* {CurrencySysmbol} */}
                                    <FormItem
                                      asterisk
                                      label="Currency"
                                      invalid={
                                        errors.CurrencyCode1 &&
                                        touched.CurrencyCode1
                                      }
                                      errorMessage={errors.CurrencyCode1}
                                    >
                                      <Field name="CurrencyCode1">
                                        {({ field, form }) => (
                                          <Select
                                            field={field}
                                            form={form}
                                            options={Currency}
                                            value={Currency.filter(
                                              (option) =>
                                                option.value ==
                                                values.CurrencyCode1,
                                            )}
                                            onChange={(option) => {
                                              form.setFieldValue(
                                                'CurrencyCode',
                                                option,
                                              );
                                              setCurrencySysmbol(option.symbol);
                                              form.setFieldValue(
                                                field.name,
                                                option?.value,
                                              );
                                              setExchRatesForBaseCurFn(
                                                option.shortName,
                                              );
                                            }}
                                          />
                                        )}
                                      </Field>
                                    </FormItem>
                                    <div className="col-span-2">
                                      <FormItem label=" ">
                                        <MultiCurrencyDropdown
                                          currencyOptions={Currency}
                                          selectedCurrency={Currency.filter(
                                            (option) =>
                                              option.value ===
                                              Number(values.CurrencyCode1),
                                          )}
                                          fetchedExchRatesForBaseCur={
                                            fetchedExchRatesForBaseCur
                                          }
                                          actualExchRatesForBaseCur={
                                            actualExchRatesForBaseCur
                                          }
                                          setActualExchRatesForBaseCur={
                                            setActualExchRatesForBaseCur
                                          }
                                        />
                                      </FormItem>
                                    </div>
                                    {isMultiChannelSelectionEnabled && (
                                      <div className="col-span-2">
                                        <FormItem
                                          asterisk
                                          label="Channels"
                                          invalid={
                                            errors.Channels1 &&
                                            touched.Channels1
                                          }
                                          errorMessage={errors.Channels1}
                                        >
                                          <Field name="Channels1">
                                            {({ field, form }) => {
                                              console.log(form);
                                              return (
                                                <Select
                                                  field={field}
                                                  form={form}
                                                  isMulti={true}
                                                  options={
                                                    channelsSelectorOptions
                                                  }
                                                  value={values.Channels1}
                                                  onChange={(option) => {
                                                    if (option.length === 0)
                                                      return;
                                                    form.setFieldValue(
                                                      'Channels1',
                                                      option,
                                                    );
                                                    // form.setFieldValue(
                                                    //   field.name,
                                                    //   option?.value,
                                                    // );
                                                  }}
                                                />
                                              );
                                            }}
                                          </Field>
                                        </FormItem>
                                      </div>
                                    )}
                                  </div>
                                </div>
                                <div
                                  className="dark:!bg-[#1d2939]
          !bg-[#fff] dark:!border-[#374558]
           dark:!border"
                                  style={{
                                    padding: '10px',
                                    borderRadius: '.5rem',
                                  }}
                                >
                                  <div className="grid grid-cols-2 gap-2">
                                    <FormItem
                                      asterisk
                                      label="Deal Date"
                                      invalid={
                                        errors.DealCreatedDate &&
                                        touched.DealCreatedDate
                                      }
                                      errorMessage={errors.DealCreatedDate}
                                    >
                                      <Field name="DealCreatedDate">
                                        {({ field, form }) => (
                                          <DatePicker
                                            size="sm"
                                            minDate={dayjs(new Date())
                                              .subtract(31, 'day')

                                              .startOf('day')

                                              .toDate()}
                                            value={
                                              validate(values.DealCreatedDate)
                                                ? new Date(
                                                  values.DealCreatedDate,
                                                )
                                                : values.DealCreatedDate == null
                                                  ? null
                                                  : null
                                            }
                                            onChange={(e) => {
                                              form.setFieldValue(
                                                field.name,
                                                convertDateToYMD(e),
                                              );
                                            }}
                                          />
                                        )}
                                      </Field>
                                    </FormItem>
                                  </div>

                                  <div className="grid grid-cols-2 gap-2">
                                    <FormItem
                                      asterisk
                                      label="From Date"
                                      className="mt-2"
                                      invalid={
                                        errors.DealPeriodFromDate &&
                                        touched.DealPeriodFromDate
                                      }
                                      errorMessage={errors.DealPeriodFromDate}
                                    >
                                      <Field name="DealPeriodFromDate">
                                        {({ field, form }) => (
                                          <DatePicker
                                            size="sm"
                                            // minDate={minDate}
                                            // maxDate={maxDate}
                                            minDate={dayjs(new Date())
                                              .subtract(10, 'day')

                                              .startOf('day')

                                              .toDate()}
                                            value={
                                              validate(
                                                values.DealPeriodFromDate,
                                              )
                                                ? new Date(
                                                  values.DealPeriodFromDate,
                                                )
                                                : values.DealPeriodFromDate ==
                                                  null
                                                  ? null
                                                  : null
                                            }
                                            onChange={(e) => {
                                              form.setFieldValue(
                                                field.name,
                                                convertDateToYMD(e),
                                              );
                                              if (
                                                values.DealPeriodToDate != null
                                              ) {
                                                const res = compareDates(
                                                  e,
                                                  values.DealPeriodToDate,
                                                );
                                                setdateVdaid(res);
                                              }
                                            }}
                                            onBlur={(e) => compareDatesV(form)}
                                          />
                                        )}
                                      </Field>
                                    </FormItem>
                                    <FormItem
                                      asterisk
                                      className="mt-2"
                                      label="To Date"
                                      invalid={
                                        errors.DealPeriodToDate &&
                                        touched.DealPeriodToDate
                                      }
                                      errorMessage={errors.DealPeriodToDate}
                                    >
                                      <Field name="DealPeriodToDate">
                                        {({ field, form }) => (
                                          <DatePicker
                                            size="sm"
                                            minDate={dayjs(
                                              new Date(
                                                values.DealPeriodFromDate,
                                              ),
                                            )
                                              .subtract(0, 'day')

                                              .startOf('day')

                                              .toDate()}
                                            // minDate={minDate}
                                            // maxDate={maxDate}
                                            value={
                                              validate(values.DealPeriodToDate)
                                                ? new Date(
                                                  values.DealPeriodToDate,
                                                )
                                                : values.DealPeriodToDate ==
                                                  null
                                                  ? null
                                                  : null
                                            }
                                            onChange={(e) => {
                                              form.setFieldValue(
                                                field.name,
                                                convertDateToYMD(e),
                                              );
                                              if (
                                                values.DealPeriodFromDate !=
                                                null
                                              ) {
                                                const res = compareDates(
                                                  values.DealPeriodFromDate,
                                                  e,
                                                );
                                                setdateVdaid(res);
                                              }
                                            }}
                                            onBlur={(e) => compareDatesV(form)}
                                          />
                                        )}
                                      </Field>
                                    </FormItem>
                                  </div>

                                  <div
                                    className="mt-2 mb-1"
                                    style={{
                                      backgroundColor:
                                        'rgb(31 41 55/var(--tw-bg-opacity))',
                                      padding: '10px',
                                      borderWidth: '1px',
                                      borderColor:
                                        'rgb(75 85 99/var(--tw-border-opacity))',
                                      borderRadius: '.5rem',
                                    }}
                                  >
                                    <p style={{ color: '#54E4CB' }}>
                                      {' '}
                                      Payment Terms:-{' '}
                                      {values.AgencyCode?.IsCredit != 0 &&
                                        values.AgencyCode?.IsCredit
                                        ? `${values.AgencyCode?.CreditDays} Days Credit Period `
                                        : Content.CreditDays}{' '}
                                      Days Credit Period
                                      {values.AgencyCode?.IsAdvPmt != 0 &&
                                        values.AgencyCode?.IsAdvPmt
                                        ? `Advance Payment`
                                        : null}
                                      {values.AgencyCode?.IsPDC != 0 &&
                                        values.AgencyCode?.IsPDC
                                        ? `PDC`
                                        : null}
                                    </p>
                                    <p style={{ color: '#54E4CB' }}>
                                      {' '}
                                      Address:-{' '}
                                      {values.AgencyPlaceCode?.Address1}{' '}
                                      {values.AgencyPlaceCode?.Address2}
                                    </p>
                                    <p style={{ color: '#54E4CB' }}>
                                      {' '}
                                      Business Type:-{' '}
                                      {values.AgencyCode?.BusinessTypeName}
                                    </p>
                                    <p style={{ color: '#54E4CB' }}>
                                      {' '}
                                      {values.AgencyPlaceCode?.GSTN_id}
                                    </p>
                                  </div>
                                  <FormItem
                                    label="Cancel Status"
                                    invalid={
                                      errors.CancelStatus &&
                                      touched.CancelStatus
                                    }
                                    errorMessage={errors.CancelStatus}
                                  >
                                    <div>
                                      <Field
                                        name="CancelStatus"
                                        component={Switcher}
                                      />
                                    </div>
                                  </FormItem>
                                </div>
                              </div>
                            </FormContainer>
                          </Form>
                        )}
                      </Formik>
                    )}
                  </div>
                );
              case 1:
                return (
                  <div>
                    <DealHeader
                      datg={datg}
                      onPrevious={onPrevious2}
                      onCollapse={onCollapse}
                      onDialogClose={onDialogClose}
                      collapse={collapse}
                      handleAddDealClick={() => {
                        setCurrentTab(1);
                        setFormState({ channel: Channel });
                      }}
                      currentTab={currentTab}
                      step={step}
                    />

                    <div className="mt-2">
                      {/* {currentTab} */}
                      <Tabs
                        value={currentTab}
                        variant="pill"
                        onChange={(val) => {
                          setCurrentTab(val);
                          setFormState({ channel: Channel });
                          setfindId();
                          setFormStateCopy({ channel: Channel });
                          setSecondsForRate(10);
                        }}
                      >
                        <div className="flex justify-between ">
                          <div>
                            {currentTab != 0 && (
                              <TabList>
                                {Menu.map((item, key) => (
                                  <TabNav
                                    value={item.value}
                                    key={key}
                                    disabled={
                                      findId > -1 &&
                                      formState?.DealLineItemType?.value !==
                                      item.value
                                    }
                                  >
                                    {item.label}
                                  </TabNav>
                                ))}
                              </TabList>
                            )}
                          </div>
                        </div>

                        <div className="p-2 ">
                          {/* Sponsorwise */}
                          <TabContent value={1}>
                            <div
                              className="dark:!bg-[#1f2639] !bg-gray-100 dark:!border-[#374558] dark:!border"
                              style={{
                                padding: '10px',
                                borderRadius: '.5rem',
                              }}
                            >
                              <div className="grid grid-cols-3 gap-1">
                                <div
                                  className="col-span-2 dark:!bg-[#1f2639] bg-gray-100"
                                  style={{
                                    padding: '10px',
                                    borderRadius: '.5rem',
                                  }}
                                >
                                  <FormContainer>
                                    <div className="grid grid-cols-2 gap-2">
                                      <div
                                        className={`col-span-2 grid ${IS_CHANNEL_SEL_ENABLED_FOR_DEAL_DETAILS
                                          ? 'grid-cols-3'
                                          : 'grid-cols-2'
                                          } gap-2`}
                                      >
                                        {IS_CHANNEL_SEL_ENABLED_FOR_DEAL_DETAILS && (
                                          <FormItem asterisk label="Channel">
                                            <Select
                                              options={channelOptions}
                                              onChange={(e) =>
                                                setFormState((prev) => ({
                                                  ...prev,
                                                  channel: e,
                                                }))
                                              }
                                              value={formState.channel}
                                            />
                                          </FormItem>
                                        )}
                                        <FormItem asterisk label="Sponsor Type">
                                          <Select
                                            options={SponsorType}
                                            onChange={(e) =>
                                              handleSelectChange(
                                                e,
                                                'SponsorTypeCode',
                                              )
                                            }
                                            value={
                                              SponsorType !== null
                                                ? SponsorType.filter(
                                                  (option) =>
                                                    option.value ==
                                                    formState.SponsorTypeCode
                                                      ?.value,
                                                )
                                                : ContentDemo.filter(
                                                  (option) => option,
                                                )
                                            }
                                          />
                                        </FormItem>
                                        <FormItem asterisk label="Content">
                                          <Select
                                            options={ContentList}
                                            onChange={(e) => {
                                              handleSelectChange(
                                                e,
                                                'ContentCode',
                                              );

                                              if (
                                                formState.OriginalRepeatCode
                                                  ?.value
                                              ) {
                                                Bindstartnendtime(
                                                  e.value,
                                                  formState.OriginalRepeatCode
                                                    ?.value, formState?.channel?.value?.split("-")[0]
                                                );
                                              }
                                            }}
                                            value={
                                              ContentList !== null
                                                ? ContentList.filter(
                                                  (option) =>
                                                    option.value ===
                                                    formState.ContentCode
                                                      ?.value,
                                                )
                                                : ContentDemo.filter(
                                                  (option) => option,
                                                )
                                            }
                                          />
                                        </FormItem>
                                      </div>
                                      <FormItem asterisk label="Org/Rep">
                                        <Select
                                          options={TimeBand}
                                          onChange={(e) => {
                                            handleSelectChange(
                                              e,
                                              'OriginalRepeatCode',
                                            );
                                            if (formState.ContentCode.value) {
                                              Bindstartnendtime(
                                                formState.ContentCode?.value,
                                                e.value, formState?.channel?.value?.split("-")[0]
                                              );
                                            }
                                          }}
                                          value={
                                            TimeBand !== null
                                              ? TimeBand.filter(
                                                (option) =>
                                                  option.value ===
                                                  formState.OriginalRepeatCode
                                                    ?.value,
                                              )
                                              : ContentDemo.filter(
                                                (option) => option,
                                              )
                                          }
                                        />
                                      </FormItem>
                                      <FormItem asterisk label="Spot Type">
                                        <Select
                                          options={SpotType}
                                          onChange={(e) =>
                                            handleSelectChange(
                                              e,
                                              'SpotTypeCode',
                                            )
                                          }
                                          value={
                                            SpotType !== null
                                              ? SpotType.filter(
                                                (option) =>
                                                  option.value ===
                                                  formState.SpotTypeCode
                                                    ?.value,
                                              )
                                              : ContentDemo.filter(
                                                (option) => option,
                                              )
                                          }
                                        />
                                      </FormItem>
                                      <div className="col-span-2">
                                        <FormItem label="Remark">
                                          <Input
                                            value={formState.LineItemRemark}
                                            onChange={(e) => {
                                              if (
                                                e.target.value.length < 50 &&
                                                /^[0-9a-zA-Z\s]*$/.test(
                                                  e.target.value,
                                                )
                                              ) {
                                                handleInputChange(
                                                  e.target.value,
                                                  'LineItemRemark',
                                                );
                                              }
                                            }}
                                          />
                                        </FormItem>
                                      </div>
                                    </div>
                                  </FormContainer>
                                </div>

                                <div
                                  className="col-span-1 dark:!bg-[#1f2639] bg-gray-100"
                                  style={{
                                    padding: '10px',
                                    borderRadius: '.5rem',
                                  }}
                                >
                                  <FormContainer>
                                    <div className="grid grid-cols-2 gap-2">
                                      <FormItem asterisk label="Start Time">
                                        <Select
                                          options={Start}
                                          onChange={(e) =>
                                            handleSelectChange(
                                              e.value,
                                              'StartTime',
                                            )
                                          }
                                          value={
                                            Start !== null
                                              ? Start.filter(
                                                (option) =>
                                                  option.value ===
                                                  formState.StartTime,
                                              )
                                              : ContentDemo.filter(
                                                (option) => option,
                                              )
                                          }
                                        />
                                      </FormItem>
                                      <FormItem asterisk label="End Time">
                                        <Select
                                          options={End}
                                          onChange={(e) =>
                                            handleSelectChange(
                                              e.value,
                                              'EndTime',
                                            )
                                          }
                                          value={
                                            End !== null
                                              ? End.filter(
                                                (option) =>
                                                  option.value ===
                                                  formState.EndTime,
                                              )
                                              : ContentDemo.filter(
                                                (option) => option,
                                              )
                                          }
                                        />
                                      </FormItem>
                                      <FormItem asterisk label="No Of Week">
                                        <Input
                                          size="sm"
                                          value={formState.NoWeeks}
                                          onChange={(e) => {
                                            if (
                                              e.target.value.length < 4 &&
                                              /^[0-9a-zA-Z\s]*$/.test(
                                                e.target.value,
                                              )
                                            ) {
                                              handleInputChange(
                                                e.target.value,
                                                'NoWeeks',
                                              );
                                            }
                                          }}
                                        />
                                      </FormItem>
                                      <FormItem asterisk label="Week Part">
                                        <Select
                                          options={Weekdays}
                                          onChange={(e) =>
                                            handleSelectChange(e, 'WeekDayCode')
                                          }
                                          value={
                                            Weekdays !== null
                                              ? Weekdays.filter(
                                                (option) =>
                                                  option.value ===
                                                  formState.WeekDayCode
                                                    ?.value,
                                              )
                                              : ContentDemo.filter(
                                                (option) => option,
                                              )
                                          }
                                        />
                                      </FormItem>
                                      {/* {formState.LineItemCancelStatus} */}
                                      <div className="col-span-1 ">
                                        <FormItem label="Cancel Line Item">
                                          <Switcher
                                            checked={
                                              formState.LineItemCancelStatus ==
                                                1
                                                ? true
                                                : false
                                            }
                                            onChange={(e) =>
                                              handleSwitchChange(
                                                e,
                                                'LineItemCancelStatus',
                                              )
                                            }
                                          />
                                        </FormItem>
                                      </div>
                                    </div>
                                  </FormContainer>
                                </div>
                              </div>
                              <div className="col-span-3 mt-2">
                                <FormContainer>
                                  <div className="grid grid-cols-6 gap-2">
                                    <FormItem
                                      asterisk
                                      label={
                                        <p
                                          style={{
                                            fontSize: 16,
                                            fontWeight: 600,
                                          }}
                                        >
                                          Seconds
                                        </p>
                                      }
                                    >
                                      <Select
                                        placeholder="Select"
                                        isDisabled
                                        styles={{
                                          control: (baseStyles) => ({
                                            ...baseStyles,
                                            height: '3.5rem!important',
                                          }),
                                          singleValue: (baseStyles) => ({
                                            ...baseStyles,
                                            fontSize: '15px!important',
                                          }),
                                          menuList: (baseStyles) => ({
                                            ...baseStyles,
                                            fontSize: '15px!important',
                                          }),
                                        }}
                                        options={SECONDS_FOR_RATE_OPTIONS}
                                        onChange={(e) => {
                                          setSecondsForRate(e.value);
                                        }}
                                        value={SECONDS_FOR_RATE_OPTIONS.filter(
                                          (item) =>
                                            item.value === secondsForRate,
                                        )}
                                      />
                                    </FormItem>
                                    <FormItem
                                      asterisk
                                      label={
                                        <p
                                          style={{
                                            fontSize: 16,
                                            fontWeight: 600,
                                          }}
                                        >
                                          Rate Per {secondsForRate}[sec]
                                        </p>
                                      }
                                    >
                                      {/* {formStateCopy.Rate} */}
                                      <Input
                                        size="lg"
                                        value={formState.Rate}
                                        style={{
                                          fontSize: 25,
                                          fontWeight: 600,
                                        }}
                                        disabled={
                                          formState.SpotTypeCode &&
                                          formState.SpotTypeCode.value === 2
                                        }
                                        onChange={(e) => {
                                          if (
                                            e.target.value.length < 8 &&
                                            /^[0-9.\s]*$/.test(e.target.value)
                                          ) {
                                            handleInputChange(
                                              e.target.value,
                                              'Rate',
                                            );
                                          }
                                          if (formState.Second) {
                                            calculateValue(
                                              e.target.value,
                                              formState.Second,
                                            );
                                          }
                                        }}
                                      />
                                    </FormItem>
                                    <FormItem
                                      asterisk
                                      label={
                                        <p style={{ fontSize: 16 }}>Seconds</p>
                                      }
                                    >
                                      <Input
                                        size="lg"
                                        value={formState.Second}
                                        onChange={(e) => {
                                          if (
                                            e.target.value.length <= 8 &&
                                            /^[0-9]*$/.test(e.target.value)
                                          ) {
                                            handleInputChange(
                                              e.target.value,
                                              'Second',
                                            );
                                          }

                                          if (formState.Rate) {
                                            calculateValue(
                                              formState.Rate,
                                              e.target.value,
                                            );
                                          }
                                        }}
                                        onBlur={() => {
                                          if (
                                            formStateCopy.Second >
                                            formState.Second
                                          ) {
                                            openNotification(
                                              'Error ',
                                              'danger',
                                              1000,
                                            );
                                            setFormState(formStateCopy);
                                          }
                                        }}
                                      />
                                    </FormItem>
                                    <FormItem
                                      asterisk
                                      label={
                                        <p style={{ fontSize: 16 }}>Amount</p>
                                      }
                                    >
                                      <Input
                                        size="lg"
                                        value={formState.Amount}
                                        disabled
                                        onChange={(e) => {
                                          if (
                                            e.target.value.length < 8 &&
                                            /^[0-9\s]*$/.test(e.target.value)
                                          ) {
                                            handleInputChange(
                                              e.target.value,
                                              'Amount',
                                            );
                                          }
                                        }}
                                      />
                                    </FormItem>
                                    <FormItem
                                      label={
                                        <p style={{ fontSize: 16 }}>
                                          Internal Rate
                                        </p>
                                      }
                                    >
                                      <Input
                                        size="lg"
                                        value={formState.InternalRate}
                                        onChange={(e) => {
                                          if (
                                            e.target.value.length < 8 &&
                                            /^[0-9.\s]*$/.test(e.target.value)
                                          ) {
                                            handleInputChange(
                                              e.target.value,
                                              'InternalRate',
                                            );
                                          }
                                        }}
                                      />
                                    </FormItem>
                                    <div></div>
                                  </div>
                                </FormContainer>
                              </div>
                            </div>
                          </TabContent>

                          {/* RODP */}
                          <TabContent value={2}>
                            <div
                              className="grid grid-cols-3 gap-1 dark:!border-[#374558] dark:!border dark:!bg-[#1f2639] bg-gray-100"
                              style={{
                                padding: '10px',
                                borderRadius: '.5rem',
                              }}
                            >
                              <div
                                className="col-span-2 dark:!bg-[#1f2639] bg-gray-100"
                                style={{
                                  padding: '10px',
                                  borderRadius: '.5rem',
                                }}
                              >
                                <FormContainer>
                                  <div className="grid grid-cols-2 gap-2">
                                    <div
                                      className={`col-span-2 grid ${IS_CHANNEL_SEL_ENABLED_FOR_DEAL_DETAILS
                                        ? 'grid-cols-5'
                                        : 'grid-cols-2'
                                        } gap-2`}
                                    >
                                      {IS_CHANNEL_SEL_ENABLED_FOR_DEAL_DETAILS && (
                                        <FormItem
                                          asterisk
                                          label="Channel"
                                          className="col-span-2"
                                        >
                                          <Select
                                            options={channelOptions}
                                            onChange={(e) =>
                                              setFormState((prev) => ({
                                                ...prev,
                                                channel: e,
                                              }))
                                            }
                                            value={formState.channel}
                                          />
                                        </FormItem>
                                      )}
                                      <FormItem
                                        asterisk
                                        label="RODP Category"
                                        className={
                                          IS_CHANNEL_SEL_ENABLED_FOR_DEAL_DETAILS
                                            ? 'col-span-2'
                                            : 'col-span-1'
                                        }
                                      >
                                        <Select
                                          options={RODP}
                                          onChange={(e) =>
                                            handleSelectChange(
                                              e,
                                              'TimeBandCode',
                                            )
                                          }
                                          value={
                                            RODP !== null
                                              ? RODP.filter(
                                                (option) =>
                                                  option.value ===
                                                  formState.TimeBandCode
                                                    ?.value,
                                              )
                                              : ContentDemo.filter(
                                                (option) => option,
                                              )
                                          }
                                        />
                                      </FormItem>
                                      <FormItem
                                        asterisk
                                        label="Spot Type"
                                        className="col-span-1"
                                      >
                                        <Select
                                          options={SpotType}
                                          onChange={(e) =>
                                            handleSelectChange(
                                              e,
                                              'SpotTypeCode',
                                            )
                                          }
                                          value={
                                            SpotType !== null
                                              ? SpotType.filter(
                                                (option) =>
                                                  option.value ===
                                                  formState.SpotTypeCode
                                                    ?.value,
                                              )
                                              : ContentDemo.filter(
                                                (option) => option,
                                              )
                                          }
                                        />
                                      </FormItem>
                                    </div>
                                    <FormItem asterisk label="Spot Preference">
                                      <Select
                                        options={SpotPreference}
                                        onChange={(e) =>
                                          handleSelectChange(
                                            e,
                                            'SpotPreferenceCode',
                                          )
                                        }
                                        value={
                                          SpotPreference !== null
                                            ? SpotPreference.filter(
                                              (option) =>
                                                option.value ===
                                                formState.SpotPreferenceCode
                                                  ?.value,
                                            )
                                            : ContentDemo.filter(
                                              (option) => option,
                                            )
                                        }
                                      />
                                    </FormItem>
                                    <div className="col-span-1">
                                      <FormItem label="Remark">
                                        <Input
                                          size="sm"
                                          value={formState.LineItemRemark}
                                          onChange={(e) => {
                                            if (
                                              e.target.value.length < 50 &&
                                              /^[0-9a-zA-Z\s]*$/.test(
                                                e.target.value,
                                              )
                                            ) {
                                              handleInputChange(
                                                e.target.value,
                                                'LineItemRemark',
                                              );
                                            }
                                          }}
                                        />
                                      </FormItem>
                                    </div>
                                    <div className="col-span-1">
                                      <div className="col-span-1 flex mb-2">
                                        <Checkbox
                                          value={
                                            formState.IsCommited == 1
                                              ? true
                                              : false
                                          }
                                          onChange={(e) =>
                                            handleSwitchChange(e, 'IsCommited')
                                          }
                                        />
                                        Is Commited Time
                                      </div>
                                    </div>
                                    <div className="col-span-1">
                                      {formState.IsCommited == 0 ? (
                                        <div className="grid grid-cols-2 gap-2">
                                          <FormItem label="Commited Start Time">
                                            <Input
                                              size="sm"
                                              name="CommitedStartTime"
                                              maxLength="8"
                                              placeholder="HH:MM:SS"
                                              value={
                                                formState.CommitedStartTime
                                              }
                                              onChange={(e) =>
                                                handleChangeWithOutFrameNew(
                                                  e,
                                                  setFormState,
                                                )
                                              }
                                              onBlur={handleBlur}
                                            />
                                          </FormItem>
                                          <FormItem label="Commited End Time">
                                            <Input
                                              size="sm"
                                              name="CommitedEndTime"
                                              maxLength="8"
                                              placeholder="HH:MM:SS"
                                              value={formState.CommitedEndTime}
                                              onChange={(e) =>
                                                handleChangeWithOutFrameNew(
                                                  e,
                                                  setFormState,
                                                )
                                              }
                                              onBlur={handleBlur}
                                            />
                                          </FormItem>
                                        </div>
                                      ) : null}
                                    </div>
                                  </div>
                                </FormContainer>
                              </div>

                              <div
                                className="col-span-1 dark:!bg-[#1f2639] bg-gray-100"
                                style={{
                                  padding: '10px',
                                  borderRadius: '.5rem',
                                }}
                              >
                                <FormContainer>
                                  <div className="grid grid-cols-2 gap-2 mb-4">
                                    <FormItem asterisk label="Start Time">
                                      <Input
                                        size="sm"
                                        value={formState.StartTime}
                                        disabled
                                        onChange={(e) =>
                                          handleInputChange(
                                            e.target.value,
                                            'StartTime',
                                          )
                                        }
                                      />
                                    </FormItem>
                                    <FormItem asterisk label="End Time">
                                      <Input
                                        size="sm"
                                        value={formState.EndTime}
                                        disabled
                                        onChange={(e) =>
                                          handleInputChange(
                                            e.target.value,
                                            'EndTime',
                                          )
                                        }
                                      />
                                    </FormItem>
                                  </div>
                                  <div className="grid grid-cols-2 gap-2 ">
                                    <FormItem asterisk label="Week Part">
                                      <Select
                                        options={Weekdays}
                                        onChange={(e) =>
                                          handleSelectChange(e, 'WeekDayCode')
                                        }
                                        value={
                                          Weekdays !== null
                                            ? Weekdays.filter(
                                              (option) =>
                                                option.value ===
                                                formState.WeekDayCode?.value,
                                            )
                                            : ContentDemo.filter(
                                              (option) => option,
                                            )
                                        }
                                      />
                                    </FormItem>

                                    <FormItem label="Cancel Line Item">
                                      <Switcher
                                        checked={
                                          formState.LineItemCancelStatus == 1
                                            ? true
                                            : false
                                        }
                                        onChange={(e) =>
                                          handleSwitchChange(
                                            e,
                                            'LineItemCancelStatus',
                                          )
                                        }
                                      />
                                    </FormItem>
                                  </div>
                                </FormContainer>
                              </div>
                              <div className="col-span-3 mt-2">
                                <FormContainer>
                                  <div className="grid grid-cols-6 gap-2">
                                    <FormItem
                                      asterisk
                                      label={
                                        <p
                                          style={{
                                            fontSize: 16,
                                            fontWeight: 600,
                                          }}
                                        >
                                          Seconds
                                        </p>
                                      }
                                    >
                                      <Select
                                        placeholder="Select"
                                        isDisabled
                                        styles={{
                                          control: (baseStyles) => ({
                                            ...baseStyles,
                                            height: '3.5rem!important',
                                          }),
                                          singleValue: (baseStyles) => ({
                                            ...baseStyles,
                                            fontSize: '15px!important',
                                          }),
                                          menuList: (baseStyles) => ({
                                            ...baseStyles,
                                            fontSize: '15px!important',
                                          }),
                                        }}
                                        options={SECONDS_FOR_RATE_OPTIONS}
                                        onChange={(e) => {
                                          setSecondsForRate(e.value);
                                        }}
                                        value={SECONDS_FOR_RATE_OPTIONS.filter(
                                          (item) =>
                                            item.value === secondsForRate,
                                        )}
                                      />
                                    </FormItem>
                                    <FormItem
                                      asterisk
                                      label={
                                        <p
                                          style={{
                                            fontSize: 16,
                                            fontWeight: 600,
                                          }}
                                        >
                                          Rate Per {secondsForRate}[sec]
                                        </p>
                                      }
                                    >
                                      <Input
                                        size="lg"
                                        value={formState.Rate}
                                        style={{
                                          fontSize: 25,
                                          fontWeight: 600,
                                        }}
                                        disabled={
                                          formState.SpotTypeCode &&
                                          formState.SpotTypeCode.value === 2
                                        }
                                        onChange={(e) => {
                                          if (
                                            e.target.value.length < 8 &&
                                            /^[0-9.\s]*$/.test(e.target.value)
                                          ) {
                                            handleInputChange(
                                              e.target.value,
                                              'Rate',
                                            );
                                          }
                                          if (formState.Second) {
                                            calculateValue(
                                              e.target.value,
                                              formState.Second,
                                            );
                                          }
                                        }}
                                      />
                                    </FormItem>
                                    <FormItem
                                      asterisk
                                      label={
                                        <p style={{ fontSize: 16 }}>Seconds</p>
                                      }
                                    >
                                      <Input
                                        size="lg"
                                        value={formState.Second}
                                        onChange={(e) => {
                                          if (
                                            e.target.value.length <= 8 &&
                                            /^[0-9]*$/.test(e.target.value)
                                          ) {
                                            handleInputChange(
                                              e.target.value,
                                              'Second',
                                            );
                                          }
                                          if (formState.Rate) {
                                            calculateValue(
                                              formState.Rate,
                                              e.target.value,
                                            );
                                          }
                                        }}
                                        onBlur={() => {
                                          if (
                                            formStateCopy.Second >
                                            formState.Second
                                          ) {
                                            openNotification(
                                              'Error ',
                                              'danger',
                                              1000,
                                            );
                                            setFormState(formStateCopy);
                                          }
                                        }}
                                      />
                                    </FormItem>
                                    <FormItem
                                      asterisk
                                      label={
                                        <p style={{ fontSize: 16 }}>Amount</p>
                                      }
                                    >
                                      <Input
                                        size="lg"
                                        value={formState.Amount}
                                        disabled
                                        onChange={(e) => {
                                          if (
                                            e.target.value.length < 8 &&
                                            /^[0-9\s]*$/.test(e.target.value)
                                          ) {
                                            handleInputChange(
                                              e.target.value,
                                              'Amount',
                                            );
                                          }
                                        }}
                                      />
                                    </FormItem>
                                    <FormItem
                                      label={
                                        <p style={{ fontSize: 16 }}>
                                          Internal Rate
                                        </p>
                                      }
                                    >
                                      <Input
                                        size="lg"
                                        value={formState.InternalRate}
                                        onChange={(e) => {
                                          if (
                                            e.target.value.length < 8 &&
                                            /^[0-9.\s]*$/.test(e.target.value)
                                          ) {
                                            handleInputChange(
                                              e.target.value,
                                              'InternalRate',
                                            );
                                          }
                                        }}
                                      />
                                    </FormItem>
                                    <div></div>
                                  </div>
                                </FormContainer>
                              </div>
                            </div>
                          </TabContent>

                          {/* Program wise */}
                          <TabContent value={3}>
                            <div
                              className="grid grid-cols-3 gap-1  dark:!border-[#374558] dark:!border dark:!bg-[#1f2639] bg-gray-100"
                              style={{
                                padding: '10px',
                                borderRadius: '.5rem',
                              }}
                            >
                              <div
                                className="col-span-2 dark:!bg-[#1f2639] bg-gray-100"
                                style={{
                                  padding: '10px',
                                  borderRadius: '.5rem',
                                }}
                              >
                                <FormContainer>
                                  <div className="grid grid-cols-2 gap-2">
                                    <div
                                      className={`col-span-2 grid ${IS_CHANNEL_SEL_ENABLED_FOR_DEAL_DETAILS
                                        ? 'grid-cols-3'
                                        : 'grid-cols-2'
                                        } gap-2`}
                                    >
                                      {IS_CHANNEL_SEL_ENABLED_FOR_DEAL_DETAILS && (
                                        <FormItem asterisk label="Channel">
                                          <Select
                                            options={channelOptions}
                                            onChange={(e) =>
                                              setFormState((prev) => ({
                                                ...prev,
                                                channel: e,
                                              }))
                                            }
                                            value={formState.channel}
                                          />
                                        </FormItem>
                                      )}
                                      <FormItem asterisk label="Content">
                                        <Select
                                          options={ContentList}
                                          onChange={(e) => {
                                            handleSelectChange(
                                              e,
                                              'ContentCode',
                                            );
                                            if (
                                              formState.OriginalRepeatCode
                                                ?.value
                                            ) {
                                              Bindstartnendtime(
                                                e.value,
                                                formState.OriginalRepeatCode
                                                  ?.value, formState?.channel?.value?.split("-")[0]
                                              );
                                            }
                                          }}
                                          value={
                                            ContentList !== null
                                              ? ContentList.filter(
                                                (option) =>
                                                  option.value ===
                                                  formState.ContentCode
                                                    ?.value,
                                              )
                                              : ContentDemo.filter(
                                                (option) => option,
                                              )
                                          }
                                        />
                                      </FormItem>
                                      <FormItem asterisk label="Org/Rep">
                                        <Select
                                          options={TimeBand}
                                          onChange={(e) => {
                                            handleSelectChange(
                                              e,
                                              'OriginalRepeatCode',
                                            );
                                            if (formState.ContentCode.value) {
                                              Bindstartnendtime(
                                                formState.ContentCode?.value,
                                                e.value, formState?.channel?.value?.split("-")[0]
                                              );
                                            }
                                          }}
                                          value={
                                            TimeBand !== null
                                              ? TimeBand.filter(
                                                (option) =>
                                                  option.value ===
                                                  formState.OriginalRepeatCode
                                                    ?.value,
                                              )
                                              : ContentDemo.filter(
                                                (option) => option,
                                              )
                                          }
                                        />
                                      </FormItem>
                                    </div>
                                    <FormItem asterisk label="Spot Type">
                                      <Select
                                        options={SpotType}
                                        onChange={(e) =>
                                          handleSelectChange(e, 'SpotTypeCode')
                                        }
                                        value={
                                          SpotType !== null
                                            ? SpotType.filter(
                                              (option) =>
                                                option.value ===
                                                formState.SpotTypeCode?.value,
                                            )
                                            : ContentDemo.filter(
                                              (option) => option,
                                            )
                                        }
                                      />
                                    </FormItem>
                                    <div className="col-span-1">
                                      <FormItem label="Remark">
                                        <Input
                                          value={formState.LineItemRemark}
                                          onChange={(e) => {
                                            if (
                                              e.target.value.length < 50 &&
                                              /^[0-9a-zA-Z\s]*$/.test(
                                                e.target.value,
                                              )
                                            ) {
                                              handleInputChange(
                                                e.target.value,
                                                'LineItemRemark',
                                              );
                                            }
                                          }}
                                        />
                                      </FormItem>
                                    </div>
                                  </div>
                                </FormContainer>
                              </div>

                              <div
                                className="col-span-1 dark:!bg-[#1f2639] bg-gray-100"
                                style={{
                                  padding: '10px',
                                  borderRadius: '.5rem',
                                }}
                              >
                                <FormContainer>
                                  <div className="grid grid-cols-2 gap-2">
                                    <FormItem asterisk label="Start Time">
                                      <Select
                                        options={Start}
                                        onChange={(e) =>
                                          handleSelectChange(
                                            e.value,
                                            'StartTime',
                                          )
                                        }
                                        value={
                                          Start !== null
                                            ? Start.filter(
                                              (option) =>
                                                option.value ===
                                                formState.StartTime,
                                            )
                                            : ContentDemo.filter(
                                              (option) => option,
                                            )
                                        }
                                      />
                                    </FormItem>
                                    <FormItem asterisk label="End Time">
                                      <Select
                                        options={End}
                                        onChange={(e) =>
                                          handleSelectChange(e.value, 'EndTime')
                                        }
                                        value={
                                          End !== null
                                            ? End.filter(
                                              (option) =>
                                                option.value ===
                                                formState.EndTime,
                                            )
                                            : ContentDemo.filter(
                                              (option) => option,
                                            )
                                        }
                                      />
                                    </FormItem>
                                    <FormItem asterisk label="Week Part">
                                      <Select
                                        options={Weekdays}
                                        onChange={(e) =>
                                          handleSelectChange(e, 'WeekDayCode')
                                        }
                                        value={
                                          Weekdays !== null
                                            ? Weekdays.filter(
                                              (option) =>
                                                option.value ===
                                                formState.WeekDayCode?.value,
                                            )
                                            : ContentDemo.filter(
                                              (option) => option,
                                            )
                                        }
                                      />
                                    </FormItem>
                                    <div className="col-span-1 ">
                                      <FormItem label="Cancel Line Item">
                                        <Switcher
                                          checked={
                                            formState.LineItemCancelStatus == 1
                                              ? true
                                              : false
                                          }
                                          onChange={(e) =>
                                            handleSwitchChange(
                                              e,
                                              'LineItemCancelStatus',
                                            )
                                          }
                                        />
                                      </FormItem>
                                    </div>
                                  </div>
                                </FormContainer>
                              </div>

                              <div className="col-span-3 mt-2">
                                <FormContainer>
                                  <div className="grid grid-cols-6 gap-2">
                                    <FormItem
                                      asterisk
                                      label={
                                        <p
                                          style={{
                                            fontSize: 16,
                                            fontWeight: 600,
                                          }}
                                        >
                                          Seconds
                                        </p>
                                      }
                                    >
                                      <Select
                                        isDisabled
                                        placeholder="Select"
                                        styles={{
                                          control: (baseStyles) => ({
                                            ...baseStyles,
                                            height: '3.5rem!important',
                                          }),
                                          singleValue: (baseStyles) => ({
                                            ...baseStyles,
                                            fontSize: '15px!important',
                                          }),
                                          menuList: (baseStyles) => ({
                                            ...baseStyles,
                                            fontSize: '15px!important',
                                          }),
                                        }}
                                        options={SECONDS_FOR_RATE_OPTIONS}
                                        onChange={(e) => {
                                          setSecondsForRate(e.value);
                                        }}
                                        value={SECONDS_FOR_RATE_OPTIONS.filter(
                                          (item) =>
                                            item.value === secondsForRate,
                                        )}
                                      />
                                    </FormItem>
                                    <FormItem
                                      asterisk
                                      label={
                                        <p
                                          style={{
                                            fontSize: 16,
                                            fontWeight: 600,
                                          }}
                                        >
                                          Rate Per {secondsForRate}[sec]
                                        </p>
                                      }
                                    >
                                      <Input
                                        size="lg"
                                        value={formState.Rate}
                                        style={{
                                          fontSize: 25,
                                          fontWeight: 600,
                                        }}
                                        disabled={
                                          formState.SpotTypeCode &&
                                          formState.SpotTypeCode.value === 2
                                        }
                                        onChange={(e) => {
                                          if (
                                            e.target.value.length < 8 &&
                                            /^[0-9.\s]*$/.test(e.target.value)
                                          ) {
                                            handleInputChange(
                                              e.target.value,
                                              'Rate',
                                            );
                                          }
                                          if (formState.Second) {
                                            calculateValue(
                                              e.target.value,
                                              formState.Second,
                                            );
                                          }
                                        }}
                                      />
                                    </FormItem>
                                    <FormItem
                                      asterisk
                                      label={
                                        <p style={{ fontSize: 16 }}>Seconds</p>
                                      }
                                    >
                                      <Input
                                        size="lg"
                                        value={formState.Second}
                                        onChange={(e) => {
                                          if (
                                            e.target.value.length <= 8 &&
                                            /^[0-9]*$/.test(e.target.value)
                                          ) {
                                            handleInputChange(
                                              e.target.value,
                                              'Second',
                                            );
                                          }
                                          if (formState.Rate) {
                                            calculateValue(
                                              formState.Rate,
                                              e.target.value,
                                            );
                                          }
                                        }}
                                        onBlur={() => {
                                          if (
                                            formStateCopy.Second >
                                            formState.Second
                                          ) {
                                            openNotification(
                                              'Error ',
                                              'danger',
                                              1000,
                                            );
                                            setFormState(formStateCopy);
                                          }
                                        }}
                                      />
                                    </FormItem>
                                    <FormItem
                                      asterisk
                                      label={
                                        <p style={{ fontSize: 16 }}>Amount</p>
                                      }
                                    >
                                      <Input
                                        size="lg"
                                        value={formState.Amount}
                                        disabled
                                        onChange={(e) => {
                                          if (
                                            e.target.value.length < 8 &&
                                            /^[0-9\s]*$/.test(e.target.value)
                                          ) {
                                            handleInputChange(
                                              e.target.value,
                                              'Amount',
                                            );
                                          }
                                        }}
                                      />
                                    </FormItem>
                                    <FormItem
                                      label={
                                        <p style={{ fontSize: 16 }}>
                                          Internal Rate
                                        </p>
                                      }
                                    >
                                      <Input
                                        size="lg"
                                        value={formState.InternalRate}
                                        onChange={(e) => {
                                          if (
                                            e.target.value.length < 8 &&
                                            /^[0-9.\s]*$/.test(e.target.value)
                                          ) {
                                            handleInputChange(
                                              e.target.value,
                                              'InternalRate',
                                            );
                                          }
                                        }}
                                      />
                                    </FormItem>
                                    <div></div>
                                  </div>
                                </FormContainer>
                              </div>
                            </div>
                          </TabContent>

                          {/* NTC wise */}
                          <TabContent value={4}>
                            <div
                              className="grid grid-cols-3 gap-1 dark:!border-[#374558] dark:!border dark:!bg-[#1f2639] bg-gray-100"
                              style={{
                                padding: '10px',
                                borderRadius: '.5rem',
                              }}
                            >
                              <div
                                className="col-span-2 dark:!bg-[#1f2639] bg-gray-100"
                                style={{
                                  padding: '10px',
                                  borderRadius: '.5rem',
                                }}
                              >
                                <FormContainer>
                                  <div className="grid grid-cols-2 gap-2">
                                    <div
                                      className={`col-span-2 grid ${IS_CHANNEL_SEL_ENABLED_FOR_DEAL_DETAILS
                                        ? 'grid-cols-5'
                                        : 'grid-cols-2'
                                        } gap-2`}
                                    >
                                      {IS_CHANNEL_SEL_ENABLED_FOR_DEAL_DETAILS && (
                                        <FormItem
                                          asterisk
                                          label="Channel"
                                          className="col-span-2"
                                        >
                                          <Select
                                            options={channelOptions}
                                            onChange={(e) =>
                                              setFormState((prev) => ({
                                                ...prev,
                                                channel: e,
                                              }))
                                            }
                                            value={formState.channel}
                                          />
                                        </FormItem>
                                      )}
                                      <FormItem
                                        asterisk
                                        label="RODP Category"
                                        className={
                                          IS_CHANNEL_SEL_ENABLED_FOR_DEAL_DETAILS
                                            ? 'col-span-2'
                                            : 'col-span-1'
                                        }
                                      >
                                        <Select
                                          options={RODP}
                                          onChange={(e) =>
                                            handleSelectChange(
                                              e,
                                              'TimeBandCode',
                                            )
                                          }
                                          value={
                                            RODP !== null
                                              ? RODP.filter(
                                                (option) =>
                                                  option.value ===
                                                  formState.TimeBandCode
                                                    ?.value,
                                              )
                                              : ContentDemo.filter(
                                                (option) => option,
                                              )
                                          }
                                        />
                                      </FormItem>
                                      <FormItem
                                        asterisk
                                        label="NTC Type"
                                        className="col-span-1"
                                      >
                                        <Select
                                          options={NTCType}
                                          onChange={(e) => {
                                            handleSelectChange(
                                              e,
                                              'NTCTypeCode',
                                            );
                                            setFormState((prevFormState) => ({
                                              ...prevFormState,
                                              IsNTC: 1,
                                            }));
                                          }}
                                          value={
                                            NTCType !== null
                                              ? NTCType.filter(
                                                (option) =>
                                                  option.value ===
                                                  formState.NTCTypeCode
                                                    ?.value,
                                              )
                                              : ContentDemo.filter(
                                                (option) => option,
                                              )
                                          }
                                        />
                                      </FormItem>
                                    </div>
                                    <FormItem asterisk label="Spot Type">
                                      <Select
                                        options={SpotType}
                                        onChange={(e) =>
                                          handleSelectChange(e, 'SpotTypeCode')
                                        }
                                        value={
                                          SpotType !== null
                                            ? SpotType.filter(
                                              (option) =>
                                                option.value ===
                                                formState.SpotTypeCode?.value,
                                            )
                                            : ContentDemo.filter(
                                              (option) => option,
                                            )
                                        }
                                      />
                                    </FormItem>
                                    <div className="col-span-1">
                                      <FormItem label="Remark">
                                        <Input
                                          value={formState.LineItemRemark}
                                          onChange={(e) => {
                                            if (
                                              e.target.value.length < 50 &&
                                              /^[0-9a-zA-Z\s]*$/.test(
                                                e.target.value,
                                              )
                                            ) {
                                              handleInputChange(
                                                e.target.value,
                                                'LineItemRemark',
                                              );
                                            }
                                          }}
                                        />
                                      </FormItem>
                                    </div>
                                  </div>
                                </FormContainer>
                              </div>

                              <div
                                className="col-span-1 dark:!bg-[#1f2639] bg-gray-100"
                                style={{
                                  padding: '10px',
                                  borderRadius: '.5rem',
                                }}
                              >
                                <FormContainer>
                                  <div className="grid grid-cols-2 gap-2">
                                    <FormItem asterisk label="Start Time">
                                      <Input
                                        size="sm"
                                        disabled
                                        value={formState.StartTime}
                                        onChange={(e) =>
                                          handleInputChange(
                                            e.target.value,
                                            'StartTime',
                                          )
                                        }
                                      />
                                    </FormItem>
                                    <FormItem asterisk label="End Time">
                                      <Input
                                        size="sm"
                                        disabled
                                        value={formState.EndTime}
                                        onChange={(e) =>
                                          handleInputChange(
                                            e.target.value,
                                            'EndTime',
                                          )
                                        }
                                      />
                                    </FormItem>
                                    <FormItem asterisk label="Week Part">
                                      <Select
                                        options={Weekdays}
                                        onChange={(e) =>
                                          handleSelectChange(e, 'WeekDayCode')
                                        }
                                        value={
                                          Weekdays !== null
                                            ? Weekdays.filter(
                                              (option) =>
                                                option.value ===
                                                formState.WeekDayCode?.value,
                                            )
                                            : ContentDemo.filter(
                                              (option) => option,
                                            )
                                        }
                                      />
                                    </FormItem>
                                    <div className="col-span-1 ">
                                      <FormItem label="Cancel Line Item">
                                        <Switcher
                                          checked={
                                            formState.LineItemCancelStatus == 1
                                              ? true
                                              : false
                                          }
                                          onChange={(e) =>
                                            handleSwitchChange(
                                              e,
                                              'LineItemCancelStatus',
                                            )
                                          }
                                        />
                                      </FormItem>
                                    </div>
                                  </div>
                                </FormContainer>
                              </div>
                              <div className="col-span-3 mt-2">
                                <FormContainer>
                                  <div className="grid grid-cols-6 gap-2">
                                    <div></div>
                                    <FormItem
                                      asterisk
                                      label={
                                        <p
                                          style={{
                                            fontSize: 16,
                                            fontWeight: 600,
                                          }}
                                        >
                                          Rate Per 10[spot]
                                        </p>
                                      }
                                    >
                                      <Input
                                        size="lg"
                                        value={formState.Rate}
                                        style={{
                                          fontSize: 25,
                                          fontWeight: 600,
                                        }}
                                        onChange={(e) => {
                                          if (
                                            e.target.value.length < 8 &&
                                            /^[0-9.\s]*$/.test(e.target.value)
                                          ) {
                                            handleInputChange(
                                              e.target.value,
                                              'Rate',
                                            );
                                          }
                                          if (formState.NTCTotalSpots) {
                                            calculateValue(
                                              e.target.value,
                                              formState.NTCTotalSpots,
                                            );
                                          }
                                        }}
                                      />
                                    </FormItem>
                                    <FormItem
                                      asterisk
                                      label={
                                        <p style={{ fontSize: 16 }}>
                                          NTC Spots
                                        </p>
                                      }
                                    >
                                      <Input
                                        size="lg"
                                        value={formState.NTCTotalSpots}
                                        onChange={(e) => {
                                          if (
                                            e.target.value.length <= 8 &&
                                            /^[0-9\s]*$/.test(e.target.value)
                                          ) {
                                            handleInputChange(
                                              e.target.value,
                                              'NTCTotalSpots',
                                            );
                                            if (formState.Rate) {
                                              calculateValueX(
                                                formState.Rate,
                                                e.target.value,
                                              );
                                            }
                                          }
                                        }}
                                        onBlur={() => {
                                          if (
                                            formStateCopy.NTCTotalSpots >
                                            formState.NTCTotalSpots
                                          ) {
                                            openNotification(
                                              'Error ',
                                              'danger',
                                              1000,
                                            );
                                            setFormState(formStateCopy);
                                          }
                                        }}
                                      />
                                    </FormItem>
                                    <FormItem
                                      asterisk
                                      label={
                                        <p style={{ fontSize: 16 }}>Amount</p>
                                      }
                                    >
                                      <Input
                                        size="lg"
                                        value={formState.Amount}
                                        disabled
                                        onChange={(e) => {
                                          if (
                                            e.target.value.length < 8 &&
                                            /^[0-9\s]*$/.test(e.target.value)
                                          ) {
                                            handleInputChange(
                                              e.target.value,
                                              'Amount',
                                            );
                                          }
                                        }}
                                      />
                                    </FormItem>
                                    <FormItem
                                      label={
                                        <p style={{ fontSize: 16 }}>
                                          Internal Rate
                                        </p>
                                      }
                                    >
                                      <Input
                                        size="lg"
                                        value={formState.InternalRate}
                                        onChange={(e) => {
                                          if (
                                            e.target.value.length < 8 &&
                                            /^[0-9.\s]*$/.test(e.target.value)
                                          ) {
                                            handleInputChange(
                                              e.target.value,
                                              'InternalRate',
                                            );
                                          }
                                        }}
                                      />
                                    </FormItem>
                                    <div></div>
                                  </div>
                                </FormContainer>
                              </div>
                            </div>
                          </TabContent>

                          {/* Slot wise */}
                          <TabContent value={5}>
                            <div
                              className="grid grid-cols-3 gap-1 dark:!border-[#374558] dark:!border dark:!bg-[#1f2639] bg-gray-100"
                              style={{
                                padding: '10px',
                                borderRadius: '.5rem',
                              }}
                            >
                              <div
                                className="col-span-2 dark:!bg-[#1f2639] bg-gray-100"
                                style={{
                                  padding: '10px',
                                  borderRadius: '.5rem',
                                }}
                              >
                                <FormContainer>
                                  <div className="grid grid-cols-2 gap-2">
                                    <div
                                      className={`col-span-2 grid ${IS_CHANNEL_SEL_ENABLED_FOR_DEAL_DETAILS
                                        ? 'grid-cols-3'
                                        : 'grid-cols-2'
                                        } gap-2`}
                                    >
                                      {IS_CHANNEL_SEL_ENABLED_FOR_DEAL_DETAILS && (
                                        <FormItem asterisk label="Channel">
                                          <Select
                                            options={channelOptions}
                                            onChange={(e) =>
                                              setFormState((prev) => ({
                                                ...prev,
                                                channel: e,
                                              }))
                                            }
                                            value={formState.channel}
                                          />
                                        </FormItem>
                                      )}
                                      <FormItem asterisk label="Content">
                                        <Select
                                          options={ContentList}
                                          onChange={(e) => {
                                            handleSelectChange(
                                              e,
                                              'ContentCode',
                                            );

                                            if (
                                              formState.OriginalRepeatCode
                                                ?.value
                                            ) {
                                              Bindstartnendtime(
                                                e.value,
                                                formState.OriginalRepeatCode
                                                  ?.value, formState?.channel?.value?.split("-")[0]
                                              );
                                            }
                                          }}
                                          value={
                                            ContentList !== null
                                              ? ContentList.filter(
                                                (option) =>
                                                  option.value ===
                                                  formState.ContentCode
                                                    ?.value,
                                              )
                                              : ContentDemo.filter(
                                                (option) => option,
                                              )
                                          }
                                        />
                                      </FormItem>
                                      <FormItem asterisk label="Org/Rep">
                                        <Select
                                          options={TimeBand}
                                          onChange={(e) => {
                                            handleSelectChange(
                                              e,
                                              'OriginalRepeatCode',
                                            );
                                            if (formState.ContentCode.value) {
                                              Bindstartnendtime(
                                                formState.ContentCode?.value,
                                                e.value, formState?.channel?.value?.split("-")[0]
                                              );
                                            }
                                          }}
                                          value={
                                            TimeBand !== null
                                              ? TimeBand.filter(
                                                (option) =>
                                                  option.value ===
                                                  formState.OriginalRepeatCode
                                                    ?.value,
                                              )
                                              : ContentDemo.filter(
                                                (option) => option,
                                              )
                                          }
                                        />
                                      </FormItem>
                                    </div>
                                    <FormItem asterisk label="Spot Type">
                                      <Select
                                        options={SpotType}
                                        onChange={(e) =>
                                          handleSelectChange(e, 'SpotTypeCode')
                                        }
                                        value={
                                          SpotType !== null
                                            ? SpotType.filter(
                                              (option) =>
                                                option.value ===
                                                formState.SpotTypeCode?.value,
                                            )
                                            : ContentDemo.filter(
                                              (option) => option,
                                            )
                                        }
                                      />
                                    </FormItem>
                                    <div className="col-span-1">
                                      <FormItem label="Remark">
                                        <Input
                                          value={formState.LineItemRemark}
                                          onChange={(e) => {
                                            if (
                                              e.target.value.length < 50 &&
                                              /^[0-9a-zA-Z\s]*$/.test(
                                                e.target.value,
                                              )
                                            ) {
                                              handleInputChange(
                                                e.target.value,
                                                'LineItemRemark',
                                              );
                                            }
                                          }}
                                        />
                                      </FormItem>
                                    </div>
                                  </div>
                                </FormContainer>
                              </div>

                              <div
                                className="col-span-1 dark:!bg-[#1f2639] bg-gray-100"
                                style={{
                                  padding: '10px',
                                  borderRadius: '.5rem',
                                }}
                              >
                                <FormContainer>
                                  <div className="grid grid-cols-2 gap-2">
                                    <FormItem asterisk label="Start Time">
                                      <Select
                                        options={Start}
                                        onChange={(e) =>
                                          handleSelectChange(
                                            e.value,
                                            'StartTime',
                                          )
                                        }
                                        value={
                                          Start !== null
                                            ? Start.filter(
                                              (option) =>
                                                option.value ===
                                                formState.StartTime,
                                            )
                                            : ContentDemo.filter(
                                              (option) => option,
                                            )
                                        }
                                      />
                                    </FormItem>
                                    <FormItem asterisk label="End Time">
                                      <Select
                                        options={End}
                                        onChange={(e) =>
                                          handleSelectChange(e.value, 'EndTime')
                                        }
                                        value={
                                          End !== null
                                            ? End.filter(
                                              (option) =>
                                                option.value ===
                                                formState.EndTime,
                                            )
                                            : ContentDemo.filter(
                                              (option) => option,
                                            )
                                        }
                                      />
                                    </FormItem>
                                    <FormItem asterisk label="Week Part">
                                      <Select
                                        options={Weekdays}
                                        onChange={(e) =>
                                          handleSelectChange(e, 'WeekDayCode')
                                        }
                                        value={
                                          Weekdays !== null
                                            ? Weekdays.filter(
                                              (option) =>
                                                option.value ===
                                                formState.WeekDayCode?.value,
                                            )
                                            : ContentDemo.filter(
                                              (option) => option,
                                            )
                                        }
                                      />
                                    </FormItem>
                                    <div className="col-span-1 ">
                                      <FormItem label="Cancel Line Item">
                                        <Switcher
                                          checked={
                                            formState.LineItemCancelStatus == 1
                                              ? true
                                              : false
                                          }
                                          onChange={(e) =>
                                            handleSwitchChange(
                                              e,
                                              'LineItemCancelStatus',
                                            )
                                          }
                                        />
                                      </FormItem>
                                    </div>
                                  </div>
                                </FormContainer>
                              </div>

                              <div className="col-span-3 mt-2">
                                <FormContainer>
                                  <div className="grid grid-cols-6 gap-2">
                                    <div></div>
                                    <FormItem
                                      asterisk
                                      label={
                                        <p
                                          style={{
                                            fontSize: 16,
                                            fontWeight: 600,
                                          }}
                                        >
                                          Rate Per Slot
                                        </p>
                                      }
                                    >
                                      <Input
                                        size="lg"
                                        value={formState.Rate}
                                        style={{
                                          fontSize: 25,
                                          fontWeight: 600,
                                        }}
                                        disabled={
                                          formState.SpotTypeCode &&
                                          formState.SpotTypeCode.value === 2
                                        }
                                        onChange={(e) => {
                                          if (
                                            e.target.value.length < 8 &&
                                            /^[0-9.\s]*$/.test(e.target.value)
                                          ) {
                                            handleInputChange(
                                              e.target.value,
                                              'Rate',
                                            );
                                          }

                                          if (formState.TotalSpots) {
                                            calculateValueXSpot(
                                              e.target.value,
                                              formState.TotalSpots,
                                            );
                                          }
                                        }}
                                      />
                                    </FormItem>
                                    <FormItem
                                      asterisk
                                      label={
                                        <p style={{ fontSize: 16 }}>Slot</p>
                                      }
                                    >
                                      <Input
                                        size="lg"
                                        value={formState.TotalSpots}
                                        onChange={(e) => {
                                          if (
                                            e.target.value.length <= 8 &&
                                            /^[0-9\s]*$/.test(e.target.value)
                                          ) {
                                            handleInputChange(
                                              e.target.value,
                                              'TotalSpots',
                                            );
                                          }

                                          if (formState.Rate) {
                                            calculateValueXSpot(
                                              formState.Rate,
                                              e.target.value,
                                            );
                                          }
                                        }}
                                        onBlur={() => {
                                          if (
                                            formStateCopy.TotalSpots >
                                            formState.TotalSpots
                                          ) {
                                            openNotification(
                                              'Error ',
                                              'danger',
                                              1000,
                                            );
                                            setFormState(formStateCopy);
                                          }
                                        }}
                                      />
                                    </FormItem>
                                    <FormItem
                                      asterisk
                                      label={
                                        <p style={{ fontSize: 16 }}>Amount</p>
                                      }
                                    >
                                      <Input
                                        size="lg"
                                        value={formState.Amount}
                                        disabled
                                        onChange={(e) => {
                                          if (
                                            e.target.value.length < 8 &&
                                            /^[0-9\s]*$/.test(e.target.value)
                                          ) {
                                            handleInputChange(
                                              e.target.value,
                                              'Amount',
                                            );
                                          }
                                        }}
                                      />
                                    </FormItem>
                                    <FormItem
                                      label={
                                        <p style={{ fontSize: 16 }}>
                                          Internal Rate
                                        </p>
                                      }
                                    >
                                      <Input
                                        size="lg"
                                        value={formState.InternalRate}
                                        onChange={(e) => {
                                          if (
                                            e.target.value.length < 8 &&
                                            /^[0-9.\s]*$/.test(e.target.value)
                                          ) {
                                            handleInputChange(
                                              e.target.value,
                                              'InternalRate',
                                            );
                                          }
                                        }}
                                      />
                                    </FormItem>
                                    <div></div>
                                  </div>
                                </FormContainer>
                              </div>
                            </div>
                          </TabContent>

                          {/* slot RODP */}
                          <TabContent value={6}>
                            <div
                              className="grid grid-cols-3 gap-1 dark:!border-[#374558] dark:!border dark:!bg-[#1f2639] bg-gray-100"
                              style={{
                                padding: '10px',
                                borderRadius: '.5rem',
                              }}
                            >
                              <div
                                className="col-span-2 dark:!bg-[#1f2639] bg-gray-100"
                                style={{
                                  padding: '10px',
                                  borderRadius: '.5rem',
                                }}
                              >
                                <FormContainer>
                                  <div className="grid grid-cols-2 gap-2">
                                    <div
                                      className={`col-span-2 grid ${IS_CHANNEL_SEL_ENABLED_FOR_DEAL_DETAILS
                                        ? 'grid-cols-5'
                                        : 'grid-cols-2'
                                        } gap-2`}
                                    >
                                      {IS_CHANNEL_SEL_ENABLED_FOR_DEAL_DETAILS && (
                                        <FormItem
                                          asterisk
                                          label="Channel"
                                          className="col-span-2"
                                        >
                                          <Select
                                            options={channelOptions}
                                            onChange={(e) =>
                                              setFormState((prev) => ({
                                                ...prev,
                                                channel: e,
                                              }))
                                            }
                                            value={formState.channel}
                                          />
                                        </FormItem>
                                      )}
                                      <FormItem
                                        asterisk
                                        label="RODP Category"
                                        className={
                                          IS_CHANNEL_SEL_ENABLED_FOR_DEAL_DETAILS
                                            ? 'col-span-2'
                                            : 'col-span-1'
                                        }
                                      >
                                        <Select
                                          options={RODP}
                                          onChange={(e) =>
                                            handleSelectChange(
                                              e,
                                              'TimeBandCode',
                                            )
                                          }
                                          value={
                                            RODP !== null
                                              ? RODP.filter(
                                                (option) =>
                                                  option.value ===
                                                  formState.TimeBandCode
                                                    ?.value,
                                              )
                                              : ContentDemo.filter(
                                                (option) => option,
                                              )
                                          }
                                        />
                                      </FormItem>

                                      <FormItem
                                        asterisk
                                        label="Spot Type"
                                        className="col-span-1"
                                      >
                                        <Select
                                          options={SpotType}
                                          onChange={(e) =>
                                            handleSelectChange(
                                              e,
                                              'SpotTypeCode',
                                            )
                                          }
                                          value={
                                            SpotType !== null
                                              ? SpotType.filter(
                                                (option) =>
                                                  option.value ===
                                                  formState.SpotTypeCode
                                                    ?.value,
                                              )
                                              : ContentDemo.filter(
                                                (option) => option,
                                              )
                                          }
                                        />
                                      </FormItem>
                                    </div>
                                    <div className="col-span-2">
                                      <FormItem label="Remark">
                                        <Input
                                          value={formState.LineItemRemark}
                                          onChange={(e) => {
                                            if (
                                              e.target.value.length < 50 &&
                                              /^[0-9a-zA-Z\s]*$/.test(
                                                e.target.value,
                                              )
                                            ) {
                                              handleInputChange(
                                                e.target.value,
                                                'LineItemRemark',
                                              );
                                            }
                                          }}
                                        />
                                      </FormItem>
                                    </div>
                                  </div>
                                </FormContainer>
                              </div>

                              <div
                                className="col-span-1 dark:!bg-[#1f2639] bg-gray-100"
                                style={{
                                  padding: '10px',
                                  borderRadius: '.5rem',
                                }}
                              >
                                <FormContainer>
                                  <div className="grid grid-cols-2 gap-2">
                                    <FormItem asterisk label="Start Time">
                                      <Input
                                        size="sm"
                                        value={formState.StartTime}
                                        disabled
                                        onChange={(e) =>
                                          handleInputChange(
                                            e.target.value,
                                            'StartTime',
                                          )
                                        }
                                      />
                                    </FormItem>
                                    <FormItem asterisk label="End Time">
                                      <Input
                                        size="sm"
                                        value={formState.EndTime}
                                        disabled
                                        onChange={(e) =>
                                          handleInputChange(
                                            e.target.value,
                                            'EndTime',
                                          )
                                        }
                                      />
                                    </FormItem>
                                    <FormItem asterisk label="Week Part">
                                      <Select
                                        options={Weekdays}
                                        onChange={(e) =>
                                          handleSelectChange(e, 'WeekDayCode')
                                        }
                                        value={
                                          Weekdays !== null
                                            ? Weekdays.filter(
                                              (option) =>
                                                option.value ===
                                                formState.WeekDayCode?.value,
                                            )
                                            : ContentDemo.filter(
                                              (option) => option,
                                            )
                                        }
                                      />
                                    </FormItem>
                                    <div className="col-span-1 ">
                                      <FormItem label="Cancel Line Item">
                                        <Switcher
                                          checked={
                                            formState.LineItemCancelStatus == 1
                                              ? true
                                              : false
                                          }
                                          onChange={(e) =>
                                            handleSwitchChange(
                                              e,
                                              'LineItemCancelStatus',
                                            )
                                          }
                                        />
                                      </FormItem>
                                    </div>
                                  </div>
                                </FormContainer>
                              </div>
                              <div className="col-span-3 mt-2">
                                <FormContainer>
                                  <div className="grid grid-cols-6 gap-2">
                                    <div></div>
                                    <FormItem
                                      asterisk
                                      label={
                                        <p
                                          style={{
                                            fontSize: 16,
                                            fontWeight: 600,
                                          }}
                                        >
                                          Rate Per Slot
                                        </p>
                                      }
                                    >
                                      <Input
                                        size="lg"
                                        value={formState.Rate}
                                        style={{
                                          fontSize: 25,
                                          fontWeight: 600,
                                        }}
                                        disabled={
                                          formState.SpotTypeCode &&
                                          formState.SpotTypeCode.value === 2
                                        }
                                        onChange={(e) => {
                                          if (
                                            e.target.value.length < 8 &&
                                            /^[0-9.\s]*$/.test(e.target.value)
                                          ) {
                                            handleInputChange(
                                              e.target.value,
                                              'Rate',
                                            );
                                          }
                                          if (formState.TotalSpots) {
                                            calculateValueXSpot(
                                              e.target.value,
                                              formState.TotalSpots,
                                            );
                                          }
                                        }}
                                      />
                                    </FormItem>
                                    <FormItem
                                      asterisk
                                      label={
                                        <p style={{ fontSize: 16 }}>Slot</p>
                                      }
                                    >
                                      <Input
                                        size="lg"
                                        value={formState.TotalSpots}
                                        onChange={(e) => {
                                          if (
                                            e.target.value.length <= 5 &&
                                            /^[0-9\s]*$/.test(e.target.value)
                                          ) {
                                            handleInputChange(
                                              e.target.value,
                                              'TotalSpots',
                                            );
                                          }
                                          if (formState.Rate) {
                                            calculateValueXSpot(
                                              formState.Rate,
                                              e.target.value,
                                            );
                                          }
                                        }}
                                        onBlur={() => {
                                          if (
                                            formStateCopy.TotalSpots >
                                            formState.TotalSpots
                                          ) {
                                            openNotification(
                                              'Error ',
                                              'danger',
                                              1000,
                                            );
                                            setFormState(formStateCopy);
                                          }
                                        }}
                                      />
                                    </FormItem>
                                    <FormItem
                                      asterisk
                                      label={
                                        <p style={{ fontSize: 16 }}>Amount</p>
                                      }
                                    >
                                      <Input
                                        size="lg"
                                        value={formState.Amount}
                                        disabled
                                        onChange={(e) => {
                                          if (
                                            e.target.value.length < 8 &&
                                            /^[0-9\s]*$/.test(e.target.value)
                                          ) {
                                            handleInputChange(
                                              e.target.value,
                                              'Amount',
                                            );
                                          }
                                        }}
                                      />
                                    </FormItem>
                                    <FormItem
                                      label={
                                        <p style={{ fontSize: 16 }}>
                                          Internal Rate
                                        </p>
                                      }
                                    >
                                      <Input
                                        size="lg"
                                        value={formState.InternalRate}
                                        onChange={(e) => {
                                          if (
                                            e.target.value.length < 8 &&
                                            /^[0-9.\s]*$/.test(e.target.value)
                                          ) {
                                            handleInputChange(
                                              e.target.value,
                                              'InternalRate',
                                            );
                                          }
                                        }}
                                      />
                                    </FormItem>
                                    <div></div>
                                  </div>
                                </FormContainer>
                              </div>
                            </div>
                          </TabContent>
                        </div>
                      </Tabs>
                    </div>
                    {currentTab != 0 && (
                      <div className="text-right px-6 py-3  rounded-bl-lg rounded-br-lg">
                        <Button
                          variant="solid"
                          size="sm"
                          onClick={() => AddDetails()}
                        >
                          {findId > -1 ? 'Edit' : 'Add'}
                        </Button>
                      </div>
                    )}

                    <DealCard
                      datg={CurrencySysmbol}
                      DataDisplay={DataDisplay}
                      setFormState={setFormState}
                      setfindId={setfindId}
                      setCurrentTab={setCurrentTab}
                      step={step}
                      setFormStateCopy={setFormStateCopy}
                      isChannelSelEnabledForDealDetails={
                        IS_CHANNEL_SEL_ENABLED_FOR_DEAL_DETAILS
                      }
                    />
                  </div>
                );
              case 2:
                return (
                  <div>
                    <DealHeader
                      datg={datg}
                      onPrevious={onPrevious2}
                      onCollapse={onCollapse}
                      onDialogClose={onDialogClose}
                      collapse={collapse}
                      setCurrentTab={setCurrentTab}
                    />
                    <DealCard
                      datg={CurrencySysmbol}
                      DataDisplay={DataDisplay}
                      setFormState={setFormState}
                      setfindId={setfindId}
                      setCurrentTab={setCurrentTab}
                      step={step}
                      setFormStateCopy={setFormStateCopy}
                      isChannelSelEnabledForDealDetails={
                        IS_CHANNEL_SEL_ENABLED_FOR_DEAL_DETAILS
                      }
                    />

                    <Upload
                      beforeUpload={beforeUpload}
                      uploadLimit={maxUpload}
                      draggable
                    >
                      <div className="text-center">
                        <div className="text-6xl mb-4 flex justify-center"></div>
                        <p className="font-semibold">
                          <span className="text-gray-800 dark:text-white">
                            Drop & browse your file here
                          </span>
                        </p>
                      </div>
                    </Upload>
                  </div>
                );
              case 3:
                return (
                  <>
                    <DealHeader
                      datg={datg}
                      onPrevious={onPrevious2}
                      onCollapse={onCollapse}
                      onDialogClose={onDialogClose}
                      collapse={collapse}
                      setCurrentTab={setCurrentTab}
                    />
                    <DealCard
                      datg={CurrencySysmbol}
                      DataDisplay={DataDisplay}
                      setFormState={setFormState}
                      setfindId={setfindId}
                      setCurrentTab={setCurrentTab}
                      step={step}
                      setFormStateCopy={setFormStateCopy}
                      isChannelSelEnabledForDealDetails={
                        IS_CHANNEL_SEL_ENABLED_FOR_DEAL_DETAILS
                      }
                    />
                    {selectedFile && (
                      <div className="upload-file-list">
                        {[selectedFile].map((file, index) => (
                          <FileItem
                            file={file}
                            key={file.name + index}
                          ></FileItem>
                        ))}
                      </div>
                    )}
                  </>
                );

              default:
                return null;
            }
          })()}
        </>
        <StickyFooter
          className="-mx-8 px-8 flex items-center justify-between py-4"
          stickyClass="border-t bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700"
        >
          <div className="md:flex items-center">
            <Button
              className="mx-2"
              size="sm"
              icon={<HiBackspace />}
              //   disabled={step === 0}
              onClick={() => {
                if (step === 0) {
                  navigate('/DealMaster');
                  return;
                }
                onPrevious();
              }}
            >
              {step === 0 ? 'Discard' : 'Previous'}
            </Button>

            {step === 1 ? (
              <Button
                disabled={step === 3}
                variant="solid"
                icon={
                  step === 3 ? <AiOutlineSave /> : <IoMdArrowRoundForward />
                }
                size="sm"
                onClick={() => {
                  if (currentTab != 0) {
                    DealLineAddValidation(formState, currentTab);
                    setFormStateCopy({ channel: Channel });

                    return;
                  }
                  if (DataDisplay.length > 0) {
                    onChange(step + 1);
                    setFormStateCopy({ channel: Channel });
                  } else {
                    openNotification(
                      'Please add atleast one Deal Line!!',
                      'danger',
                    );
                    return;
                  }
                }}
              >
                {step === 3 ? 'Completed' : 'Next'}
              </Button>
            ) : step === 2 ? (
              <Button
                disabled={step === 3}
                variant="solid"
                size="sm"
                icon={
                  step === 3 ? <AiOutlineSave /> : <IoMdArrowRoundForward />
                }
                onClick={() => {
                  onChange(step + 1);
                }}
              >
                {step === 3 ? 'Completed' : 'Next'}
              </Button>
            ) : (
              <Button
                disabled={step2 === 4}
                variant="solid"
                size="sm"
                icon={
                  step === 3 ? <AiOutlineSave /> : <IoMdArrowRoundForward />
                }
                // onClick={onNext}
                onClick={() => {
                  if (step === 3) {
                    onFinalSave();
                  } else {
                    onNext();
                  }
                }}
              >
                {step === 3 ? 'Completed' : 'Next'}
              </Button>
            )}
          </div>
          {/* <div className="flex items-center">
            <p className="ml-2  ">
              Total Amount =
              <span
                style={{
                  fontSize: 20,
                  fontWeight: 600,
                  color: 'white',
                }}
              >
                {CurrencySysmbol} {totalAmount.toLocaleString('en-IN')}
              </span>
            </p>
            <p className="ml-2 dark:text-white">
              Total Seconds =
              <span
                style={{
                  fontSize: 20,
                  fontWeight: 600,
                  color: 'white',
                }}
              >
                {totalSeconds}
              </span>
            </p>
            <p className="ml-2 dark:text-white">
              Total Spot / NTC Spot={' '}
              <span
                style={{
                  fontSize: 20,
                  fontWeight: 600,
                  color: 'white',
                }}
              >
                {totalSlotAndNTC}
              </span>
            </p>
          </div> */}

          <div
            id="myblock"
            className="grid grid-cols-3 md:grid-cols-3 lg:grid-cols-6 gap-4 p-4 pt-0 pb-1 bg-gray-100 dark:bg-gray-800"
          >
            <div></div>
            <div></div>
            <div></div>
            <div className="flex flex-col  ">
              <span className="font-medium text-gray-600 dark:text-gray-300 text-sm">
                Total Amount
              </span>
              <span className=" text-lg font-bold lblColor">
                {CurrencySysmbol}
                {totalAmount.toLocaleString('en-IN')}
              </span>
            </div>

            <div className="flex flex-col  ">
              <span className="font-medium text-gray-600 dark:text-gray-300 text-sm">
                Total Seconds
              </span>
              <span className=" text-lg font-bold lblColor">
                {totalSeconds}
              </span>
            </div>

            <div className="flex flex-col  ">
              <span className="font-medium text-gray-600 dark:text-gray-300 text-sm">
                Total Spot/NTC
              </span>
              <span className=" text-lg font-bold lblColor">
                {totalSlotAndNTC}
              </span>
            </div>
          </div>
        </StickyFooter>
      </Card>
    </>
  );
});

export default DealMasterAdd;
