"use strict";(self.webpackChunkelstar=self.webpackChunkelstar||[]).push([[4333],{94333:(e,s,t)=>{t.r(s),t.d(s,{default:()=>C});var a=t(72791),i=t(91615),n=t(21260),l=t(2803),r=t(29851),o=t(8458),c=t(45682),d=t(1413),m=t(81320),u=t(76061),x=t(78638),p=t(48851),h=t(763),w=t.n(h),g=t(80184);const T=function(e){let{isDialogOpen:s,setIsDialogOpen:t,row:r,editRowInfo:o}=e;const{schedulingTableData:c,executeOperation:h,isAutoCalcNtcOffsetTime:T}=(0,a.useContext)(i.Z),[N,j]=(0,a.useState)(r.Duration),[f,v]=(0,a.useState)(r.OffsetStartTime),[D,C]=(0,a.useState)(r.DefaultGAP),[E,I]=(0,a.useState)(r.Description),S=(0,x.getNTCParentRow)(r.rowIndex,c),_=()=>{t(!1)},y=e=>{"Enter"===e.key&&11===N.length&&11===f.length&&11===D.length&&b()},b=async()=>{try{let e;T?e=O():(e=[...c],e[r.rowIndex]=(0,d.Z)((0,d.Z)({},r),{},{OffsetStartTime:f,DefaultGAP:D,Duration:N,Description:E})),"Description"in r||delete e[r.rowIndex].Description,await h({operation:n.operationTypesEnum.UPDATE_TABLE,newSchTableData:e}),(0,m.openNotification)("success","Changes saved successfully"),_()}catch(e){(0,m.openNotification)("danger","Something went wrong while saving changes"),console.error(e)}},O=()=>{let e=w().cloneDeep(c);e[r.rowIndex].Duration=N,e[r.rowIndex].Description=E;const s=c[r.rowIndex-1],t=s.F_C_S_P===n.rowDataTypesEnum.NTC;if(T&&t&&s.NTCGroupCode===r.NTCGroupCode){const t=(0,u.addTimes)(s.Start_Time,s.Duration),a=(0,m.subtractTimes)(f,t);e[r.rowIndex-1]=(0,d.Z)((0,d.Z)({},s),{},{DefaultGAP:a})}else e[r.rowIndex]=(0,d.Z)((0,d.Z)({},e[r.rowIndex]),{},{OffsetStartTime:f,Start_Time:f,Tel_Time:f,DefaultGAP:D});return e=(0,p.Au)(e),e},F=(e,s)=>s?(0,u.addTimes)(e.Start_Time,e.Duration,e.DefaultGAP):(0,u.addTimes)(e.Start_Time,e.Duration),R=11===N.length&&(0,u.addTimes)(f,N)>S.Duration?"NTC Duration cannot be greater than its parent's duration":"",A=11===f.length?(e=>{const s=c[r.rowIndex-1],t=s.F_C_S_P===n.rowDataTypesEnum.NTC,a=(0,u.addTimes)(e,N);if(!T||!t||s.NTCGroupCode!==r.NTCGroupCode)return a>S.Duration?"NTC end time should not exceed its parent's end time":"";const i=F(s,!0);return(0,u.addTimes)(s.Start_Time,e)<i?"NTC start time should not overlap with its previous NTC":a>S.Duration?"NTC end time should not exceed its parent's end time":""})(f):"";return(0,g.jsx)(g.Fragment,{children:o&&(0,g.jsxs)(l.Vq,{isOpen:s,onClose:_,className:"z-[1000]",width:"40%",children:[(0,g.jsx)("h5",{className:"mb-4",children:"Edit NTC"}),(0,g.jsxs)("div",{className:"max-h-96 overflow-y-auto flex flex-col gap-8",children:[(0,g.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,g.jsxs)("div",{className:"col-span-2",children:[(0,g.jsx)("p",{className:"text-white mb-1",children:"NTC Name"}),(0,g.jsx)(l.II,{size:"sm",value:r.Event_Name,disabled:!0})]}),(0,g.jsxs)("div",{children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("p",{className:"text-white mb-1",children:"NTC Duration"}),(0,g.jsx)(l.II,{size:"sm",value:N,onChange:e=>j((0,m.getFormattedTime)(e,N)),onBlur:()=>j((0,m.autoCompleteTime)(N)),onKeyDown:y})]}),R&&(0,g.jsx)("p",{className:"text-red-500 mt-1.5 leading-tight",children:R})]})]}),(0,g.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("p",{className:"text-white mb-1",children:"Parent Start Time"}),(0,g.jsx)(l.II,{size:"sm",value:S.Start_Time,disabled:!0})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("p",{className:"text-white mb-1",children:"Parent End Time"}),(0,g.jsx)(l.II,{size:"sm",value:F(S),disabled:!0})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("p",{className:"text-white mb-1",children:"Parent Duration"}),(0,g.jsx)(l.II,{size:"sm",value:S.Duration,disabled:!0})]})]}),(0,g.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,g.jsxs)("div",{children:[(0,g.jsxs)("p",{className:"text-white mb-1",children:["Offset Time ",(0,g.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,g.jsx)(l.II,{size:"sm",value:f,placeholder:"HH:FF:SS:FF",onChange:e=>v((0,m.getFormattedTime)(e,f)),onBlur:()=>v((0,m.autoCompleteTime)(f)),onKeyDown:y}),A&&(0,g.jsx)("p",{className:"text-red-500 mt-1.5 leading-tight",children:A})]}),(0,g.jsxs)("div",{children:[(0,g.jsxs)("p",{className:"text-white mb-1",children:["Gap ",(0,g.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,g.jsx)(l.II,{size:"sm",value:D,placeholder:"HH:FF:SS:FF",onChange:e=>C((0,m.getFormattedTime)(e,D)),onBlur:()=>C((0,m.autoCompleteTime)(D)),onKeyDown:y})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("p",{className:"text-white mb-1",children:"NTC End Time"}),(0,g.jsx)(l.II,{size:"sm",value:11===f.length?(0,u.addTimes)(S.Start_Time,f,r.Duration):"HH:MM:SS:FF",disabled:!0})]})]}),"Description"in r&&(0,g.jsxs)("div",{children:[(0,g.jsx)("p",{className:"text-white mb-1",children:"Description"}),(0,g.jsx)(l.II,{size:"sm",placeholder:"Description",value:E,onChange:e=>I(e.target.value)})]})]}),(0,g.jsx)("div",{className:"text-right mt-6",children:(0,g.jsx)(l.zx,{variant:"solid",onClick:b,disabled:N.length<11||f.length<11||D.length<11||A||R,children:"Submit"})})]})})};const N=function(e){let{isDialogOpen:s,setIsDialogOpen:t,row:r}=e;const{schedulingTableData:o,executeOperation:c}=(0,a.useContext)(i.Z),[u,x]=(0,a.useState)(r.Duration),p=()=>{t(!1)};return(0,g.jsxs)(l.Vq,{isOpen:s,onClose:p,onRequestClose:p,children:[(0,g.jsx)("h5",{className:"mb-4",children:"Edit Live Event"}),(0,g.jsx)("div",{className:"max-h-96 overflow-y-auto flex flex-col gap-8",children:(0,g.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("p",{className:"text-white mb-1",children:"Live Event"}),(0,g.jsx)(l.II,{size:"sm",value:r.Event_Name,disabled:!0})]}),(0,g.jsxs)("div",{children:[(0,g.jsxs)("p",{className:"text-white mb-1",children:["Duration ",(0,g.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,g.jsx)(l.II,{size:"sm",value:u,onChange:e=>x((0,m.getFormattedTime)(e,u)),onBlur:()=>x((0,m.autoCompleteTime)(u))})]})]})}),(0,g.jsx)("div",{className:"text-right mt-6",children:(0,g.jsx)(l.zx,{variant:"solid",onClick:async()=>{try{let e=[...o];e[r.rowIndex]=(0,d.Z)((0,d.Z)({},r),{},{Duration:u}),await c({operation:n.operationTypesEnum.UPDATE_TABLE,newSchTableData:e}),(0,m.openNotification)("success","Changes saved successfully"),p()}catch(e){console.error(e),(0,m.openNotification)("danger","Something went wrong while saving changes")}},disabled:u.length<11,children:"Save"})})]})},j=(0,a.lazy)((()=>Promise.resolve().then(t.bind(t,37783)))),f=(0,a.lazy)((()=>Promise.resolve().then(t.bind(t,96042))));const v=function(e){let{action:s,row:t,selectedRows:d,setSelectedRows:m}=e;const{executeOperation:u,activeFeatures:x,setActiveFeatures:p,schedulingTableData:h,setSchedulingTableSelectedRows:w,maintainScrolledOffsetOfTables:v,secondaryAreaZindexRef:D}=(0,a.useContext)(i.Z),[C,E]=(0,a.useState)(!1),[I,S]=(0,a.useState)(!1),[_,y]=(0,a.useState)(!1);return(0,g.jsxs)(a.Suspense,{fallback:(0,g.jsx)(c.default,{showLoader:!0}),children:[(0,g.jsx)(l.u,{title:s.tooltip,wrapperClass:"hover:cursor-pointer",children:(0,g.jsx)("div",{className:"bg-gray-800 bg-opacity-80 rounded-full p-1",onClick:e=>{e.stopPropagation(),e.ctrlKey||e.metaKey||s.actionHandler({rows:"rotationInfo"===s.id||0===d.length?[t]:d,executeOperation:u,activeFeatures:x,setActiveFeatures:p,setIsDeleteMultipleRowsDialogOpen:E,setIsDropMultipleRowsDialogOpen:S,setSchedulingTableSelectedRows:w,maintainScrolledOffsetOfTables:v,setIsEditingRowDialogOpen:y,tableData:h,secondaryAreaZindexRef:D})},children:s.icon})}),C&&(0,g.jsx)(j,{isDialogOpen:C,setIsDialogOpen:E,selectedRows:(0,r.wC)(d),setSelectedRows:m}),I&&(0,g.jsx)(f,{isDialogOpen:I,setIsDialogOpen:S,selectedRows:d.filter((e=>e.F_C_S_P===n.rowDataTypesEnum.COMMERCIAL)),setSelectedRows:m}),_&&(0,g.jsxs)(g.Fragment,{children:[t.F_C_S_P===n.rowDataTypesEnum.NTC&&(0,g.jsx)(T,{isDialogOpen:_,setIsDialogOpen:y,row:t,editRowInfo:o.pq[t.F_C_S_P]}),t.F_C_S_P===n.rowDataTypesEnum.LIVE&&(0,g.jsx)(N,{isDialogOpen:_,setIsDialogOpen:y,row:t})]})]})};var D=t(41578);const C=function(e){let{row:s,column:t,selectedRows:r,setSelectedRows:c,setIsChangeProgramDialogOpen:d,setClickedProgram:m,tableType:u}=e;const{activeFeatures:x,isScheduleAllowedToEdit:p}=(0,a.useContext)(i.Z);return(0,g.jsx)(g.Fragment,{children:u!==n.tableTypesEnum.SCHEDULING||x[n.featuresEnum.ROTATION_INFO]||x[n.featuresEnum.ROTATION_INFO_WITH_MANAGE_COLUMNS]||!p?(0,g.jsx)("div",{className:"py-1 px-2.5 overflow-hidden text-ellipsis whitespace-nowrap text-[12px] w-full",children:s[t.accessorKey]}):(0,g.jsxs)(g.Fragment,{children:[!x[n.featuresEnum.CHANGE_PROGRAM]&&!x[n.featuresEnum.MANAGE_SEGMENT]&&(0,g.jsx)(g.Fragment,{children:s.actions?(0,g.jsx)("div",{className:"group-hover:flex w-full h-full flex items-center gap-[1%] justify-".concat("Event_Name"!==t.accessorKey&&"center"," ").concat(r.length>0&&r.map((e=>e.rowId)).includes(s.rowId)?"flex":"hidden"),children:s.actions.map((e=>(0,g.jsx)(v,{action:e,row:s,selectedRows:r,setSelectedRows:c},e.id)))}):(0,g.jsx)("div",{className:"py-1 px-2.5 overflow-hidden text-ellipsis whitespace-nowrap text-[12px] w-full",children:s[t.accessorKey]})}),x[n.featuresEnum.CHANGE_PROGRAM]&&s.F_C_S_P===n.rowDataTypesEnum.CONTENT_TERMINATION&&(0,g.jsxs)("div",{className:"py-1 px-2.5 overflow-hidden text-ellipsis whitespace-nowrap text-[12px] w-full flex items-center justify-center gap-[0.2rem]",onClick:e=>{e.stopPropagation(),d(!0),m(s)},children:[s[t.accessorKey],(0,g.jsx)(l.u,{title:"Replace Program",wrapperClass:"hover:cursor-pointer",children:(0,g.jsx)("div",{className:"bg-gray-800 bg-opacity-80 rounded-full p-1 flex items-center justify-center",children:(0,g.jsx)(D.hwI,{className:"text-gray-200 text-[1rem] -scale-x-100"})})})]}),x[n.featuresEnum.MANAGE_SEGMENT]&&(0,g.jsxs)("div",{className:"py-1 px-2.5 overflow-hidden text-ellipsis whitespace-nowrap text-[12px] w-full flex items-center justify-center gap-[0.2rem]",children:[s.F_C_S_P===n.rowDataTypesEnum.SEGMENT&&(0,g.jsx)(v,{action:o.l0.DELETE,row:s,selectedRows:r,setSelectedRows:c},o.l0.DELETE.id),s.F_C_S_P===n.rowDataTypesEnum.CONTENT_TERMINATION&&(0,g.jsxs)(g.Fragment,{children:[s[t.accessorKey],1!==s.rowIndex&&(0,g.jsx)(v,{action:o.l0.DELETE,row:s,selectedRows:r,setSelectedRows:c},o.l0.DELETE)]})]})]})})}}}]);
//# sourceMappingURL=4333.7fcb8820.chunk.js.map