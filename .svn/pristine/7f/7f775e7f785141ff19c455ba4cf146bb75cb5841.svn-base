import React, { useState } from 'react';
import { format, startOfMonth, endOfMonth, startOfWeek, endOfWeek, addDays, isSameMonth, isSameDay, parseISO } from 'date-fns';
import './cal.css';
import { FaChevronLeft, FaFolderPlus, FaMinus, FaPlus, FaPlusCircle } from 'react-icons/fa';

const CalendarE = ({ month, events }) => {

    const startDate = startOfWeek(startOfMonth(month));
    const endDate = endOfWeek(endOfMonth(month));
    const [first, setfirst] = useState(1)
    const rows = [];
    let days = [];
    let day = startDate;
    let formattedDate = '';

    while (day <= endDate) {
        for (let i = 0; i < 7; i++) {
            formattedDate = format(day, 'd');
            const cloneDay = day;
            const dayEvents = events.filter(event => isSameDay(parseISO(event.date), day));
            days.push(
                <div
                    className={`col  ${!isSameMonth(day, month) ? 'disabled' : isSameDay(day, new Date()) ? 'selected' : ''}`}
                    key={day}
                >
                    <div className='hisd'>
                        <span className="number">{formattedDate}</span>
                        <div className='flex items-center '>
                            <div
                                className="p-2 rounded hover:bg-sky-700  cursor-pointer"
                                onClick={() => setfirst(first + 1)}
                            >
                                <FaPlus size={10} />
                            </div>

                            <p className='p-1'>{first}</p>


                            <div
                                className="p-2 rounded hover:bg-sky-700  cursor-pointer"
                                onClick={() => setfirst(first - 1)}
                            >
                                <FaMinus size={10} />
                            </div>
                        </div>
                        {dayEvents.map(event => (
                            <div key={event.id} className="event">
                                {event.title}
                            </div>
                        ))}
                    </div>
                </div>
            );
            day = addDays(day, 1);
        }
        rows.push(
            <div className="row" key={day}>
                {days}
            </div>
        );
        days = [];
    }

    return (
        <div className="calendar">
            <div className="headerss ">
                <div className="col col-start">Sun</div>
                <div className="col">Mon</div>
                <div className="col">Tue</div>
                <div className="col">Wed</div>
                <div className="col">Thu</div>
                <div className="col">Fri</div>
                <div className="col col-end">Sat</div>
            </div>
            {rows}
        </div>
    );
};

export default CalendarE;
