"use strict";(self.webpackChunkelstar=self.webpackChunkelstar||[]).push([[6764],{96361:(e,t,n)=>{n.d(t,{Z:()=>r});var a=n(79139),s=n(60364),o=n(11087),l=n(80184);const r=e=>{let{ModuleText:t="Admin",Component:n,links:r}=e;(0,s.useSelector)((e=>e.auth.session.currentRouteKey));const d=(0,s.useSelector)((e=>e.base.common.currentRouteTitle));console.log(d);const{title:c,Moduletitle:i}=(0,s.useSelector)((e=>e.auth.user));return(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-xl font-medium",children:d}),(0,l.jsxs)(a.Breadcrumbs,{style:{marginLeft:"-15px",width:"auto"},children:[(0,l.jsx)(o.rU,{to:"/home",className:"opacity-60 text-xs",children:(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",viewBox:"0 0 20 20",fill:"currentColor",children:(0,l.jsx)("path",{d:"M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"})})}),(0,l.jsx)(o.rU,{to:"/".concat("SALES ADMIN"===i?"SalesAdmin":i),className:"opacity-60 text-xs",children:(0,l.jsx)("span",{children:i})}),(0,l.jsx)(o.rU,{to:"#",className:"text-xs",children:(0,l.jsx)("span",{children:d})})]})]})}},96764:(e,t,n)=>{n.r(t),n.d(t,{default:()=>M});var a=n(1413),s=n(72791),o=n(9494),l=n(54748),r=n(60364),d=n(2803),c=n(67388),i=n(96361),C=n(81320),p=n(45987),u=n(81694),m=n.n(u),v=n(27805),h=n(70582),x=n(26977),N=n(68476),E=(n(44489),n(10132),n(16176),n(80184));const j=["wrapperClass"],b=e=>{const{wrapperClass:t}=e,n=(0,p.Z)(e,j);return(0,E.jsx)("div",{className:m()("calendar",t),children:(0,E.jsx)(v.ZPm,(0,a.Z)({allDaySlot:!1,eventContent:e=>{const{extendedProps:t}=e.event,{isEnd:n,isStart:a}=e;return(0,E.jsxs)("div",{className:m()("custom-calendar-event !min-h-0 p-1",t.eventColor&&"bg-".concat(t.eventColor," bg-opacity-40"),n&&!a&&"!rounded-tl-none !rounded-bl-none !rtl:rounded-tr-none !rtl:rounded-br-none",!n&&a&&"!rounded-tr-none !rounded-br-none !rtl:rounded-tl-none !rtl:rounded-bl-none","text-[11px]","text-".concat(t.eventColor.split("-")[0],"-100 font-semibold")),children:[(0,E.jsx)("p",{className:"mb-2",children:e.event.title}),t.MapEventName&&(0,E.jsx)("div",{className:"flex justify-center",children:(0,E.jsx)("span",{className:"text-center py-1 px-2 rounded-full",style:{border:"1px solid rgb(16 185 129)"},children:t.MapEventName})})]})},plugins:[h.ZP,x.ZP,N.ZP]},n))})};var f=n(81721);const M=()=>{const e=(0,r.useSelector)((e=>e.locale.selectedChannel)),[t,n]=(0,s.useState)([]),[p,u]=(0,s.useState)({label:"",value:""}),[m,v]=(0,s.useState)({start:"",end:""}),[h,x]=(0,s.useState)(!1),[N,j]=(0,s.useState)([]),[M,g]=(0,s.useState)("Map Teams"),[y,S]=(0,s.useState)(null),T=()=>{x(!1),u({label:"",value:""}),S(null)},w=async t=>{let a={LocationCode:e.LocationCode,ChannelCode:e.ChannelCode,IsGroup:0,EventContentCode:t};const s=await(0,c.apiGetContentmaster)(a);if(204==s.status)return void n([]);const o=N.filter((e=>e.MapEventCode)),l=s.data.filter((e=>!o.find((t=>t.MapEventCode==e.ContentCode)))).map((e=>({value:e.ContentCode,label:e.ContentName})));n(l)},k=async()=>{try{const e=await(0,c.apiGetContentmasterDropEventWise)(1);if(204==e.status)return void n([]);const t=e.data.map((e=>({value:e.ContentCode,label:e.ContentName})));n(t)}catch(e){}};function L(e){const[t,n]=e.split(":").map(Number);return t>=12?"PM":"AM"}(0,s.useEffect)((()=>{(async()=>{try{const t=await(0,o.apiCallstoreprocedure)("USP_PG_GetWeeklyFPC",{Locationcode:e.LocationCode,ChannelCode:e.ChannelCode,FromDate:m.start,Todate:m.end}),n=N.filter((e=>e.MapEventName)),s=t.data.filter((e=>1===e.GroupName)).map(((e,t)=>({id:t,title:" ".concat(e.ContentName," "),start:"".concat(e.TelecastDate,"T").concat(e.TelecastStartTime,":00"),startlabel:"".concat(e.TelecastStartTime),endlabel:"".concat(e.TelecastEndTime),NewContent:"".concat(e.TelecastStartTime),isAMPM:L(e.TelecastEndTime),end:"".concat(e.TelecastDate,"T").concat(e.TelecastEndTime,":00"),eventColor:e.MapEventCode?"emerald-500":"orange-500",MapEventCode:e.MapEventCode,MapEventName:e.MapEventName,ContentCode:e.ContentCode}))),l=n.some((e=>s.some((t=>t.ContentCode===e.ContentCode&&t.start===e.start&&t.end===e.end)))),r=s.map((e=>{const t=n.find((t=>t.ContentCode===e.ContentCode&&t.start===e.start&&t.end===e.end));return t?(0,a.Z)({},t):{id:e.id,title:e.title,start:e.start,startlabel:e.startlabel,endlabel:e.endlabel,NewContent:e.NewContent,isAMPM:e.isAMPM,end:e.end,eventColor:e.MapEventCode?"emerald-500":"orange-500",MapEventCode:e.MapEventCode,MapEventName:e.MapEventName,ContentCode:e.ContentCode}}));j(l?r:[...s,...n])}catch(t){console.error("Error fetching data:",t)}})(),k()}),[m,e]);const P=e=>{const{id:t,extendedProps:n}=e.event;w(n.ContentCode),S(t),x(!0)};return(0,E.jsxs)(d.Zb,{header:(0,E.jsx)(i.Z,{}),children:[(0,E.jsx)(b,{initialView:"timeGridWeek",allDaySlot:!1,dayHeaderFormat:{weekday:"short",day:"numeric"},headerToolbar:{left:"title",center:"",right:"prev,next"},selectable:!0,eventClick:P,events:N,select:P,datesSet:e=>{v({start:(0,l.Tk)(e.start),end:(0,l.Tk)(e.end)})}}),(0,E.jsx)(f.gi,{className:"-mx-8 px-8 flex items-center justify-end py-4 z-10",stickyClass:"border-t bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:(0,E.jsx)("div",{className:"flex gap-3",children:(0,E.jsx)(d.zx,{variant:"solid",onClick:()=>{(async e=>{try{const t=await(0,c.apiPosteventplanner)(e);200===t.status?(0,C.openNotification)("success","Events saved successfully."):204==t.status&&(0,C.openNotification)("danger","data not found")}catch(t){500==t.response.status&&(0,C.openNotification)("danger","Server Error."),422==t.response.status&&(0,C.openNotification)("danger","Server Error.")}})(N.filter((e=>""!=e.MapEventCode)).map((t=>({EventCode:t.EventCode||0,LocationCode:e.LocationCode||0,ChannelCode:e.ChannelCode||0,EventContentCode:t.ContentCode||0,ContentCode:t.MapEventCode||0,EventDate:t.start.split("T")[0],StartTime:t.start}))))},children:"Save"})})}),(0,E.jsxs)(d.Vq,{isOpen:h,onClose:T,onRequestClose:T,children:[(0,E.jsx)("h4",{className:"mb-4",children:"Add New Event"}),(0,E.jsx)("div",{className:"grid grid-cols-1 gap-4 h-28",children:(0,E.jsxs)("div",{children:[(0,E.jsx)("div",{children:(0,E.jsxs)(d.Y8.Group,{value:M,onChange:e=>{g(e),"ALL"===e?w():k()},children:[(0,E.jsx)(d.Y8,{value:"Map Teams",children:"Mapped Event"}),(0,E.jsx)(d.Y8,{value:"ALL",children:"ALL"})]})}),(0,E.jsx)("p",{className:"text-white mb-1 mt-4",children:"Event Name"}),(0,E.jsx)(d.Ph,{options:t,value:t.filter((e=>e.value===p.value)),onChange:e=>u(e),size:"sm",placeholder:"Select"})]})}),(0,E.jsxs)("div",{className:"text-right mt-6",children:[(0,E.jsx)(d.zx,{className:"ltr:mr-2 rtl:ml-2",variant:"plain",onClick:T,children:"Cancel"}),(0,E.jsx)(d.zx,{variant:"solid",onClick:()=>{null!==y&&j((e=>e.map((e=>e.id==y?(0,a.Z)((0,a.Z)({},e),{},{MapEventCode:p.value,MapEventName:p.label,eventColor:"emerald-500"}):e)))),T()},children:"Okay"})]})]})]})}}}]);
//# sourceMappingURL=6764.fe3e50bd.chunk.js.map