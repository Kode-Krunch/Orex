"use strict";(self.webpackChunkelstar=self.webpackChunkelstar||[]).push([[7415],{47415:(e,t,n)=>{n.r(t),n.d(t,{default:()=>C});var a=n(72791),r=n(21260),o=n(29851),s=n(81320),l=n(91615),c=n(2803),i=n(84373),u=n(41026),d=n(36996),m=n(48080),x=n(40071),h=n(80184);const{Tr:p,Th:g,Td:f,THead:N,TBody:E}=u.Z;const b=function(e){let{tableData:t}=e;const{page:n,schedulingTableRef:o}=(0,a.useContext)(l.Z),[s,i]=(0,a.useState)([]),[b,C]=(0,a.useState)({}),D=function(){try{let e=[{id:"expander",header:e=>{let{table:t}=e;return(0,h.jsx)("button",{onClick:t.getToggleAllRowsExpandedHandler(),children:t.getIsAllRowsExpanded()?(0,h.jsx)(c.u,{title:"Collapse All",children:(0,h.jsx)(x.pzk,{className:"text-base"})}):(0,h.jsx)(c.u,{title:"Expand All",children:(0,h.jsx)(x.mzm,{className:"text-base"})})})},cell:e=>{let{row:t,getValue:n}=e;return(0,h.jsxs)(h.Fragment,{children:[t.getCanExpand()?(0,h.jsx)("button",{onClick:t.getToggleExpandedHandler(),children:t.getIsExpanded()?(0,h.jsx)(c.u,{title:"Collapse",children:(0,h.jsx)(x.pzk,{className:"text-base"})}):(0,h.jsx)(c.u,{title:"Expand",children:(0,h.jsx)(x.mzm,{className:"text-base"})})}):null,n()]})}},{header:"Event Name",accessorKey:"eventName"},{header:"Brk",accessorKey:"break"}];return(n===r.pagesEnum.PROMO||n===r.pagesEnum.FINAL_LOG)&&t.filter((e=>e.promoDuration>0)).length>0&&e.push({header:"Promo",accessorKey:"promoDuration"}),(n===r.pagesEnum.SONG||n===r.pagesEnum.FINAL_LOG)&&t.filter((e=>e.songDuration>0)).length>0&&e.push({header:"Song",accessorKey:"songDuration"}),(n===r.pagesEnum.COMMERCIAL||n===r.pagesEnum.FINAL_LOG)&&t.filter((e=>e.commercialDuration>0)).length>0&&e.push({header:"Comm",accessorKey:"commercialDuration"}),e}catch(e){console.error(e)}}(),T=(0,d.b7)({data:s,columns:D,state:{expanded:b},onExpandedChange:C,getSubRows:e=>e.subRows,getCoreRowModel:(0,m.sC)(),getExpandedRowModel:(0,m.rV)()});(0,a.useEffect)((()=>i(t)),[t]);const w=e=>{try{o.current.scrollToItem(1===e?0:e,"center")}catch(t){console.error(t)}};return(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)(u.Z,{compact:!0,children:[(0,h.jsx)(N,{children:T.getHeaderGroups().map((e=>(0,h.jsx)(p,{children:e.headers.map((e=>(0,h.jsx)(g,{colSpan:e.colSpan,style:{textWrap:"nowrap",border:"1px solid rgb(107 114 128)",textTransform:"capitalize"},className:"bg-gray-600 ".concat("eventName"!==e.column.columnDef.accessorKey&&"text-center"),children:(0,d.ie)(e.column.columnDef.header,e.getContext())},e.id)))},e.id)))}),(0,h.jsx)(E,{children:T.getRowModel().rows.map((e=>(0,h.jsx)(p,{className:e.original.eventName?"bg-gray-600 bg-opacity-20":"hover:cursor-pointer",onClick:()=>!e.original.eventName&&w(e.original.eventIndex),children:e.getVisibleCells().map((t=>(0,h.jsx)(f,{style:{textWrap:"nowrap",border:"1px solid rgb(75 85 99)"},className:"text-gray-200 ".concat("eventName"===t.column.id&&"hover:cursor-pointer"," ").concat("eventName"!==t.column.id&&"text-center"),onClick:()=>"eventName"===t.column.id&&e.original.eventName&&w(e.original.eventIndex),children:(0,d.ie)(t.column.columnDef.cell,t.getContext())},t.id)))},e.id)))})]})})};const C=function(){const{schedulingTableData:e,setActiveFeatures:t,secondaryAreaZindexRef:n}=(0,a.useContext)(l.Z),[u,d]=(0,a.useState)([]);(0,a.useEffect)((()=>{try{d(m())}catch(e){(0,s.openNotification)("danger","Something went wrong while fetching duration information"),console.error(e)}}),[e]);const m=()=>{try{let t=[];for(let n=1;n<e.length;n++){let a=e[n];if(a.F_C_S_P===r.rowDataTypesEnum.CONTENT_TERMINATION){let r=x(n,e);t.push({eventName:a.Event_Name,break:r.length,promoDuration:r.reduce(((e,t)=>e+t.promoDuration),0),songDuration:r.reduce(((e,t)=>e+t.songDuration),0),commercialDuration:r.reduce(((e,t)=>e+t.commercialDuration),0),eventIndex:n,subRows:r})}}return t}catch(t){throw t}},x=(e,t)=>{try{let n=e+1,a=[];for(;t[n]&&t[n].F_C_S_P!==r.rowDataTypesEnum.CONTENT_TERMINATION;){if(n===e+1&&t[n].F_C_S_P!==r.rowDataTypesEnum.SEGMENT){let n=p(e,t);a.push(n)}if(t[n].F_C_S_P===r.rowDataTypesEnum.SEGMENT){let e=p(n,t);a.push(e)}n++}return a}catch(n){throw n}},p=(e,t)=>{try{let n=e+1,a=0,o=0,l=0;for(;t[n]&&t[n].F_C_S_P!==r.rowDataTypesEnum.SEGMENT;)t[n].F_C_S_P===r.rowDataTypesEnum.PROMO?a+=(0,s.timeToSeconds)(t[n].Duration):t[n].F_C_S_P===r.rowDataTypesEnum.SONG?o+=(0,s.timeToSeconds)(t[n].Duration):t[n].F_C_S_P===r.rowDataTypesEnum.COMMERCIAL&&(l+=(0,s.timeToSeconds)(t[n].Duration)),n++;return{eventName:"",break:t[e].BreakNumber,promoDuration:a,songDuration:o,commercialDuration:l,eventIndex:e}}catch(n){throw n}};return(0,h.jsxs)("div",{className:"h-full w-full flex flex-col bg-gray-800 p-3 pt-2 rounded-lg absolute top-0 left-0",style:{zIndex:n.current[r.featuresEnum.DURATION]},children:[(0,h.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,h.jsx)("h5",{children:"Duration"}),(0,h.jsx)("div",{className:"flex gap-1.5",children:(0,h.jsx)(c.u,{title:"Close",children:(0,h.jsx)(c.zx,{size:"xs",icon:(0,h.jsx)(i.QAE,{}),onClick:()=>(0,o.FG)(t,r.featuresEnum.DURATION)})})})]}),(0,h.jsx)("div",{className:"h-[92%] flex flex-col gap-3",children:u.length>0?(0,h.jsx)("div",{className:"grow overflow-auto no-scrollbar",children:(0,h.jsx)(b,{tableData:u})}):(0,h.jsx)(c.Zb,{className:"h-full",bodyClass:"h-full flex justify-center items-center",children:"No duration info to show"})})]})}}}]);
//# sourceMappingURL=7415.7101ef31.chunk.js.map