(self.webpackChunkelstar=self.webpackChunkelstar||[]).push([[2577],{25579:(e,t,a)=>{"use strict";a.d(t,{Ei:()=>g,I6:()=>y,Qj:()=>d,U$:()=>m,Uy:()=>C,Z_:()=>o,_K:()=>p,b6:()=>c,d:()=>l,db:()=>f,fh:()=>h,gg:()=>x,hu:()=>n,iD:()=>i,rd:()=>u,w_:()=>S});a(54048);var s=a(46152),r=a(54748);a(74569);async function n(e){return s.Z.fetchData({url:"/dealmaster/".concat(e),method:"get"})}async function o(e){return s.Z.fetchData({url:"/dealattachment/".concat(e),method:"get"})}async function c(e,t,a){return s.Z.fetchData({url:"/dealmaster/dealforapproval/?DealNumber=".concat(e,"&IsApproved=").concat(t,"&RejectRemark=").concat(a),method:"get"})}async function l(e,t){return s.Z.fetchData({url:"/dealmaster/?LocationCode=".concat(e.LocationCode,"&ChannelCode=").concat(e.ChannelCode,"&StartDate=").concat((0,r.Tk)(t[0]),"&EndDate=").concat((0,r.Tk)(t[1])),method:"get"})}async function d(e){return s.Z.fetchData({url:"/sponsortypemaster/drop/",method:"get",data:e})}async function i(e){return s.Z.fetchData({url:"/spottypemaster/drop/",method:"get",data:e})}async function m(e){return s.Z.fetchData({url:"/dealdetail/".concat(e),method:"get"})}async function u(e){return s.Z.fetchData({url:"/dealmaster/USP_Sch_DealConsumptionCheck/?DealNumber=".concat(e),method:"get"})}async function h(e,t,a,r,n,o){return s.Z.fetchData({url:"/dealmaster/bindstartnendtime/?LocationCode=".concat(n,"&ChannelCode=").concat(o,"&DealPeriodToDate=").concat(e,"&DealPeriodFromDate=").concat(t,"&ContentCode=").concat(a,"&OriginalRepeatCode=").concat(r),method:"get"})}async function p(e,t,a){return s.Z.fetchData({url:"/bookingdetails/bookingchange/?flag=".concat(e,"&IsNtc=").concat(a),method:"put",data:t})}async function x(e,t){var a={params:t};return s.Z.fetchData({url:"/callstoreprocedure/"+e,data:a,method:"post"})}async function g(e){return s.Z.fetchData({url:"/callstoreprocedure/"+e,data:{params:{}},method:"post"})}async function y(e,t,a){var r={params:{Bookingcode:t,IsNTC:a}};return s.Z.fetchData({url:"/callstoreprocedure/"+e,data:r,method:"post"})}async function f(e){var t={params:{CheckMonth:e}};return s.Z.fetchData({url:"/callstoreprocedure/USP_DealDashboardDoughnut",data:t,method:"post"})}async function C(e,t){var a={params:{BookingNumber:t,deallineitemno:0}};return s.Z.fetchData({url:"/callstoreprocedure/"+e,data:a,method:"post"})}async function S(e){return s.Z.fetchData({url:"currencyexchangerate/?basecurrency=".concat(e),method:"post"})}},24043:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>b});var s=a(1413),r=a(72791),n=a(34786),o=a(2803),c=a(96361),l=a(87537),d=a(54652),i=a(81721),m=a(81320),u=a(60488),h=a(58617),p=a(81694),x=a.n(p),g=a(25579),y=a(60364),f=a(47475),C=a(93673),S=a(80184);const v=[{header:"Agency",accessorKey:"AgencyName"},{header:"Client",accessorKey:"ClientName"},{header:"Brand",accessorKey:"BrandName"},{header:"Commercial",accessorKey:"CommercialCaption"},{header:"Duration",accessorKey:"CommercialDuration"},{header:"Content",accessorKey:"ContentName"},{header:"Schedule Date",accessorKey:"BookingScheduleDate"},{header:"Schedule Time",accessorKey:"ScheduleTime"},{header:"Spot Rate",accessorKey:"SpotRate"},{header:"Spot Amount",accessorKey:"SpotAmount"},{header:"Line Item From Date",accessorKey:"LineItemFromDate"},{header:"Line Item End Date",accessorKey:"LineItemEndDate"},{header:"BookingCode",accessorKey:"BookingCode"}],j=[{value:"2",label:"Booked But Not Telecasted"},{value:"1",label:"Booked And Missed"}],b=()=>{const e=window.location.href.split("#")[1],t="SpotMakeGood"===(e?e.split("/")[1]:"")?0:1,a=(0,y.useSelector)((e=>e.locale.selectedChannel)),[p,b]=(0,r.useState)(""),[D,N]=(0,r.useState)([]),[k,Z]=(0,r.useState)([""]),[w,A]=(0,r.useState)([""]),[T,I]=(0,r.useState)({}),[K,R]=(0,r.useState)([]),[B,E]=(0,r.useState)([]),[z,L]=(0,r.useState)([]),[F,M]=(0,r.useState)([]),[P,_]=(0,r.useState)(!1),[V,G]=(0,r.useState)([]),[O,U]=(0,r.useState)({pageIndex:0,pageSize:10}),[Q,$]=(0,r.useState)({}),[q,H]=(0,r.useState)(!0);(0,r.useEffect)((()=>{try{q&&((0,u.Dh)(),(async e=>{const t=(await(0,n.Q8)(void 0)).data.map((e=>({label:e.ClientName,value:e.ClientCode})));Z(t)})(),H(!1))}catch(e){console.error(e)}}),[q]),(0,r.useEffect)((()=>{(async()=>{var e;if(2===(null===T||void 0===T||null===(e=T.datesrange)||void 0===e?void 0:e.length)&&T.datesrange[0]&&T.datesrange[1]&&w.value>0){var s;const e=await(0,n.Z_)(T,D,w.value,"B\xa0R",t,a.LocationCode,a.ChannelCode);(null===e||void 0===e||null===(s=e.data)||void 0===s?void 0:s.length)>0?R(e.data):R([])}})()}),[T.datesrange,w,a]),(0,r.useEffect)((()=>{try{L(J(B)),W(B)}catch(e){console.error(e)}}),[B]);const J=e=>{try{if(!Array.isArray(e))return[];const t=e.reduce(((e,t)=>{if(t){const a="".concat(t.CommercialCaption,"-").concat(t.CommercialDuration);return e[a]||(e[a]={CommercialCaption:t.CommercialCaption,CommercialDuration:t.CommercialDuration,CurrencySymbol:t.CurrencySymbol,SpotAmountSum:0,TotalDuration:0,TotalCount:0}),e[a].SpotAmountSum+=t.SpotAmount,e[a].TotalDuration+=(0,m.parseDuration)(t.CommercialDuration),e[a].TotalCount++,e}}),{});return Object.values(t||0)}catch(t){throw t}},W=e=>{try{const t=e.reduce(((e,t)=>(t&&(e.spotAmountSum+=t.SpotAmount,e.spotRateSum+=t.SpotRate,e.Duration+=(0,m.parseDuration)(t.CommercialDuration)),e)),{spotAmountSum:0,spotRateSum:0,Duration:0});M(t)}catch(t){throw t}},X=()=>{b(""),N([]),Z([""]),A([""]),I({}),R([]),E([]),L([]),M([]),_(!1),G([]),U({pageIndex:0,pageSize:10}),$({}),H(!0)};return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(o.Zb,{header:(0,S.jsx)(c.Z,{}),children:[(0,S.jsx)("div",{className:"mb-5",children:(0,S.jsxs)("div",{className:"grid grid-cols-4 gap-x-5",children:[(0,S.jsxs)("div",{className:"col-span-3",children:[(0,S.jsx)("p",{className:"lbale",children:"Search Client"}),k&&(0,S.jsx)(d.Z,{className:"block",SelectedItem:D,setSelectedItem:N,data:k,placeholder:"Search Client...",setInputValue:b,InputValue:p,ResetData:X})]}),(0,S.jsx)("div",{className:"col-span-1 ",children:0!=(null===D||void 0===D?void 0:D.length)&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("p",{className:"lbale ",children:"Spot Type"}),(0,S.jsx)(o.Ph,{size:"sm",value:j.filter((e=>e.value==(null===w||void 0===w?void 0:w.value))),className:"mb-4",placeholder:"Please Select",options:j,onChange:e=>A(e)})]})}),(0,S.jsx)("div",{className:"col-span-1",children:0!=(null===D||void 0===D?void 0:D.length)&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("p",{className:"lbale",children:"Select Date Range"}),(0,S.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,S.jsx)(l.Z,{placeholder:"Select datesrange",style:{fontSize:"15px",marginRight:"10px"},value:null===T||void 0===T?void 0:T.datesrange,onChange:e=>{I((t=>(0,s.Z)((0,s.Z)({},t),{},{datesrange:e})))}})})]})})]})}),K&&(0,S.jsx)(C.Z,{tableData:K,tableName:"spotMakeGood",originalColumns:v,managedColumns:V,setManagedColumns:G,exportFile:!1,columnsToFormatInINR:[],tableType:f.$.tableTypes.SELECTABLE,setSelectedRows:E,paginationState:O,setPaginationState:U,rowSelection:Q,setRowSelection:$})]}),B.length>0&&(0,S.jsxs)(i.gi,{className:"-mx-8 px-8 flex items-center justify-between py-4 pt-2 pb-2",stickyClass:"border-t bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:[(0,S.jsxs)("div",{className:"md:flex items-center",children:[(0,S.jsx)(o.zx,{onClick:()=>_(!0),variant:"solid",type:"submit",size:"sm",children:"Proceed to Make Good"}),"\xa0",(0,S.jsx)(o.zx,{onClick:()=>X(),type:"button",size:"sm",children:"Discard"})]}),(0,S.jsxs)("div",{id:"myblock",className:"grid grid-cols-4 md:grid-cols-4 lg:grid-cols-4 gap-6 p-4 pt-0 pb-1 \r bg-gray-100 dark:bg-gray-800",children:[(0,S.jsxs)("div",{className:"flex flex-col lbl",children:[(0,S.jsx)("span",{className:"font-medium text-gray-600 dark:text-gray-300 text-sm",children:"Total Spots"}),(0,S.jsx)("span",{className:"font-medium text-lg text-teal-500",children:K.length})]}),(0,S.jsxs)("div",{className:"flex flex-col lbl",children:[(0,S.jsx)("span",{className:"font-medium text-gray-600 dark:text-gray-300 text-sm",children:"Selected Spots"}),(0,S.jsx)("span",{className:"font-medium text-lg text-teal-500",children:B.length})]}),(0,S.jsxs)("div",{className:"flex flex-col lbl",children:[(0,S.jsx)("span",{className:"font-medium text-gray-600 dark:text-gray-300 text-sm",children:"Duration"}),(0,S.jsx)("span",{className:"font-medium text-lg text-teal-500",children:null===F||void 0===F?void 0:F.Duration})]}),(0,S.jsxs)("div",{className:"flex flex-col lbl",children:[(0,S.jsx)("span",{className:"font-medium text-gray-600 dark:text-gray-300 text-sm",children:"Spot Amount"}),(0,S.jsx)("span",{className:"font-medium text-lg text-teal-500",children:null===F||void 0===F?void 0:F.spotAmountSum})]})]})]}),(0,S.jsxs)(o.Vq,{isOpen:P,onClose:()=>_(!1),onRequestClose:()=>_(!1),children:[(0,S.jsx)(o.Zb,{children:z.map(((e,t)=>(0,S.jsx)("div",{children:(0,S.jsx)("div",{children:(0,S.jsxs)("div",{className:x()("flex items-center justify-between rounded-lg p-2 cursor-pointer user-select","bg-gray-50 dark:bg-gray-700/60 hover:bg-gray-100 dark:hover:bg-gray-700/90","mb-3"),children:[(0,S.jsxs)("div",{className:"flex items-center rounded-full font-semibold text-xs",children:[(0,S.jsxs)("div",{className:"flex items-center px-2 py-1 border border-gray-300 rounded-full  mr-2",children:[(0,S.jsx)(h.$Af,{className:"text-base"}),(0,S.jsx)("span",{className:"ml-1 rtl:mr-1 whitespace-nowrap",children:e.TotalCount})]}),"  ",(0,S.jsx)("div",{className:"flex items-center",children:(0,S.jsxs)("div",{className:"text-gray-900 dark:text-gray-300 text-xs",children:[e.CommercialCaption," [",e.CommercialDuration,"]"]})})]}),(0,S.jsx)("div",{className:"text-gray-900 dark:text-gray-300 text-lg",children:(0,S.jsx)(o.Vp,{showCloseButton:!1,children:(0,S.jsxs)("div",{className:"flex items-center text-sm",children:[(0,S.jsx)("span",{className:"mr-1",children:(0,S.jsx)(h.QCV,{})})," ",e.TotalDuration," sec"]})})}),(0,S.jsx)("div",{className:"text-gray-900 dark:text-gray-300 text-lg",children:(0,S.jsx)(o.Vp,{showCloseButton:!1,children:(0,S.jsxs)("span",{className:"text-lg",children:[e.CurrencySymbol," ",e.SpotAmountSum]})})})]})})},t)))}),(0,S.jsxs)("div",{className:"text-right mt-6 ",children:[(0,S.jsx)(o.zx,{variant:"solid",className:"mr-2",onClick:async()=>{const e=B.map((e=>({Id:e.Id,CommercialCode:0,BookingStatus:"",SpotTypeCode:w.value})));try{if(200===(await(0,g._K)("MAKEGOOD",e,t)).status)return _(!1),X(),void(0,m.openNotification)("success","Spot MakeGood Successfully")}catch(a){if(500===a.response.status)return void(0,m.openNotification)("danger","Server Error.")}},children:"Confirm"}),(0,S.jsx)(o.zx,{onClick:()=>_(!1),children:"Close"})]})]})]})}},72950:()=>{},22868:()=>{},14777:()=>{},99830:()=>{},70209:()=>{},87414:()=>{}}]);
//# sourceMappingURL=2577.91796026.chunk.js.map