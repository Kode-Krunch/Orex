(self.webpackChunkelstar=self.webpackChunkelstar||[]).push([[92],{78498:(e,t,a)=>{"use strict";a.d(t,{D:()=>c,Q:()=>n});a(54048);var o=a(46152);a(74569);async function n(e,t){return o.Z.fetchData({url:"/dealmaster/search/?LocationCode=".concat(e.LocationCode,"&ChannelCode=").concat(e.ChannelCode,"&keys=").concat(t),method:"get"})}async function c(e){return o.Z.fetchData({url:"/cancelremarkmaster/",method:"get"})}},28179:(e,t,a)=>{"use strict";a.d(t,{$H:()=>r,$o:()=>b,Bo:()=>j,D_:()=>Z,Eg:()=>D,JN:()=>v,M0:()=>m,ND:()=>i,OY:()=>l,SR:()=>p,Sd:()=>y,U2:()=>N,U3:()=>x,XV:()=>h,fU:()=>T,fy:()=>S,fz:()=>A,g7:()=>B,h:()=>C,iH:()=>s,ih:()=>I,jS:()=>k,kP:()=>d,ko:()=>u,m1:()=>g,mg:()=>w,pc:()=>L,qm:()=>f});var o=a(54048),n=a(46152);a(60630);const c=a(74569);async function r(e){return n.Z.fetchData({url:"/commercialtypemaster/",method:"get",data:e})}async function i(e,t,a){return n.Z.fetchData({url:"/spotcancellation/?CancelRemarkCode=".concat(t,"&IsNTC=").concat(a),method:"put",data:e})}const l=(e,t)=>new Promise(((a,n)=>{let r=JSON.stringify({CommercialTypeName:e.CommercialTypeName,CommercialTypeShortName:e.CommercialTypeShortName,IsActive:e.IsActive?1:0}),i={method:"post",maxBodyLength:1/0,url:o.Z.apiPrefix+"/commercialtypemaster/",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},data:r};c.request(i).then((e=>{a(e)})).catch((e=>{n(e)}))})),s=(e,t)=>new Promise(((a,n)=>{let r=JSON.stringify({CommercialTypeName:e.CommercialTypeName,CommercialTypeShortName:e.CommercialTypeShortName,IsActive:e.IsActive?1:0}),i={method:"put",maxBodyLength:1/0,url:o.Z.apiPrefix+"/commercialtypemaster/".concat(e.CommercialTypeCode),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},data:r};c.request(i).then((e=>{a(e)})).catch((e=>{n(e)}))}));async function d(e){return n.Z.fetchData({url:"/commercialmaster/?LocationCode=".concat(e.LocationCode,"&ChannelCode=").concat(e.ChannelCode,"&IsNTC=").concat(e.IsNTC,"&fromdate=").concat(e.FromDate,"&todate=").concat(e.ToDate),method:"get"})}async function m(e,t){return n.Z.fetchData({url:"/bookingmaster/?IsNTC=".concat(e.IsNTC,"&LocationCode=").concat(e.LocationCode,"&ChannelCode=").concat(e.ChannelCode),method:"get",data:e})}async function h(e,t,a,o,c,r,i,l,s,d,m){return n.Z.fetchData({url:"/spotschedule/USP_SA_RO_SpotSchedule/?From_DT=".concat(e,"&To_DT=").concat(t,"&DealNumber=").concat(a,"&BookingNumber=").concat(o,"&ChannelCode=").concat(r,"&LocationCode=").concat(i,"&ScheduleDate=").concat(c,"&IsMakeGoodRO=").concat(l?1:0,"&BookingRefNumber=").concat(s,"&IsNTC=").concat(d,"&BrandCode=").concat(m),method:"get"})}async function u(e,t,a,o,c,r){return n.Z.fetchData({url:"/commercialmaster/get_Commercial/?LocationCode=".concat(o,"&ChannelCode=").concat(c,"&ClientCode=").concat(t.value,"&BrandCode=").concat(e.value,"&DurInSec=").concat(a.DurInSec,"&IsNTC=").concat(r),method:"get"})}async function C(e,t,a,o,c){return n.Z.fetchData({url:"/commercialmaster/get_Commercial/?LocationCode=".concat(a,"&ChannelCode=").concat(o,"&ClientCode=").concat(t,"&BrandCode=").concat(e,"&IsNTC=").concat(c),method:"get"})}const p=(e,t)=>new Promise(((a,n)=>{let r={method:"post",maxBodyLength:1/0,url:o.Z.apiPrefix+"/commercialmaster/",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},data:e};console.log(r.url),c.request(r).then((e=>{a(e)})).catch((e=>{n(e)}))})),g=(e,t,a)=>new Promise(((n,r)=>{let i={method:"put",maxBodyLength:1/0,url:o.Z.apiPrefix+"/commercialmaster/".concat(a),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},data:e};c.request(i).then((e=>{n(e)})).catch((e=>{r(e)}))}));async function y(e){return n.Z.fetchData({url:"/positionmaster/drop/",method:"get",data:e})}async function f(e){return n.Z.fetchData({url:"/spotpositiontypemaster/drop/",method:"get",data:e})}async function S(e){return n.Z.fetchData({url:"/cancelremarkmaster/",method:"get",data:e})}const v=(e,t)=>fetch(o.Z.apiPrefix+"/cancelremarkmaster",{method:"POST",headers:{Accept:"application/json",Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({CancelRemarkName:e.CancelRemarkName,IsActive:e.IsActive})}),D=(e,t)=>fetch(o.Z.apiPrefix+"/cancelremarkmaster/".concat(e.CancelRemarkCode),{method:"PUT",headers:{Accept:"application/json",Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({CancelRemarkName:e.CancelRemarkName,IsActive:e.IsActive})});async function x(e){return n.Z.fetchData({url:"/yearmaster/",method:"get",data:e})}const T=(e,t)=>fetch(o.Z.apiPrefix+"/yearmaster",{method:"POST",headers:{Accept:"application/json",Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({Description:e.Description,StartDate:e.StartDate,EndDate:e.EndDate,IsActive:e.IsActive})}),j=(e,t)=>fetch(o.Z.apiPrefix+"/yearmaster/".concat(e.Yearcode),{method:"PUT",headers:{Accept:"application/json",Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({Description:e.Description,StartDate:e.StartDate,EndDate:e.EndDate,IsActive:e.IsActive})});async function k(e){return n.Z.fetchData({url:"/taxmaster/",method:"get",data:e})}async function b(e){return n.Z.fetchData({url:"/taxmaster/",method:"post",data:e})}async function N(e,t){return n.Z.fetchData({url:"/taxmaster/".concat(t),method:"put",data:e})}const A=(e,t,a)=>{try{return n.Z.fetchData({method:"get",url:"/trafficdayclose/?LocationCode=".concat(t.LocationCode,"&ChannelCode=").concat(t.ChannelCode,"&traficmonth=").concat(e),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)}})}catch(o){throw new Error(o)}},Z=(e,t,a,o)=>{try{return n.Z.fetchData({method:"get",url:"/trafficdayclose/asperfromto/?LocationCode=".concat(a.LocationCode,"&ChannelCode=").concat(a.ChannelCode,"&fromdate=").concat(e,"&todate=").concat(t),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(o)}})}catch(c){throw new Error(c)}},w=async(e,t,a)=>{try{return new Promise(((n,r)=>{let i={method:"post",maxBodyLength:1/0,url:o.Z.apiPrefix+"/trafficdayclose/?LocationCode=".concat(t.LocationCode,"&ChannelCode=").concat(t.ChannelCode),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},data:e};c.request(i).then((e=>{n(e)})).catch((e=>{r(e)}))}))}catch(n){throw n}},I=(e,t,a)=>{try{return n.Z.fetchData({method:"get",url:"/bookingmaster/getbookingbyclient/?LocationCode=".concat(t.LocationCode,"&ChannelCode=").concat(t.ChannelCode,"&ClientCode=").concat(e),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)}})}catch(o){throw new Error(o)}},B=(e,t)=>{try{return n.Z.fetchData({method:"get",url:"/bookingactivity/get_bookingactivity/?BookingNumber=".concat(e),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}})}catch(a){throw new Error(a)}},L=(e,t,a)=>{try{return console.log(e),n.Z.fetchData({method:"get",url:"/bookingactivity/get_bookingactivitybydate?BookingNumber=".concat(t,"&ChangeType=").concat(e.type,"&ChangeOn=").concat(e.dateTime,"&ChangeBy=").concat(e.executerId),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)}})}catch(o){throw new Error(o)}}},35153:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>S});var o=a(1413),n=a(72791),c=a(34786),r=a(2803),i=a(96361),l=a(87537),s=a(54652),d=a(81721),m=a(81320),h=(a(28179),a(78498)),u=(a(81694),a(60488)),C=(a(93673),a(47475),a(60364)),p=a(54748),g=a(9494),y=a(60848),f=a(80184);const S=()=>{const e=window.location.href.split("#")[1],t=e?e.split("/")[1]:"",a=(0,C.useSelector)((e=>e.locale.selectedChannel)),[S,v]=(0,n.useState)(""),[D,x]=(0,n.useState)([]),[T,j]=(0,n.useState)([]),[k,b]=(0,n.useState)({datesrange:[null,null]}),[N,A]=(0,n.useState)([]),[Z,w]=(0,n.useState)([]),[I,B]=(0,n.useState)([]),[L,P]=(0,n.useState)([]),[z,R]=(0,n.useState)(!1),[_,E]=(0,n.useState)([]),[F,O]=(0,n.useState)({pageIndex:0,pageSize:10}),[U,J]=(0,n.useState)({}),[q,M]=(0,n.useState)(!0),[V,H]=(0,n.useState)([]),[Q,Y]=(0,n.useState)([]),[$,G]=(0,n.useState)(!1);let X="spotscancellation"===t.toLowerCase();(0,n.useEffect)((()=>{try{q&&((0,u.Dh)(),(async e=>{const t=(await(0,c.Q8)(void 0)).data.map((e=>({label:e.ClientName,value:e.ClientCode})));j(t);const a=(await(0,h.D)("")).data.map((e=>({value:e.CancelRemarkCode,label:e.CancelRemarkName})));H(a)})(),M(!1))}catch(e){console.error(e)}}),[q]),(0,n.useEffect)((()=>{try{B(K(Z)),W(Z)}catch(e){console.error(e)}}),[Z]);const K=e=>{try{if(!Array.isArray(e))return[];const t=e.reduce(((e,t)=>{if(t){const a="".concat(t.CommercialCaption,"-").concat(t.CommercialDuration);return e[a]||(e[a]={CommercialCaption:t.CommercialCaption,CommercialDuration:t.CommercialDuration,CurrencySymbol:t.CurrencySymbol,SpotAmountSum:0,TotalDuration:0,TotalCount:0}),e[a].SpotAmountSum+=t.SpotAmount,e[a].TotalDuration+=(0,m.parseDuration)(t.CommercialDuration),e[a].TotalCount++,e}}),{});return Object.values(t||0)}catch(t){throw t}},W=e=>{try{const t=e.reduce(((e,t)=>(t&&(e.spotAmountSum+=t.SpotAmount,e.spotRateSum+=t.SpotRate,e.Duration+=(0,m.parseDuration)(t.CommercialDuration)),e)),{spotAmountSum:0,spotRateSum:0,Duration:0});P(t)}catch(t){throw t}},ee=()=>{try{G(!1),v(""),x([]),j([]),b({datesrange:[null,null]}),A([]),w([]),B([]),P([]),R(!1),E([]),O({pageIndex:0,pageSize:10}),J({}),M(!0),H([]),Y([])}catch(e){console.error(e)}},te=async()=>{if(null!==k&&void 0!==k&&k.datesrange[0]&&null!==k&&void 0!==k&&k.datesrange[1])try{var e;const o=await(0,g.apiCallstoreprocedure)("USP_SA_CheckSchedulingStatus",{Locationcode:a.LocationCode,Channelcode:a.ChannelCode,FromDate:(0,p.Tk)(null===k||void 0===k?void 0:k.datesrange[0]),ToDate:(0,p.Tk)(null===k||void 0===k?void 0:k.datesrange[1])});var t;if(1==(null===(e=o.data[0])||void 0===e?void 0:e.StatusCode))Object.keys(k).length&&null!==k&&void 0!==k&&k.datesrange[0]&&null!==k&&void 0!==k&&k.datesrange[1]&&(async()=>{try{var e;const t=await(0,c.Z_)(k,D,0,"B E R",X,a.LocationCode,a.ChannelCode);(null===t||void 0===t||null===(e=t.data)||void 0===e?void 0:e.length)>0?A(t.data):A([])}catch(t){console.error("Error fetching spot cancellation data:",t)}})();else(0,m.openNotification)("danger",null===(t=o.data[0])||void 0===t?void 0:t.StatusMsg)}catch(o){console.error("Error fetching storage details:",o)}else(0,m.openNotification)("warning","Please Select Date")};return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(r.Zb,{header:(0,f.jsx)(i.Z,{Component:"CPRP Update"}),children:[(0,f.jsx)("div",{children:(0,f.jsxs)("div",{className:"grid grid-cols-6 gap-2",children:[(0,f.jsxs)("div",{className:"col-span-3 ",children:[(0,f.jsx)("p",{className:"lbale ",children:"Search Client"}),T&&(0,f.jsx)(s.Z,{className:"block",SelectedItem:D,setSelectedItem:x,data:T,placeholder:"Search Client...",setInputValue:v,InputValue:S,ResetData:ee})]}),(0,f.jsx)("div",{className:"col-span-2",children:0!=(null===D||void 0===D?void 0:D.length)&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("p",{className:"lbale ",children:"Select Date Range"}),(0,f.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,f.jsx)(l.Z,{placeholder:"Select date range",minDate:new Date,size:"sm",style:{fontSize:"15px",marginRight:"10px"},onChange:e=>{b((t=>(0,o.Z)((0,o.Z)({},t),{},{datesrange:e})))}})})]})}),0!=(null===D||void 0===D?void 0:D.length)&&(0,f.jsxs)("div",{className:"col-span-1 flex items-center justify-around ml-2 mt-5",children:[(0,f.jsx)(r.zx,{size:"sm",variant:"twoTone",onClick:()=>G(!$),children:"Advance Filter"}),!$&&(0,f.jsx)(r.zx,{size:"sm",className:"ml-2 w-32",variant:"solid",onClick:te,children:"Search"})]})]})}),$&&(0,f.jsx)(f.Fragment,{children:(0,f.jsx)(y.Z,{selectedItem:D,formState:k,setFormState:b,fetchCheckScheduling:te})})]}),Z.length>0&&(0,f.jsx)(d.gi,{className:"-mx-8 px-8 flex items-center justify-between py-4 pt-2 pb-2",stickyClass:"border-t bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:(0,f.jsxs)("div",{className:"md:flex items-center",children:[(0,f.jsx)(r.zx,{onClick:()=>R(!0),variant:"solid",type:"submit",size:"sm",children:"Proceed to Cancel"}),"\xa0",(0,f.jsx)(r.zx,{onClick:()=>ee(),type:"button",size:"sm",children:"Discard"})]})})]})}},60848:(e,t,a)=>{"use strict";a.d(t,{Z:()=>m});var o=a(1413),n=a(2803),c=a(54748),r=a(72791),i=a(60364),l=a(9494),s=a(80184);const d=e=>{let{label:t,options:a,onChange:o}=e;return(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"label",children:t}),(0,s.jsx)(n.Ph,{options:a,onChange:e=>o(e.value)})]})},m=e=>{let{selectedItem:t,formState:a,setFormState:m,fetchCheckScheduling:h}=e;const[u,C]=(0,r.useState)([]),[p,g]=(0,r.useState)([]),[y,f]=(0,r.useState)([]),S=(0,i.useSelector)((e=>e.locale.selectedChannel));(0,r.useEffect)((()=>{t&&null!==a&&void 0!==a&&a.datesrange[1]&&v()}),[null===a||void 0===a?void 0:a.datesrange,t]);const v=(0,r.useCallback)((async()=>{try{const e={LocationCode:S.LocationCode,ChannelCode:S.ChannelCode,ClientCode:null===t||void 0===t?void 0:t.value,FromDate:(0,c.Tk)(a.datesrange[0]),ToDate:(0,c.Tk)(a.datesrange[1])},o={LocationCode:S.LocationCode,ChannelCode:S.ChannelCode,ClientCode:null===t||void 0===t?void 0:t.value,AgencyCode:0,FromDate:(0,c.Tk)(a.datesrange[0]),ToDate:(0,c.Tk)(a.datesrange[1])},n={LocationCode:S.LocationCode,ChannelCode:S.ChannelCode,ClientCode:null===t||void 0===t?void 0:t.value,DealNumber:0,FromDate:(0,c.Tk)(a.datesrange[0]),ToDate:(0,c.Tk)(a.datesrange[1])},[r,i,s]=await Promise.all([(0,l.apiCallstoreprocedure)("USP_Fill_AgencyUsing_Client",e),(0,l.apiCallstoreprocedure)("USP_FillDealUsingClient",o),(0,l.apiCallstoreprocedure)("USP_FillBrandUsingClient",n)]);C(D(r.data)),f(D(i.data)),g(D(s.data))}catch(e){console.error("Error fetching data:",e)}}),[S,a.datesrange,t]),D=e=>[{value:0,label:"All"},...(null===e||void 0===e?void 0:e.map((e=>({value:e.ValueMember,label:e.DisplayMember}))))||[]];return(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-2 mb-5",children:[(0,s.jsx)(d,{label:"Select Deal",options:y,onChange:e=>m((t=>(0,o.Z)((0,o.Z)({},t),{},{Deal:e})))}),(0,s.jsx)(d,{label:"Select Agency",options:u,onChange:e=>m((t=>(0,o.Z)((0,o.Z)({},t),{},{Agency:e})))}),(0,s.jsx)(d,{label:"Select Brand",options:p,onChange:e=>m((t=>(0,o.Z)((0,o.Z)({},t),{},{Brand:e})))}),(0,s.jsx)(n.zx,{size:"sm",variant:"solid",className:"ml-2 w-32 mt-6",onClick:h,children:"Search"})]})}},72950:()=>{},22868:()=>{},14777:()=>{},99830:()=>{},70209:()=>{},87414:()=>{}}]);
//# sourceMappingURL=92.d0e9f2b7.chunk.js.map