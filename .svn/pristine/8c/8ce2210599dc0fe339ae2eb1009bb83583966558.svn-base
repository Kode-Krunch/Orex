import React from 'react';
import AutoExecuteFunctionCounter from 'views/Controls/AutoExecuteFunctionCounter/AutoExecuteFunctionCounter';
import FpcConsumption from './FpcConsumption/FpcConsumption';
import Legend from 'views/Controls/Legend';
import { FiHelpCircle } from 'react-icons/fi';
import FpcConsumptionIndicator from './FpcConsumptionIndicator';

function BottomBar({
  primaryTableData,
  FCPSaveDt,
  handleSaveClick,
  priTableSelectedOrgRepRunStatus,
  isFPCAllowedToEdit,
  legends,
}) {
  const consumedMins = primaryTableData.reduce(
    (sum, row) => sum + Number(row.SlotDuration || 0),
    0,
  );

  return (
    <>
      <div className="bg-gray-700 bg-opacity-50 flex justify-between items-center gap-2 py-1.5 px-3 rounded-lg border border-gray-600">
        <div
          className="grow max-h-full min-h-20 flex gap-4"
          style={{ minHeight: '4rem' }}
        >
          <FpcConsumptionIndicator consumedMins={consumedMins} maxMins={1440} />
          <FpcConsumption
            priTableSelectedOrgRepRunStatus={priTableSelectedOrgRepRunStatus}
          />
        </div>
        <div className="flex items-center gap-3">
          <Legend
            legends={legends}
            renderTitle={
              <div className="flex flex-col items-center gap-1 text-gray-300 opacity-90 pr-3 border-r border-r-gray-700">
                <FiHelpCircle className="text-lg" />
                <div>Legends</div>
              </div>
            }
          />
          {isFPCAllowedToEdit && (
            <AutoExecuteFunctionCounter
              width={53}
              strokeWidth={6}
              color="teal-400"
              maxDurationInSec={20}
              dependencies={[FCPSaveDt]}
              executeFunction={handleSaveClick}
            />
          )}
        </div>
      </div>
    </>
  );
}

export default BottomBar;
