import React, { forwardRef, useEffect, useRef, useState } from 'react';
import { Field, Form, Formik } from 'formik';
import * as Yup from 'yup';
import {
  Button,
  Card,
  Checkbox,
  DatePicker,
  Dialog,
  Dropdown,
  FormContainer,
  FormItem,
  Input,
  Select,
  Steps,
  Switcher,
  Table,
  Tooltip,
  Upload,
} from 'components/ui';
import Tabs from 'components/ui/Tabs';
import {
  compareDates,
  formatOnHHMMSSBlur,
  handleChangeWithOutFrame,
  handleChangeWithOutFrameNew,
  isTimeBetween,
} from 'views/Controls/GLOBALFUNACTION';
import { convertDateToYMD, validate } from 'components/validators';
import { Chart, StickyFooter } from 'components/shared';
import { motion } from 'framer-motion';
import { useDispatch, useSelector } from 'react-redux';
import {
  apiGetbindstartnendtime,
  apiGetdealdetailId,
  apiGetsponsortypemasterdrop,
  apiGetspottypemasterdrop,
  apiUSP_Sch_DealConsumptionCheck,
  apiUSP_Sch_DealConsumptionMonthwise,
} from 'services/DealServices';
import {
  apiGetContentmasterDrop,
  apiGetSpotSpotPreferencedrop,
  apiGetfpcorgrepmasterdrop,
  apiGetweekdaysweekendsmaster,
} from 'services/ProgrammingService';
import { apiGetNTCtypedropdown } from 'services/NTCService';
import {
  PostDealMaster,
  PutDealMaster,
  apiGetAgencygetagencyasperclient,
  apiGetDealtypemasterDrop,
  apiGetPayroutemaster,
  apiGetPayroutemasterDrop,
  apiGetTimeBandmaster,
  apiGetTimebandmasterDrop,
  apiGetagencymasterDrop,
  apiGetclientmasterdropmaster,
  apiGetdeallineItemtypemasterDrop,
} from 'services/CreditcontrolService';
import {
  apiGetAgencyCityIDCITY,
  apiGetCurrencymasterdrop,
  apiGetZonemasterDrop,
  apiGetclientcitymasterdropmaster,
  apiGetempmasterdropmaster,
} from 'services/MasterService';
import { DealCard, DealDetailsComponent } from './DealDetailsComponent';
import {
  HiChevronDown,
  HiChevronRight,
  HiOutlineChevronLeft,
  HiOutlineChevronRight,
  HiOutlinePlusCircle,
  HiOutlineX,
  HiPencil,
} from 'react-icons/hi';
import './App.css';
import { setdateForm } from 'store/locale/localeSlice';
import { COLORS } from 'constants/chart.constant';
import DealHeader from './DealHeader';
import Notification from 'components/template/Notification';
import NotificationToast from 'views/Controls/NotificationToast';
import { toast as toa } from 'components/ui';

const { TabNav, TabList, TabContent } = Tabs;

const colourOptions = [
  { value: 'Ocean', label: 'Ocean' },
  { value: 2, label: 'Blue' },
  { value: 3, label: 'Purple' },
  { value: 4, label: 'Red' },
  { value: 5, label: 'Orange' },
  { value: 6, label: 'Yellow' },
  { value: 7, label: 'Green' },
  { value: 8, label: 'Forest' },
  { value: 9, label: 'Slate' },
  { value: 10, label: 'Silver' },
];

const ContentDemo = [{ value: '', label: 'Data Not Found' }];
const DealMasterAddupload = forwardRef(() => {
  const formikRef = useRef();
  const formSubmit = () => {
    formikRef.current?.submitForm();
  };

  const Channel = useSelector((state) => state.locale.selectedChannel);

  const { Content } = useSelector((state) => state.base.common);
  const [datg, setdatg] = useState(null);
  console.log(
    'datgdatgdatgdatgdatgdatgdatgdatgdatgdatgdatgdatgdatgdatgdatg',
    datg,
  );
  const [SponsorType, setSponsorType] = useState([]);
  const [ContentList, setContentList] = useState([]);
  const [SpotType, setSpotType] = useState([]);
  const [NTCType, setNTCType] = useState([]);
  const [DealType, setDealType] = useState([]);
  const [Client, setClient] = useState([]);
  const [ClientCity, setClientCity] = useState([]);
  const [AgencyCity, setAgencyCity] = useState([]);
  const [Currency, setCurrency] = useState([]);
  const [PayRoute, setPayRoute] = useState([]);
  const [Executive, setExecutive] = useState([]);
  const [Weekdays, setWeekdays] = useState([]);
  const [Zone, setZone] = useState([]);
  const [Agency, setAgency] = useState([]);
  const [TimeBand, setTimeBand] = useState([]);
  const [SpotPreference, setSpotPreference] = useState([]);
  const [RODP, setRODP] = useState([]);
  const [formState, setFormState] = useState({});
  const [findId, setfindId] = useState();
  const [DataDisplay, setDataDisplay] = useState([]);
  const [Start, setStart] = useState([]);
  const [End, setEnd] = useState([]);
  const [Menu, setMenu] = useState([]);
  const [chart, setchart] = useState([]);
  const [chart2, setchart2] = useState([]);
  const toast = useRef(null);
  const token = useSelector((state) => state.auth.session.token);

  const openNotification = (message, type, duration) => {
    return toa.push(
      <NotificationToast message={message} type={type} duration={duration} />,
    );
  };
  const [selectedFile, setSelectedFile] = useState(null);
  const maxUpload = 1;

  const beforeUpload = async (files, fileList) => {
    const file = files[0]; // Access the first file from the FileList

    // Access file properties
    const fileName = file.name;
    const filePath = URL.createObjectURL(file); // Creates a URL representing the file object
    const fileSize = file.size;
    const fileType = file.type;

    // Log file information
    console.log('File Name:', fileName);
    console.log('File Path:', filePath);
    console.log('File Size:', fileSize, 'bytes');
    console.log('File Type:', fileType);
    // console.log(files)
    // console.log(fileList)
    const allowedFileType = [
      'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',
    ];
    const invalidFileTypeMessage = 'Please upload an XLSX file!';
    if (fileList.length >= 1) {
      return `You can only upload ${1} file(s)`;
    }
    const selectedFile = files[0];

    if (!allowedFileType.includes(selectedFile.type)) {
      return invalidFileTypeMessage;
    }

    setSelectedFile(selectedFile);
  };

  useEffect(() => {
    (async (values) => {
      console.log(Content.DealNumber);

      const data = await apiUSP_Sch_DealConsumptionCheck(Content.DealNumber);
      const keys = Object.keys(data.data[0]);
      const valuess = Object.values(data.data[0]);
      setchart([keys, valuess]);
      const data2 = await apiUSP_Sch_DealConsumptionMonthwise(
        Content.DealNumber,
      );
      setchart2([keys, valuess]);

      const data1 = await apiGetdealdetailId(Content.DealNumber);
      console.log(data1.data);
      const transformedData = data1.data.map((item, insex) => ({
        name: item.DealLineItemTypeCode,
        EndTime: item.EndTime,
        StartTime: item.StartTime,
        NTCTotalSpots: item.NTCTotalSpots,
        TotalSpots: item.TotalSpots,
        LineItemCancelStatus: item.LineItemCancelStatus,
        TimeBandCode: {
          value: item.TimeBandCode,
          label: item.TimeBandName || 'NA',
        },
        SponsorTypeCode: {
          value: item.SponsorTypeCode,
          label: item.SponsorTypeName || 'NA',
        },
        NTCTypeCode: {
          value: item.NTCTypeCode,
          label: item.NTCTypeName || 'NA',
        },
        ContentCode: {
          value: item.ContentCode,
          label: item.ContentName || 'NA',
        },
        OriginalRepeatCode: {
          value: item.OriginalRepeatCode,
          label: item.OriginalRepeatName || 'NA',
        },
        StartTimeDrop: {
          value: item.StartTime,
          label: item.StartTime || 'NA',
        },
        EndTimeDrop: {
          value: item.EndTime,
          label: item.EndTime || 'NA',
        },
        SpotTypeCode: {
          value: item.SpotTypeCode,
          label: item.SpotTypeName || 'NA',
        },
        NoWeeks: item.NoWeeks,
        WeekDayCode: {
          value: item.WeekdaysCode,
          label: item.WeekdaysName,
        },
        IsNTC: item.IsNTC,
        Rate: item.Rate,
        Second: item.Seconds,
        Amount: item.Amount,
        NetAmount: item.NetAmount,
        InternalRate: item.InternalRate,
        LineItemRemark: item.LineItemRemark,
        DealLineItemNo: item.DealLineItemNo,
        SpotPreferenceCode: item.SpotPreferenceCode,
        DealLineItemType: {
          value: item.DealLineItemTypeCode,
          label: item.DealLineItemTypeName,
        },
      }));
      setDataDisplay(transformedData);
    })();
  }, []);

  console.log(
    'DataDisplayDataDisplayDataDisplayDataDisplayDataDisplay',
    DataDisplay,
  );

  function DealLineAddValidation(LineData, currentTab) {
    console.log('LineData', currentTab, LineData);
    if (!LineData.SpotTypeCode?.value > 0) {
      openNotification('Please Select Spot Type!!', 'danger');
      return false;
    }

    if (LineData?.SpotTypeCode?.value == 1) {
      if (LineData.Rate <= 0 || LineData.Rate == undefined) {
        openNotification('Rate should be greater than 0 !!', 'danger');
        return false;
      }
    }
    if (!LineData?.Second > 0) {
      openNotification('Please enter Seconds!!', 'danger');
      return false;
    }
    if (!LineData.WeekDayCode?.value > 0) {
      openNotification('Please Select WeekDays!!', 'danger');
      return false;
    }

    if (currentTab == 1) {
      //Sponsor
      if (!LineData?.SponsorTypeCode?.value > 0) {
        openNotification('Please Select Sponsor Type!!', 'danger');
        return false;
      }
      if (!LineData.ContentCode?.value > 0) {
        openNotification('Please Select Program!!', 'danger');
        return false;
      }
      if (!LineData.OriginalRepeatCode?.value > 0) {
        openNotification('Please Select Original/Repeat!!', 'danger');
        return false;
      }
      if (!LineData.StartTime > 0) {
        openNotification('Please Select Start Time!!', 'danger');
        return false;
      }
      if (!LineData.EndTime > 0) {
        openNotification('Please Select End Time!!', 'danger');
        return false;
      }

      if (!LineData?.NoWeeks > 0) {
        openNotification('Please Select No of Week!!', 'danger');
        return false;
      }
    }

    if (currentTab == 2) {
      //RODP
      if (LineData?.IsCommited == 1) {
        if (!LineData?.CommitedStartTime || !LineData?.CommitedEndTime) {
          openNotification('Please enter Commited Time !!', 'danger');
          return false;
        }
      }

      if (!LineData.TimeBandCode?.value > 0) {
        openNotification('Please Select TimeBand!!', 'danger');
        return false;
      }

      if (!LineData.Second > 0) {
        openNotification('Please enter Seconds!!', 'danger');
        return false;
      }
      if (LineData?.SpotPreferenceCode <= 0) {
        openNotification('Please select Spot Preference !!', 'danger');
        return false;
      }
    }
    if (currentTab == 3) {
      //Program wise

      if (!LineData.ContentCode?.value > 0) {
        openNotification('Please Select Program!!', 'danger');
        return false;
      }
      if (!LineData.OriginalRepeatCode?.value > 0) {
        openNotification('Please Select Original/Repeat!!', 'danger');
        return false;
      }
      if (!LineData.StartTime > 0) {
        openNotification('Please Select Start Time!!', 'danger');
        return false;
      }
      if (!LineData.EndTime > 0) {
        openNotification('Please Select End Time!!', 'danger');
        return false;
      }

      if (!LineData?.NoWeeks > 0) {
        openNotification('Please Select No of Week!!', 'danger');
        return false;
      }
    }

    if (currentTab == 4) {
      //NTC
      if (!LineData.TimeBandCode?.value > 0) {
        openNotification('Please Select TimeBand!!', 'danger');
        return false;
      }

      if (!LineData.NTCTypeCode?.value > 0) {
        openNotification('Please Select NTC Type!!', 'danger');
        return false;
      }
    }

    if (currentTab == 5) {
      //Slot Wise

      if (!LineData.ContentCode?.value > 0) {
        openNotification('Please Select Program!!', 'danger');
        return false;
      }
      if (!LineData.OriginalRepeatCode?.value > 0) {
        openNotification('Please Select Original/Repeat!!', 'danger');
        return false;
      }
      if (!LineData.StartTime > 0) {
        openNotification('Please Select Start Time!!', 'danger');
        return false;
      }
      if (!LineData.EndTime > 0) {
        openNotification('Please Select End Time!!', 'danger');
        return false;
      }
    }

    if (currentTab == 6) {
      //Slot RODP

      if (!LineData.TimeBandCode?.value > 0) {
        openNotification('Please Select TimeBand!!', 'danger');
        return false;
      }
      if (LineData?.SpotPreferenceCode <= 0) {
        openNotification('Please select Spot Preference !!', 'danger');
        return false;
      }
    }
    return true;
  }

  function calculateValue(inputValue, Second) {
    const units = Number(Second) / 10;
    const result = units * Number(inputValue);
    setFormState((prevFormState) => ({
      ...prevFormState,
      Amount: result,
      NetAmount: result,
    }));
    console.log(result);
    return result;
  }
  function calculateValueX(inputValue, Second) {
    const result = Number(Second) * Number(inputValue);
    setFormState((prevFormState) => ({
      ...prevFormState,
      Amount: result,
      NetAmount: result,
    }));
    console.log(result);
    return result;
  }

  const Bindstartnendtime = async (Prog, Org) => {
    if (Prog && Org) {
      const Start = await apiGetbindstartnendtime(
        datg.DealPeriodToDate,
        datg.DealPeriodFromDate,
        Prog,
        Org,
        Channel.LocationCode,
        Channel.ChannelCode,
      );
      console.log(Start);
      const StartTime = Start.data.TelecastStartTime.map((time) => ({
        value: time,
        label: time, // Assuming you want the key to be a string
      }));
      const StartEnd = Start.data.TelecastEndTime.map((time) => ({
        value: time,
        label: time, // Assuming you want the key to be a string
      }));
      setStart(StartTime);
      setEnd(StartEnd);
    }
  };
  useEffect(() => {
    ClientPlaceCodeGetApi(Content.ClientCode);
    AgencyCityCodeGetApi(Content.AgencyCode);
    Getagencyasperclient(Content.ClientCode);
  }, [Content]);

  const ClientPlaceCodeGetApi = async (ID) => {
    const ClientCity = await apiGetclientcitymasterdropmaster(ID);
    const formattedOptions = ClientCity.data.map((option) => ({
      value: option.Place.PlaceCode,
      label: option.Place.PlaceName,
    }));
    setClientCity(formattedOptions);
  };
  const Getagencyasperclient = async (ID) => {
    const Agency = await apiGetAgencygetagencyasperclient(ID);
    const formattedOptions = Agency.data.map((option) => ({
      value: option.AgencyCode,
      label: option.AgencyName,
      IsCredit: option.IsCredit,
      IsAdvPmt: option.IsAdvPmt,
      IsPDC: option.IsPDC,
      CreditDays: option.CreditDays,
      BusinessTypeCode: option.BusinessType.BusinessTypeCode,
      BusinessTypeName: option.BusinessType.BusinessTypeName,
    }));
    setAgency(formattedOptions);
  };

  const AgencyCityCodeGetApi = async (ID) => {
    const AgencyCity = await apiGetAgencyCityIDCITY(ID);
    const formattedOptions = AgencyCity.data.map((option) => ({
      value: option.Place.PlaceCode,
      label: option.Place.PlaceName,
      Country: option.Country.CountryCode,
      State: option.State.StateCode,
      Place: option.Place.PlaceCode,
      Address1: option.AddressLine1,
      Address2: option.AddressLine2,
      Address2: option.AddressLine2,
      PlaceName: option.Place.PlaceName,
      StateName: option.State.StateName,
      GSTN_id: option.GSTN_id,
    }));
    setAgencyCity(formattedOptions);
  };
  useEffect(() => {
    (async (values) => {
      const Client = await apiGetclientmasterdropmaster(values);
      const formattedOptions = Client.data.map((option) => ({
        value: option.ClientCode,
        label: option.ClientName,
      }));
      setClient(formattedOptions);
    })();
    (async (values) => {
      const Menu = await apiGetdeallineItemtypemasterDrop(values);
      const formattedOptions = Menu.data.map((option) => ({
        value: option.DealLineItemTypeCode,
        label: option.DealLineItemTypeName,
      }));
      setMenu(formattedOptions);
    })();
    (async (values) => {
      const PayRoute = await apiGetPayroutemaster(values);
      const formattedOptions = PayRoute.data.map((option) => ({
        value: option.PayRouteCode,
        label: option.PayRouteName,
        AgencyShare: option.AgencyShare,
      }));
      setPayRoute(formattedOptions);
    })();

    (async (values) => {
      const Currency = await apiGetCurrencymasterdrop(values);
      const formattedOptions = Currency.data.map((option) => ({
        value: option.CurrencyCode,
        label: option.CurrencyName,
      }));
      setCurrency(formattedOptions);
    })();

    (async (values) => {
      const DealType = await apiGetDealtypemasterDrop(values);
      const formattedOptions = DealType.data.map((option) => ({
        value: option.DealTypeCode,
        label: option.DealTypeName,
      }));
      setDealType(formattedOptions);
    })();

    (async (values) => {
      const Zone = await apiGetZonemasterDrop(values);
      const formattedOptions = Zone.data.map((option) => ({
        value: option.ZoneCode,
        label: option.ZoneName,
      }));
      setZone(formattedOptions);
    })();

    (async (values) => {
      const Executive = await apiGetempmasterdropmaster(values);
      const formattedOptions = Executive.data.map((option) => ({
        value: option.EmployeeCode,
        label: option.Emp_FirstName,
      }));
      setExecutive(formattedOptions);
    })();

    (async (values) => {
      const SponsorTyp = await apiGetsponsortypemasterdrop(values);
      const formattedOptions = SponsorTyp.data.map((option) => ({
        value: option.SponsorTypeCode,
        label: option.SponsorTypeName,
      }));
      setSponsorType(formattedOptions);
    })();
    (async (values) => {
      const Content = await apiGetContentmasterDrop(
        undefined,
        Channel.LocationCode,
        Channel.ChannelCode,
        0,
      );
      const formattedOptions = Content.data.map((option) => ({
        value: option.ContentCode,
        label: option.ContentName,
      }));
      setContentList(formattedOptions);
    })();
    (async (values) => {
      const SpotType = await apiGetspottypemasterdrop(values);
      const formattedOptions = SpotType.data.map((option) => ({
        value: option.SpotTypeCode,
        label: option.SpotTypeName,
      }));
      setSpotType(formattedOptions);
    })();
    (async (values) => {
      const NTCType = await apiGetNTCtypedropdown(values);
      const formattedOptions = NTCType.data.map((option) => ({
        value: option.NTCTypeCode,
        label: option.NTCTypeName,
      }));
      setNTCType(formattedOptions);
    })();
    (async (values) => {
      const Weekdays = await apiGetweekdaysweekendsmaster(values);
      const formattedOptions = Weekdays.data.map((option) => ({
        value: option.WeekdaysCode,
        label: option.WeekdaysName,
      }));
      setWeekdays(formattedOptions);
    })();
    (async (values) => {
      const TimeBand = await apiGetfpcorgrepmasterdrop(values);
      const formattedOptions = TimeBand.data.map((option) => ({
        value: option.OriginalRepeatCode,
        label: option.OriginalRepeatName,
      }));
      setTimeBand(formattedOptions);
    })();
    (async (values) => {
      const SpotSpotPreference = await apiGetSpotSpotPreferencedrop(values);
      const formattedOptions = SpotSpotPreference.data.map((option) => ({
        value: option.SpotPreferenceCode,
        label: option.SpotPreferenceName,
      }));
      setSpotPreference(formattedOptions);
    })();

    (async (values) => {
      const TimeBand = await apiGetTimeBandmaster(values);
      const formattedOptions = TimeBand.data.map((option) => ({
        value: option.TimeBandCode,
        StartTime: option.StartTime,
        EndTime: option.EndTime,
        label: option.TimeBandName,
      }));
      setRODP(formattedOptions);
    })();
  }, []);

  console.log(formState);
  console.log(DataDisplay);
  const handleInputChange = (value, name) => {
    setFormState((prevFormState) => ({
      ...prevFormState,
      [name]: value,
    }));
  };
  const handleBlur = (event) => {
    const { name, value } = event.target;
    const formattedValue = formatOnHHMMSSBlur(value);

    if (name == 'CommitedStartTime' || name == 'CommitedEndTime') {
      if (
        isTimeBetween(formattedValue, formState.StartTime, formState.EndTime)
      ) {
        setFormState((prevFormState) => ({
          ...prevFormState,
          [name]: formattedValue,
        }));
      } else {
        openNotification('Please enter correct Commited Time', 'danger');
        setFormState((prevFormState) => ({
          ...prevFormState,
          [name]: '',
        }));
      }
    } else {
      setFormState((prevFormState) => ({
        ...prevFormState,
        [name]: formattedValue,
      }));
    }
  };

  const handleSwitchChange = (value, name) => {
    setFormState((prevFormState) => ({
      ...prevFormState,
      [name]: value ? 1 : 0,
    }));
  };
  const handleSelectChange = (value, name) => {
    console.log('handleSelectChange');
    console.log(name, 'handleSelectChange');
    if (name == 'TimeBandCode') {
      setFormState((prevFormState) => ({
        ...prevFormState,
        EndTime: value.EndTime,
        StartTime: value.StartTime,
        TimeBandCode: value,
      }));
      return;
    }
    //console.log(value, '_valuename')

    if (name == 'SpotTypeCode' && value.value === 2) {
      setFormState((prevFormState) => ({
        ...prevFormState,
        Rate: 0,
        Amount: 0,
        SpotTypeCode: value,
      }));
      return;
    }

    setFormState((prevFormState) => ({
      ...prevFormState,
      [name]: value,
    }));
  };

  const validationSchema = Yup.object().shape({
    // DepartmentCode: Yup.string().required('Department Required'),
    PayRouteCode1: Yup.string().required('PayRouteCode Required'),
    AgencyPlaceCode1: Yup.string().required('AgencyPlaceCodeRequired'),
    CurrencyCode1: Yup.string().required('CurrencyCode Required'),
    DealTypeCode1: Yup.string().required('DealTypeCode Required'),
    AgencyCode1: Yup.string().required('AgencyCode Required'),
    ZoneCode1: Yup.string().required('ZoneCode Required'),
    SalesExcutiveCode1: Yup.string().required('SalesExcutiveCode Required'),
    ClientCode1: Yup.string().required('ClientCode Required'),
    ClientPlaceCode1: Yup.string().required('Client Place Required'),
    DealPeriodFromDate: Yup.string().nullable().required('From Date Required'),
    DealPeriodToDate: Yup.string().nullable().required('To Date Required'),
    DealCreatedDate: Yup.string().nullable().required('Deal Date Required'),
    DealReferenceNumber: Yup.string()
      .min(1, 'Too Short!')
      .max(15, 'Too Long!')
      .required('DealReferenceNumber Required'),
    // <br/>IsActive: Yup.string().required('<br/>IsActives Required'),
  });
  const [dateVdaid, setdateVdaid] = useState(true);
  const [displayInfo, setdisplayInfo] = useState(true);
  const [currentTab, setCurrentTab] = useState(0);
  console.log(currentTab);
  const compareDatesV = (form) => {
    if (!dateVdaid) {
      form.setFieldValue('DealPeriodFromDate', null);
      form.setFieldValue('DealPeriodToDate', null);
      setdateVdaid(true);
    }
  };

  const [step, setStep] = useState(0);
  const onChange = (nextStep) => {
    if (nextStep < 0) {
      setStep(0);
    } else if (nextStep > 3) {
      setStep(3);
    } else {
      setStep(nextStep);
    }
  };
  const onNext = () => {
    formSubmit();
  };

  const onFinalSave = async () => {
    const res = DealDetailsComponentAdd(datg, DataDisplay, currentTab);
    console.log('res', res);

    if (res.Deal && parseInt(res.Deal.DealNumber) > 0) {
      const resp = await PutDealMaster(res, token);
      console.log('resp1', resp);
      if (resp.status === 200) {
        openNotification('Deal Update Successfully.', 'success', 5000);
      }
    } else {
      const resp = await PostDealMaster(res, token);
      console.log('resp1', resp);
      if (resp.status === 200) {
        openNotification(
          'Deal Added Successfully.\n' + resp.data.DealCode,
          'success',
          5000,
        );
      }
    }
  };

  const onStepChange = (index) => {
    setStep(index);
  };

  const onDialogClose = (e) => {
    setFormState({});
    setCurrentTab(0);
  };
  const [collapse, setCollapse] = useState(false);

  const [Hover, setHover] = useState(false);

  const onCollapse = () => {
    setCollapse(!collapse);
  };

  let totalSeconds = 0;
  let totalAmount = 0;
  DataDisplay.forEach((item) => {
    totalSeconds += item.Second || 0;
    totalAmount += item.Amount || 0;
  });

  const handleHover = () => {
    setHover(!Hover);
  };
  const onPrevious = () => {
    onChange(step - 1);
    handleHover();
  };
  const dispatch = useDispatch();
  useEffect(() => {
    dispatch(setdateForm(['value', 'Deal Master']));
    const gboxElement2 = document.getElementsByClassName('Gbox2')[0];
    if (gboxElement2) {
      gboxElement2.style.display = 'block';
    } // Optionally, you might want to revert the change when the component unmounts
    return () => {
      if (gboxElement2) {
        gboxElement2.style.display = 'none';
      }
    };
  }, []);
  console.log(Content);
  if (!datg) {
    console.log('ll');
  }
  return (
    <>
      <Card>
        <div className="mb-2">
          <Steps current={step} onChange={(index) => onStepChange(index)}>
            <Steps.Item title="Make Deal" />
            <Steps.Item title="Deal Details" />
            <Steps.Item title="Attachments" />
            <Steps.Item title="Approved" />
          </Steps>
        </div>

        {(() => {
          switch (step) {
            case 0:
              return (
                <div
                  className=" bg-gray-50 dark:bg-gray-700 rounded mt-5"
                  style={{ height: 'auto', padding: 10 }}
                >
                  <Formik
                    innerRef={formikRef}
                    initialValues={
                      !datg
                        ? {
                          LocationCode:
                            Content.LocationCode || Channel.LocationCode,
                          ChannelCode:
                            Content.ChannelCode || Channel.ChannelCode,
                          DealReferenceNumber:
                            Content.DealReferenceNumber || '',
                          PayRouteCode:
                            {
                              value: Number(Content.PayRouteCode),
                              label: Content.PayRouteName,
                            } || '',
                          PayRouteCode1: Content.PayRouteCode || '',
                          DealTypeCode:
                            {
                              value: Number(Content.DealTypeCode),
                              label: Content.DealTypeName,
                            } || '',
                          DealTypeCode1: Number(Content.DealTypeCode) || '',
                          CurrencyCode:
                            {
                              value: Number(Content.CurrencyCode),
                              label: Content.CurrencyName,
                            } || '',
                          CurrencyCode1: Content.CurrencyCode || '',
                          ZoneCode:
                            {
                              value: Number(Content.ZoneCode),
                              label: Content.ZoneName,
                            } || '',
                          ZoneCode1: Content.ZoneCode || '',
                          SalesExcutiveCode:
                            {
                              value: Number(Content.SalesExcutiveCode),
                              label: Content.Emp_FirstName,
                            } || '',
                          SalesExcutiveCode1:
                            Number(Content.SalesExcutiveCode) || '',
                          ClientCode:
                            {
                              value: Number(Content.ClientCode),
                              label: Content.ClientName,
                            } || '',
                          ClientCode1: Content.ClientCode || '',
                          ClientPlaceCode:
                            {
                              value: Number(Content.ClientPlaceCode),
                              label: Content.ClientPlaceName,
                            } || '',
                          ClientPlaceCode1:
                            Number(Content.ClientPlaceCode) || '',
                          AgencyCode:
                            {
                              value: Number(Content.AgencyCode),
                              label: Content.AgencyName,
                              IsCredit: Content.IsCredit,
                              CreditDays: Content.CreditDays,
                              IsAdvPmt: Content.IsAdvPmt,
                              IsPDC: Content.IsPDC,
                              BusinessTypeName: Content.BusinessTypeName,
                              BusinessTypeCode: Content.BusinessTypeCode,
                            } || '',
                          AgencyCode1: Content.AgencyCode || '',
                          AgencyPlaceCode:
                            {
                              value: Number(Content.AgencyPlaceCode),
                              label: Content.AgencyPlaceName,
                              Address1: Content.Address1,
                              Address2: Content.Address2,
                              GSTN_id: Content.GSTN_id,
                            } || '',
                          AgencyPlaceCode1:
                            Number(Content.AgencyPlaceCode) || '',
                          DealPeriodFromDate:
                            Content.DealPeriodFromDate || null,
                          DealPeriodToDate: Content.DealPeriodToDate || null,
                          DealCreatedDate: Content.DealCreatedDate || null,
                          IsWebDeal: Content.IsWebDeal || 1,
                          DealNumber: Content.DealNumber || '',
                          IPAddress: Content.IPAddress || '',
                        }
                        : datg
                    }
                    validationSchema={validationSchema}
                    onSubmit={(values, { resetForm, setSubmitting }) => {
                      // setTimeout(() => {
                      setdatg(values);
                      onChange(step + 1);
                      console.log(values);
                      setSubmitting(true);
                      // setdisplayInfo(false)
                      //     resetForm()
                      // }, 400)
                    }}
                  >
                    {({ values, touched, errors }) => (
                      <Form>
                        <FormContainer>
                          <div className="grid grid-cols-3 gap-3">
                            <div
                              className="col-span-2"
                              style={{
                                backgroundColor:
                                  'rgb(31 41 55/var(--tw-bg-opacity))',
                                padding: '10px',
                                borderWidth: '1px',
                                borderColor:
                                  'rgb(75 85 99/var(--tw-border-opacity))',
                                borderRadius: '.5rem',
                              }}
                            >
                              <div className="grid grid-cols-4 gap-3  mt-2">
                                <FormItem
                                  asterisk
                                  label="Deal Type"
                                  invalid={
                                    errors.DealTypeCode1 &&
                                    touched.DealTypeCode1
                                  }
                                  errorMessage={errors.DealTypeCode1}
                                >
                                  <Field name="DealTypeCode1">
                                    {({ field, form }) => (
                                      <Select
                                        field={field}
                                        form={form}
                                        options={DealType}
                                        value={DealType.filter(
                                          (option) =>
                                            option.value ==
                                            values.DealTypeCode1,
                                        )}
                                        onChange={(option) => {
                                          form.setFieldValue(
                                            field.name,
                                            option?.value,
                                          );
                                          console.log(option?.value);
                                          form.setFieldValue(
                                            'DealTypeCode',
                                            option,
                                          );
                                        }}
                                      />
                                    )}
                                  </Field>
                                </FormItem>
                                <FormItem
                                  asterisk
                                  label="Ref No"
                                  invalid={
                                    errors.DealReferenceNumber &&
                                    touched.DealReferenceNumber
                                  }
                                  errorMessage={errors.DealReferenceNumber}
                                >
                                  <Field name="DealReferenceNumber">
                                    {({ field, form }) => (
                                      <Input
                                        type="text"
                                        placeholder="Ref No"
                                        maxLength="20"
                                        size="sm"
                                        value={values.DealReferenceNumber}
                                        name="DealReferenceNumber"
                                        onChange={(e) => {
                                          const newValue = e.target.value;


                                          form.setFieldValue(field.name, newValue);

                                          setFormState((prevFormState) => ({
                                            ...prevFormState,
                                            BookingRefNumber: newValue,
                                          }));
                                        }}
                                      />
                                    )}
                                  </Field>

                                </FormItem>

                                <FormItem
                                  asterisk
                                  label="Executive"
                                  invalid={
                                    errors.SalesExcutiveCode1 &&
                                    touched.SalesExcutiveCode1
                                  }
                                  errorMessage={errors.SalesExcutiveCode1}
                                >
                                  <Field name="SalesExcutiveCode1">
                                    {({ field, form }) => (
                                      <Select
                                        field={field}
                                        form={form}
                                        options={Executive}
                                        value={Executive.filter(
                                          (option) =>
                                            option.value ===
                                            values.SalesExcutiveCode1,
                                        )}
                                        onChange={(option) => {
                                          form.setFieldValue(
                                            'SalesExcutiveCode',
                                            option,
                                          );
                                          form.setFieldValue(
                                            field.name,
                                            option?.value,
                                          );
                                        }}
                                      />
                                    )}
                                  </Field>
                                </FormItem>
                                <FormItem
                                  asterisk
                                  label="Zone"
                                  invalid={
                                    errors.ZoneCode1 && touched.ZoneCode1
                                  }
                                  errorMessage={errors.ZoneCode1}
                                >
                                  <Field name="ZoneCode1">
                                    {({ field, form }) => (
                                      <Select
                                        field={field}
                                        form={form}
                                        options={Zone}
                                        value={Zone.filter(
                                          (option) =>
                                            option.value == values.ZoneCode1,
                                        )}
                                        onChange={(option) => {
                                          form.setFieldValue(
                                            'ZoneCode',
                                            option,
                                          );
                                          form.setFieldValue(
                                            field.name,
                                            option?.value,
                                          );
                                        }}
                                      />
                                    )}
                                  </Field>
                                </FormItem>
                              </div>
                              <div className="grid grid-cols-4 gap-3 mt-2">
                                <div className="col-span-3 ">
                                  <FormItem
                                    asterisk
                                    label="Client"
                                    invalid={
                                      errors.ClientCode1 && touched.ClientCode1
                                    }
                                    errorMessage={errors.ClientCode1}
                                  >
                                    <Field name="ClientCode1">
                                      {({ field, form }) => (
                                        <Select
                                          field={field}
                                          form={form}
                                          options={Client}
                                          value={Client.filter(
                                            (option) =>
                                              option.value ==
                                              values.ClientCode1,
                                          )}
                                          onChange={(option) => {
                                            form.setFieldValue(
                                              'ClientCode',
                                              option,
                                            );
                                            form.setFieldValue(
                                              field.name,
                                              option?.value,
                                            );
                                            ClientPlaceCodeGetApi(option.value);
                                            Getagencyasperclient(option.value);
                                          }}
                                        />
                                      )}
                                    </Field>
                                  </FormItem>
                                </div>
                                <FormItem
                                  asterisk
                                  label="Client City"
                                  invalid={
                                    errors.ClientPlaceCode1 &&
                                    touched.ClientPlaceCode1
                                  }
                                  errorMessage={errors.ClientPlaceCode1}
                                >
                                  <Field name="ClientPlaceCode1">
                                    {({ field, form }) => (
                                      <Select
                                        field={field}
                                        form={form}
                                        options={ClientCity}
                                        value={ClientCity.filter(
                                          (option) =>
                                            option.value ==
                                            values.ClientPlaceCode1,
                                        )}
                                        onChange={(option) => {
                                          form.setFieldValue(
                                            field.name,
                                            option?.value,
                                          );
                                          form.setFieldValue(
                                            'ClientPlaceCode',
                                            option,
                                          );
                                        }}
                                      />
                                    )}
                                  </Field>
                                </FormItem>
                                <div className="col-span-3 mt-2">
                                  <FormItem
                                    asterisk
                                    label="Agency"
                                    invalid={
                                      errors.AgencyCode1 && touched.AgencyCode1
                                    }
                                    errorMessage={errors.AgencyCode1}
                                  >
                                    <Field name="AgencyCode1">
                                      {({ field, form }) => (
                                        <Select
                                          field={field}
                                          form={form}
                                          options={Agency}
                                          value={Agency.filter(
                                            (option) =>
                                              option.value ==
                                              values.AgencyCode1,
                                          )}
                                          onChange={(option) => {
                                            form.setFieldValue(
                                              'AgencyCode',
                                              option,
                                            );
                                            form.setFieldValue(
                                              'BusinessTypeCode',
                                              option.BusinessTypeCode,
                                            );

                                            form.setFieldValue(
                                              field.name,
                                              option?.value,
                                            );
                                            AgencyCityCodeGetApi(option.value);
                                          }}
                                        />
                                      )}
                                    </Field>
                                  </FormItem>
                                </div>
                                <FormItem
                                  asterisk
                                  label="Agency City"
                                  className=" mt-2"
                                  invalid={
                                    errors.AgencyPlaceCode1 &&
                                    touched.AgencyPlaceCode1
                                  }
                                  errorMessage={errors.AgencyPlaceCode1}
                                >
                                  <Field name="AgencyPlaceCode1">
                                    {({ field, form }) => (
                                      // <><Tooltip title={<h1>Akkaksa AkkaksaAkka ksaAkkak saAkkaksaAkkaksaAk kaksaAkkaksaA kkaksaAkkaksa</h1>}>
                                      <Select
                                        field={field}
                                        form={form}
                                        options={AgencyCity}
                                        value={AgencyCity.filter(
                                          (option) =>
                                            option.value ==
                                            values.AgencyPlaceCode1,
                                        )}
                                        onChange={(option) => {
                                          form.setFieldValue(
                                            'AgencyPlaceCode',
                                            option,
                                          );
                                          form.setFieldValue(
                                            field.name,
                                            option?.value,
                                          );
                                        }}
                                      />
                                      // </Tooltip></>
                                    )}
                                  </Field>
                                </FormItem>
                              </div>
                              <div className="grid grid-cols-4 gap-3 mt-2">
                                <div className="col-span-2">
                                  <FormItem
                                    asterisk
                                    label="Pay Route"
                                    invalid={
                                      errors.PayRouteCode1 &&
                                      touched.PayRouteCode1
                                    }
                                    errorMessage={errors.PayRouteCode1}
                                  >
                                    <Field name="PayRouteCode1">
                                      {({ field, form }) => (
                                        <Select
                                          field={field}
                                          form={form}
                                          options={PayRoute}
                                          value={PayRoute.filter(
                                            (option) =>
                                              option.value ==
                                              values.PayRouteCode1,
                                          )}
                                          onChange={(option) => {
                                            form.setFieldValue(
                                              'PayRouteCode',
                                              option,
                                            );
                                            form.setFieldValue(
                                              field.name,
                                              option?.value,
                                            );
                                          }}
                                        />
                                      )}
                                    </Field>
                                  </FormItem>
                                </div>
                                <FormItem
                                  asterisk
                                  label="Currency"
                                  invalid={
                                    errors.CurrencyCode1 &&
                                    touched.CurrencyCode1
                                  }
                                  errorMessage={errors.CurrencyCode1}
                                >
                                  <Field name="CurrencyCode1">
                                    {({ field, form }) => (
                                      <Select
                                        field={field}
                                        form={form}
                                        options={Currency}
                                        value={Currency.filter(
                                          (option) =>
                                            option.value ==
                                            values.CurrencyCode1,
                                        )}
                                        onChange={(option) => {
                                          form.setFieldValue(
                                            'CurrencyCode',
                                            option,
                                          );
                                          form.setFieldValue(
                                            field.name,
                                            option?.value,
                                          );
                                        }}
                                      />
                                    )}
                                  </Field>
                                </FormItem>
                              </div>
                            </div>
                            <div
                              style={{
                                backgroundColor:
                                  'rgb(31 41 55/var(--tw-bg-opacity))',
                                padding: '10px',
                                borderWidth: '1px',
                                borderColor:
                                  'rgb(75 85 99/var(--tw-border-opacity))',
                                borderRadius: '.5rem',
                              }}
                            >
                              <div className="grid grid-cols-2 gap-2">
                                <FormItem
                                  asterisk
                                  label="Deal Date"
                                  invalid={
                                    errors.DealCreatedDate &&
                                    touched.DealCreatedDate
                                  }
                                  errorMessage={errors.DealCreatedDate}
                                >
                                  <Field name="DealCreatedDate">
                                    {({ field, form }) => (
                                      <DatePicker
                                        size="sm"
                                        value={
                                          validate(values.DealCreatedDate)
                                            ? new Date(values.DealCreatedDate)
                                            : values.DealCreatedDate == null
                                              ? null
                                              : null
                                        }
                                        onChange={(e) => {
                                          form.setFieldValue(
                                            field.name,
                                            convertDateToYMD(e),
                                          );
                                        }}
                                      />
                                    )}
                                  </Field>
                                </FormItem>
                              </div>

                              <div className="grid grid-cols-2 gap-2">
                                <FormItem
                                  asterisk
                                  label="From Date"
                                  className="mt-2"
                                  invalid={
                                    errors.DealPeriodFromDate &&
                                    touched.DealPeriodFromDate
                                  }
                                  errorMessage={errors.DealPeriodFromDate}
                                >
                                  <Field name="DealPeriodFromDate">
                                    {({ field, form }) => (
                                      <DatePicker
                                        size="sm"
                                        // minDate={minDate}
                                        // maxDate={maxDate}
                                        value={
                                          validate(values.DealPeriodFromDate)
                                            ? new Date(
                                              values.DealPeriodFromDate,
                                            )
                                            : values.DealPeriodFromDate == null
                                              ? null
                                              : null
                                        }
                                        onChange={(e) => {
                                          form.setFieldValue(
                                            field.name,
                                            convertDateToYMD(e),
                                          );
                                          if (values.DealPeriodToDate != null) {
                                            const res = compareDates(
                                              e,
                                              values.DealPeriodToDate,
                                            );
                                            setdateVdaid(res);
                                          }
                                        }}
                                        onBlur={(e) => compareDatesV(form)}
                                      />
                                    )}
                                  </Field>
                                </FormItem>
                                <FormItem
                                  asterisk
                                  className="mt-2"
                                  label="To Date"
                                  invalid={
                                    errors.DealPeriodToDate &&
                                    touched.DealPeriodToDate
                                  }
                                  errorMessage={errors.DealPeriodToDate}
                                >
                                  <Field name="DealPeriodToDate">
                                    {({ field, form }) => (
                                      <DatePicker
                                        size="sm"
                                        // minDate={minDate}
                                        // maxDate={maxDate}
                                        value={
                                          validate(values.DealPeriodToDate)
                                            ? new Date(values.DealPeriodToDate)
                                            : values.DealPeriodToDate == null
                                              ? null
                                              : null
                                        }
                                        onChange={(e) => {
                                          form.setFieldValue(
                                            field.name,
                                            convertDateToYMD(e),
                                          );
                                          if (
                                            values.DealPeriodFromDate != null
                                          ) {
                                            const res = compareDates(
                                              values.DealPeriodFromDate,
                                              e,
                                            );
                                            setdateVdaid(res);
                                          }
                                        }}
                                        onBlur={(e) => compareDatesV(form)}
                                      />
                                    )}
                                  </Field>
                                </FormItem>
                              </div>

                              <div
                                className="mt-2"
                                style={{
                                  backgroundColor:
                                    'rgb(31 41 55/var(--tw-bg-opacity))',
                                  padding: '10px',
                                  borderWidth: '1px',
                                  borderColor:
                                    'rgb(75 85 99/var(--tw-border-opacity))',
                                  borderRadius: '.5rem',
                                }}
                              >
                                <p style={{ color: '#54E4CB' }}>
                                  {' '}
                                  Payment Terms:-{' '}
                                  {values.AgencyCode?.IsCredit != 0 &&
                                    values.AgencyCode?.IsCredit
                                    ? `${values.AgencyCode?.CreditDays} Days Credit Period `
                                    : Content.CreditDays}{' '}
                                  Days Credit Period
                                  {values.AgencyCode?.IsAdvPmt != 0 &&
                                    values.AgencyCode?.IsAdvPmt
                                    ? `Advance Payment`
                                    : null}
                                  {values.AgencyCode?.IsPDC != 0 &&
                                    values.AgencyCode?.IsPDC
                                    ? `PDC`
                                    : null}
                                </p>
                                <p style={{ color: '#54E4CB' }}>
                                  {' '}
                                  Address:- {
                                    values.AgencyPlaceCode?.Address1
                                  }{' '}
                                  {values.AgencyPlaceCode?.Address2}
                                </p>
                                <p style={{ color: '#54E4CB' }}>
                                  {' '}
                                  Business Type:-{' '}
                                  {values.AgencyCode?.BusinessTypeName}
                                </p>
                                <p style={{ color: '#54E4CB' }}>
                                  {' '}
                                  {values.AgencyPlaceCode?.GSTN_id}
                                </p>
                              </div>
                            </div>
                          </div>
                        </FormContainer>
                      </Form>
                    )}
                  </Formik>
                </div>
              );
            case 1:
              return (
                <div>
                  <DealHeader
                    datg={datg}
                    onPrevious={onPrevious}
                    onCollapse={onCollapse}
                    onDialogClose={onDialogClose}
                    collapse={collapse}
                    setCurrentTab={setCurrentTab}
                  />

                  <div className="mt-2">
                    <Tabs
                      value={currentTab}
                      variant="pill"
                      onChange={(val) => {
                        setCurrentTab(val);
                        setFormState({});
                      }}
                    >
                      <div className="flex justify-between">
                        <div>
                          {currentTab != 0 && (
                            <TabList>
                              {Menu.map((item, key) => (
                                <TabNav value={item.value} key={key}>
                                  {item.label}
                                </TabNav>
                              ))}
                            </TabList>
                          )}
                        </div>
                      </div>
                      <div className="p-2">
                        {/* Sponsorwise */}
                        <TabContent value={1}>
                          <div
                            style={{
                              backgroundColor:
                                'rgb(31 41 55/var(--tw-bg-opacity))',
                              padding: '10px',
                              borderWidth: '1px',
                              borderColor:
                                'rgb(75 85 99/var(--tw-border-opacity))',

                              borderRadius: '.5rem',
                            }}
                          >
                            <div className="grid grid-cols-3 gap-1">
                              <div
                                className="col-span-2"
                                style={{
                                  backgroundColor:
                                    'rgb(31 41 55/var(--tw-bg-opacity))',
                                  padding: '10px',

                                  borderRadius: '.5rem',
                                }}
                              >
                                <FormContainer>
                                  <div className="grid grid-cols-2 gap-2">
                                    <FormItem asterisk label="Sponsor Type">
                                      <Select
                                        options={SponsorType}
                                        onChange={(e) =>
                                          handleSelectChange(
                                            e,
                                            'SponsorTypeCode',
                                          )
                                        }
                                        value={
                                          SponsorType !== null
                                            ? SponsorType.filter(
                                              (option) =>
                                                option.value ==
                                                formState.SponsorTypeCode
                                                  ?.value,
                                            )
                                            : ContentDemo.filter(
                                              (option) => option,
                                            )
                                        }
                                      />
                                    </FormItem>
                                    <FormItem asterisk label="Content">
                                      <Select
                                        options={ContentList}
                                        onChange={(e) => {
                                          handleSelectChange(e, 'ContentCode');

                                          if (
                                            formState.OriginalRepeatCode?.value
                                          ) {
                                            Bindstartnendtime(
                                              e.value,
                                              formState.OriginalRepeatCode
                                                ?.value,
                                            );
                                          }
                                        }}
                                        value={
                                          ContentList !== null
                                            ? ContentList.filter(
                                              (option) =>
                                                option.value ===
                                                formState.ContentCode?.value,
                                            )
                                            : ContentDemo.filter(
                                              (option) => option,
                                            )
                                        }
                                      />
                                    </FormItem>
                                    <FormItem asterisk label="Org/Rep">
                                      <Select
                                        options={TimeBand}
                                        onChange={(e) => {
                                          handleSelectChange(
                                            e,
                                            'OriginalRepeatCode',
                                          );
                                          if (formState.ContentCode.value) {
                                            Bindstartnendtime(
                                              formState.ContentCode?.value,
                                              e.value,
                                            );
                                          }
                                        }}
                                        value={
                                          TimeBand !== null
                                            ? TimeBand.filter(
                                              (option) =>
                                                option.value ===
                                                formState.OriginalRepeatCode
                                                  ?.value,
                                            )
                                            : ContentDemo.filter(
                                              (option) => option,
                                            )
                                        }
                                      />
                                    </FormItem>
                                    <FormItem asterisk label="Spot Type">
                                      <Select
                                        options={SpotType}
                                        onChange={(e) =>
                                          handleSelectChange(e, 'SpotTypeCode')
                                        }
                                        value={
                                          SpotType !== null
                                            ? SpotType.filter(
                                              (option) =>
                                                option.value ===
                                                formState.SpotTypeCode?.value,
                                            )
                                            : ContentDemo.filter(
                                              (option) => option,
                                            )
                                        }
                                      />
                                    </FormItem>
                                    <div className="col-span-2">
                                      <FormItem label="Remark">
                                        <Input
                                          value={formState.LineItemRemark}
                                          onChange={(e) =>
                                            handleInputChange(
                                              e.target.value,
                                              'LineItemRemark',
                                            )
                                          }
                                        />
                                      </FormItem>
                                    </div>
                                  </div>
                                </FormContainer>
                              </div>

                              <div
                                className="col-span-1"
                                style={{
                                  backgroundColor:
                                    'rgb(31 41 55/var(--tw-bg-opacity))',
                                  padding: '10px',
                                  borderRadius: '.5rem',
                                }}
                              >
                                <FormContainer>
                                  <div className="grid grid-cols-2 gap-2">
                                    <FormItem asterisk label="Start Time">
                                      <Select
                                        options={Start}
                                        onChange={(e) =>
                                          handleSelectChange(
                                            e.value,
                                            'StartTime',
                                          )
                                        }
                                        value={
                                          Start !== null
                                            ? Start.filter(
                                              (option) =>
                                                option.value ===
                                                formState.StartTime,
                                            )
                                            : ContentDemo.filter(
                                              (option) => option,
                                            )
                                        }
                                      />
                                    </FormItem>
                                    <FormItem asterisk label="End Time">
                                      <Select
                                        options={End}
                                        onChange={(e) =>
                                          handleSelectChange(e.value, 'EndTime')
                                        }
                                        value={
                                          End !== null
                                            ? End.filter(
                                              (option) =>
                                                option.value ===
                                                formState.EndTime,
                                            )
                                            : ContentDemo.filter(
                                              (option) => option,
                                            )
                                        }
                                      />
                                    </FormItem>
                                    <FormItem asterisk label="No Of Week">
                                      <Input
                                        size="sm"
                                        value={formState.NoWeeks}
                                        onChange={(e) =>
                                          handleInputChange(
                                            e.target.value,
                                            'NoWeeks',
                                          )
                                        }
                                      />
                                    </FormItem>
                                    <FormItem asterisk label="Week Part">
                                      <Select
                                        options={Weekdays}
                                        onChange={(e) =>
                                          handleSelectChange(e, 'WeekDayCode')
                                        }
                                        value={
                                          Weekdays !== null
                                            ? Weekdays.filter(
                                              (option) =>
                                                option.value ===
                                                formState.WeekDayCode?.value,
                                            )
                                            : ContentDemo.filter(
                                              (option) => option,
                                            )
                                        }
                                      />
                                    </FormItem>
                                    <div className="col-span-1 ">
                                      <FormItem asterisk label="IsActive">
                                        <Switcher
                                          defaultChecked
                                          value={
                                            formState.LineItemCancelStatus == 1
                                              ? true
                                              : false
                                          }
                                          onChange={(e) =>
                                            handleSwitchChange(
                                              e,
                                              'LineItemCancelStatus',
                                            )
                                          }
                                        />
                                      </FormItem>
                                    </div>
                                  </div>
                                </FormContainer>
                              </div>
                            </div>
                            <div className="col-span-3 mt-2">
                              <FormContainer>
                                <div className="grid grid-cols-6 gap-2">
                                  <div></div>
                                  <FormItem
                                    asterisk
                                    label={
                                      <p
                                        style={{
                                          fontSize: 16,
                                          fontWeight: 600,
                                        }}
                                      >
                                        Rate 10[sec]
                                      </p>
                                    }
                                  >
                                    <Input
                                      size="lg"
                                      value={formState.Rate}
                                      style={{ fontSize: 25, fontWeight: 600 }}
                                      disabled={
                                        formState.SpotTypeCode &&
                                        formState.SpotTypeCode.value === 2
                                      }
                                      onChange={(e) => {
                                        handleInputChange(
                                          e.target.value,
                                          'Rate',
                                        );
                                        if (formState.Second) {
                                          calculateValue(
                                            e.target.value,
                                            formState.Second,
                                          );
                                        }
                                      }}
                                    />
                                  </FormItem>
                                  <FormItem
                                    asterisk
                                    label={
                                      <p style={{ fontSize: 16 }}>Second</p>
                                    }
                                  >
                                    <Input
                                      size="lg"
                                      value={formState.Second}
                                      onChange={(e) => {
                                        handleInputChange(
                                          e.target.value,
                                          'Second',
                                        );
                                        if (formState.Rate) {
                                          calculateValue(
                                            formState.Rate,
                                            e.target.value,
                                          );
                                        }
                                      }}
                                    />
                                  </FormItem>
                                  <FormItem
                                    asterisk
                                    label={
                                      <p style={{ fontSize: 16 }}>Amount</p>
                                    }
                                  >
                                    <Input
                                      size="lg"
                                      value={formState.Amount}
                                      disabled
                                      onChange={(e) =>
                                        handleInputChange(
                                          e.target.value,
                                          'Amount',
                                        )
                                      }
                                    />
                                  </FormItem>
                                  <FormItem
                                    label={
                                      <p style={{ fontSize: 16 }}>
                                        Internal Rate
                                      </p>
                                    }
                                  >
                                    <Input
                                      size="lg"
                                      value={formState.InternalRate}
                                      onChange={(e) =>
                                        handleInputChange(
                                          e.target.value,
                                          'InternalRate',
                                        )
                                      }
                                    />
                                  </FormItem>
                                  <div></div>
                                </div>
                              </FormContainer>
                            </div>
                          </div>
                        </TabContent>

                        {/* RODP */}
                        <TabContent value={2}>
                          <div
                            className="grid grid-cols-3 gap-1"
                            style={{
                              backgroundColor:
                                'rgb(31 41 55/var(--tw-bg-opacity))',
                              padding: '10px',
                              borderWidth: '1px',
                              borderColor:
                                'rgb(75 85 99/var(--tw-border-opacity))',
                              borderRadius: '.5rem',
                            }}
                          >
                            <div
                              className="col-span-2"
                              style={{
                                backgroundColor:
                                  'rgb(31 41 55/var(--tw-bg-opacity))',
                                padding: '10px',
                                borderRadius: '.5rem',
                              }}
                            >
                              <FormContainer>
                                <div className="grid grid-cols-2 gap-2">
                                  <FormItem asterisk label="RODP Category">
                                    <Select
                                      options={RODP}
                                      onChange={(e) =>
                                        handleSelectChange(e, 'TimeBandCode')
                                      }
                                      value={
                                        RODP !== null
                                          ? RODP.filter(
                                            (option) =>
                                              option.value ===
                                              formState.TimeBandCode?.value,
                                          )
                                          : ContentDemo.filter(
                                            (option) => option,
                                          )
                                      }
                                    />
                                  </FormItem>
                                  <FormItem asterisk label="Spot Type">
                                    <Select
                                      options={SpotType}
                                      onChange={(e) =>
                                        handleSelectChange(e, 'SpotTypeCode')
                                      }
                                      value={
                                        SpotType !== null
                                          ? SpotType.filter(
                                            (option) =>
                                              option.value ===
                                              formState.SpotTypeCode?.value,
                                          )
                                          : ContentDemo.filter(
                                            (option) => option,
                                          )
                                      }
                                    />
                                  </FormItem>
                                  {/* <FormItem
                                                                    asterisk
                                                                    label="Spot Perference"
                                                                >
                                                                    <Select
                                                                        options={colourOptions}
                                                                        onChange={(e) => handleSelectChange(e, 'SpotPreferenceCode')}
                                                                        value={
                                                                            colourOptions !== null
                                                                                ? colourOptions.filter((option) => option.value === formState.SpotPreferenceCode?.value)
                                                                                : ContentDemo.filter((option) => option)
                                                                        }
                                                                    />
                                                                </FormItem> */}
                                  <FormItem asterisk label="Spot Perference">
                                    <Select
                                      options={SpotPreference}
                                      onChange={(e) =>
                                        handleSelectChange(
                                          e,
                                          'SpotPreferenceCode',
                                        )
                                      }
                                      value={
                                        SpotPreference !== null
                                          ? SpotPreference.filter(
                                            (option) =>
                                              option.value ===
                                              formState.SpotPreferenceCode
                                                ?.value,
                                          )
                                          : ContentDemo.filter(
                                            (option) => option,
                                          )
                                      }
                                    />
                                  </FormItem>
                                  <div className="col-span-1">
                                    <FormItem label="Remark">
                                      <Input
                                        value={formState.LineItemRemark}
                                        onChange={(e) =>
                                          handleInputChange(
                                            e.target.value,
                                            'LineItemRemark',
                                          )
                                        }
                                      />
                                    </FormItem>
                                  </div>
                                </div>
                              </FormContainer>
                            </div>

                            <div
                              className="col-span-1"
                              style={{
                                backgroundColor:
                                  'rgb(31 41 55/var(--tw-bg-opacity))',
                                padding: '10px',
                                borderRadius: '.5rem',
                              }}
                            >
                              <FormContainer>
                                <div className="grid grid-cols-2 gap-2">
                                  <FormItem asterisk label="Start Time">
                                    <Input
                                      size="sm"
                                      value={formState.StartTime}
                                      disabled
                                      onChange={(e) =>
                                        handleInputChange(
                                          e.target.value,
                                          'StartTime',
                                        )
                                      }
                                    />
                                  </FormItem>
                                  <FormItem asterisk label="End Time">
                                    <Input
                                      size="sm"
                                      value={formState.EndTime}
                                      disabled
                                      onChange={(e) =>
                                        handleInputChange(
                                          e.target.value,
                                          'EndTime',
                                        )
                                      }
                                    />
                                  </FormItem>
                                  <div className="col-span-2">
                                    <div className="col-span-2 flex mb-2">
                                      {' '}
                                      <Checkbox
                                        value={
                                          formState.IsCommited == 1
                                            ? true
                                            : false
                                        }
                                        onChange={(e) =>
                                          handleSwitchChange(e, 'IsCommited')
                                        }
                                      />
                                      Is Commited Time
                                    </div>
                                    {formState.IsCommited == 1 ? (
                                      <div className="grid grid-cols-2 gap-2">
                                        <FormItem label="Commited Start Time">
                                          <Input
                                            size="sm"
                                            name="CommitedStartTime"
                                            maxLength="8"
                                            placeholder="HH:MM:SS"
                                            value={formState.CommitedStartTime}
                                            onChange={(e) =>
                                              handleChangeWithOutFrameNew(
                                                e,
                                                setFormState,
                                              )
                                            }
                                            onBlur={handleBlur}
                                          />
                                        </FormItem>
                                        <FormItem label="Commited End Time">
                                          <Input
                                            size="sm"
                                            name="CommitedEndTime"
                                            maxLength="8"
                                            placeholder="HH:MM:SS"
                                            value={formState.CommitedEndTime}
                                            onChange={(e) =>
                                              handleChangeWithOutFrameNew(
                                                e,
                                                setFormState,
                                              )
                                            }
                                            onBlur={handleBlur}
                                          />
                                        </FormItem>
                                      </div>
                                    ) : null}
                                  </div>
                                </div>
                                <div className="grid grid-cols-2 gap-2 ">
                                  <FormItem asterisk label="Week Part">
                                    <Select
                                      options={Weekdays}
                                      onChange={(e) =>
                                        handleSelectChange(e, 'WeekDayCode')
                                      }
                                      value={
                                        Weekdays !== null
                                          ? Weekdays.filter(
                                            (option) =>
                                              option.value ===
                                              formState.WeekDayCode?.value,
                                          )
                                          : ContentDemo.filter(
                                            (option) => option,
                                          )
                                      }
                                    />
                                  </FormItem>

                                  <FormItem asterisk label="IsActive">
                                    <Switcher
                                      defaultChecked
                                      value={
                                        formState.LineItemCancelStatus == 1
                                          ? true
                                          : false
                                      }
                                      onChange={(e) =>
                                        handleSwitchChange(
                                          e,
                                          'LineItemCancelStatus',
                                        )
                                      }
                                    />
                                  </FormItem>
                                </div>
                              </FormContainer>
                            </div>
                            <div className="col-span-3 mt-2">
                              <FormContainer>
                                <div className="grid grid-cols-6 gap-2">
                                  <div></div>
                                  <FormItem
                                    asterisk
                                    label={
                                      <p
                                        style={{
                                          fontSize: 16,
                                          fontWeight: 600,
                                        }}
                                      >
                                        Rate 10[sec]
                                      </p>
                                    }
                                  >
                                    <Input
                                      size="lg"
                                      value={formState.Rate}
                                      style={{ fontSize: 25, fontWeight: 600 }}
                                      disabled={
                                        formState.SpotTypeCode &&
                                        formState.SpotTypeCode.value === 2
                                      }
                                      onChange={(e) => {
                                        handleInputChange(
                                          e.target.value,
                                          'Rate',
                                        );
                                        if (formState.Second) {
                                          calculateValue(
                                            e.target.value,
                                            formState.Second,
                                          );
                                        }
                                      }}
                                    />
                                  </FormItem>
                                  <FormItem
                                    asterisk
                                    label={
                                      <p style={{ fontSize: 16 }}>Second</p>
                                    }
                                  >
                                    <Input
                                      size="lg"
                                      value={formState.Second}
                                      onChange={(e) => {
                                        handleInputChange(
                                          e.target.value,
                                          'Second',
                                        );
                                        if (formState.Rate) {
                                          calculateValue(
                                            formState.Rate,
                                            e.target.value,
                                          );
                                        }
                                      }}
                                    />
                                  </FormItem>
                                  <FormItem
                                    asterisk
                                    label={
                                      <p style={{ fontSize: 16 }}>Amount</p>
                                    }
                                  >
                                    <Input
                                      size="lg"
                                      value={formState.Amount}
                                      disabled
                                      onChange={(e) =>
                                        handleInputChange(
                                          e.target.value,
                                          'Amount',
                                        )
                                      }
                                    />
                                  </FormItem>
                                  <FormItem
                                    label={
                                      <p style={{ fontSize: 16 }}>
                                        Internal Rate
                                      </p>
                                    }
                                  >
                                    <Input
                                      size="lg"
                                      value={formState.InternalRate}
                                      onChange={(e) =>
                                        handleInputChange(
                                          e.target.value,
                                          'InternalRate',
                                        )
                                      }
                                    />
                                  </FormItem>
                                  <div></div>
                                </div>
                              </FormContainer>
                            </div>
                          </div>
                        </TabContent>

                        {/* Program wise */}
                        <TabContent value={3}>
                          <div
                            className="grid grid-cols-3 gap-1"
                            style={{
                              backgroundColor:
                                'rgb(31 41 55/var(--tw-bg-opacity))',
                              padding: '10px',
                              borderWidth: '1px',
                              borderColor:
                                'rgb(75 85 99/var(--tw-border-opacity))',
                              borderRadius: '.5rem',
                            }}
                          >
                            <div
                              className="col-span-2"
                              style={{
                                backgroundColor:
                                  'rgb(31 41 55/var(--tw-bg-opacity))',
                                padding: '10px',

                                borderRadius: '.5rem',
                              }}
                            >
                              <FormContainer>
                                <div className="grid grid-cols-2 gap-2">
                                  <FormItem asterisk label="Content">
                                    <Select
                                      options={ContentList}
                                      onChange={(e) => {
                                        handleSelectChange(e, 'ContentCode');
                                        if (
                                          formState.OriginalRepeatCode?.value
                                        ) {
                                          Bindstartnendtime(
                                            e.value,
                                            formState.OriginalRepeatCode?.value,
                                          );
                                        }
                                      }}
                                      value={
                                        ContentList !== null
                                          ? ContentList.filter(
                                            (option) =>
                                              option.value ===
                                              formState.ContentCode?.value,
                                          )
                                          : ContentDemo.filter(
                                            (option) => option,
                                          )
                                      }
                                    />
                                  </FormItem>
                                  <FormItem asterisk label="Org/Rep">
                                    <Select
                                      options={TimeBand}
                                      onChange={(e) => {
                                        handleSelectChange(
                                          e,
                                          'OriginalRepeatCode',
                                        );
                                        if (formState.ContentCode.value) {
                                          Bindstartnendtime(
                                            formState.ContentCode?.value,
                                            e.value,
                                          );
                                        }
                                      }}
                                      value={
                                        TimeBand !== null
                                          ? TimeBand.filter(
                                            (option) =>
                                              option.value ===
                                              formState.OriginalRepeatCode
                                                ?.value,
                                          )
                                          : ContentDemo.filter(
                                            (option) => option,
                                          )
                                      }
                                    />
                                  </FormItem>
                                  <FormItem asterisk label="Spot Type">
                                    <Select
                                      options={SpotType}
                                      onChange={(e) =>
                                        handleSelectChange(e, 'SpotTypeCode')
                                      }
                                      value={
                                        SpotType !== null
                                          ? SpotType.filter(
                                            (option) =>
                                              option.value ===
                                              formState.SpotTypeCode?.value,
                                          )
                                          : ContentDemo.filter(
                                            (option) => option,
                                          )
                                      }
                                    />
                                  </FormItem>
                                  <div className="col-span-1">
                                    <FormItem label="Remark">
                                      <Input
                                        value={formState.LineItemRemark}
                                        onChange={(e) =>
                                          handleInputChange(
                                            e.target.value,
                                            'LineItemRemark',
                                          )
                                        }
                                      />
                                    </FormItem>
                                  </div>
                                </div>
                              </FormContainer>
                            </div>

                            <div
                              className="col-span-1"
                              style={{
                                backgroundColor:
                                  'rgb(31 41 55/var(--tw-bg-opacity))',
                                padding: '10px',
                                borderRadius: '.5rem',
                              }}
                            >
                              <FormContainer>
                                <div className="grid grid-cols-2 gap-2">
                                  <FormItem asterisk label="Start Time">
                                    <Select
                                      options={Start}
                                      onChange={(e) =>
                                        handleSelectChange(e, 'StartTime')
                                      }
                                      value={
                                        Start !== null
                                          ? Start.filter(
                                            (option) =>
                                              option.value ===
                                              formState.StartTime,
                                          )
                                          : ContentDemo.filter(
                                            (option) => option,
                                          )
                                      }
                                    />
                                  </FormItem>
                                  <FormItem asterisk label="End Time">
                                    <Select
                                      options={End}
                                      onChange={(e) =>
                                        handleSelectChange(e.value, 'EndTime')
                                      }
                                      value={
                                        End !== null
                                          ? End.filter(
                                            (option) =>
                                              option.value ===
                                              formState.EndTime,
                                          )
                                          : ContentDemo.filter(
                                            (option) => option,
                                          )
                                      }
                                    />
                                  </FormItem>
                                  <FormItem asterisk label="Week Part">
                                    <Select
                                      options={Weekdays}
                                      onChange={(e) =>
                                        handleSelectChange(e, 'WeekDayCode')
                                      }
                                      value={
                                        Weekdays !== null
                                          ? Weekdays.filter(
                                            (option) =>
                                              option.value ===
                                              formState.WeekDayCode?.value,
                                          )
                                          : ContentDemo.filter(
                                            (option) => option,
                                          )
                                      }
                                    />
                                  </FormItem>
                                  <div className="col-span-1 ">
                                    <FormItem asterisk label="IsActive">
                                      <Switcher
                                        defaultChecked
                                        value={
                                          formState.LineItemCancelStatus == 1
                                            ? true
                                            : false
                                        }
                                        onChange={(e) =>
                                          handleSwitchChange(
                                            e,
                                            'LineItemCancelStatus',
                                          )
                                        }
                                      />
                                    </FormItem>
                                  </div>
                                </div>
                              </FormContainer>
                            </div>

                            <div className="col-span-3 mt-2">
                              <FormContainer>
                                <div className="grid grid-cols-6 gap-2">
                                  <div></div>
                                  <FormItem
                                    asterisk
                                    label={
                                      <p
                                        style={{
                                          fontSize: 16,
                                          fontWeight: 600,
                                        }}
                                      >
                                        Rate 10[sec]
                                      </p>
                                    }
                                  >
                                    <Input
                                      size="lg"
                                      value={formState.Rate}
                                      style={{ fontSize: 25, fontWeight: 600 }}
                                      onChange={(e) => {
                                        handleInputChange(
                                          e.target.value,
                                          'Rate',
                                        );
                                        if (formState.Second) {
                                          calculateValue(
                                            e.target.value,
                                            formState.Second,
                                          );
                                        }
                                      }}
                                    />
                                  </FormItem>
                                  <FormItem
                                    asterisk
                                    label={
                                      <p style={{ fontSize: 16 }}>Second</p>
                                    }
                                  >
                                    <Input
                                      size="lg"
                                      value={formState.Second}
                                      onChange={(e) => {
                                        handleInputChange(
                                          e.target.value,
                                          'Second',
                                        );
                                        if (formState.Rate) {
                                          calculateValue(
                                            formState.Rate,
                                            e.target.value,
                                          );
                                        }
                                      }}
                                    />
                                  </FormItem>
                                  <FormItem
                                    asterisk
                                    label={
                                      <p style={{ fontSize: 16 }}>Amount</p>
                                    }
                                  >
                                    <Input
                                      size="lg"
                                      value={formState.Amount}
                                      disabled
                                      onChange={(e) =>
                                        handleInputChange(
                                          e.target.value,
                                          'Amount',
                                        )
                                      }
                                    />
                                  </FormItem>
                                  <FormItem
                                    label={
                                      <p style={{ fontSize: 16 }}>
                                        Internal Rate
                                      </p>
                                    }
                                  >
                                    <Input
                                      size="lg"
                                      value={formState.InternalRate}
                                      onChange={(e) =>
                                        handleInputChange(
                                          e.target.value,
                                          'InternalRate',
                                        )
                                      }
                                    />
                                  </FormItem>
                                  <div></div>
                                </div>
                              </FormContainer>
                            </div>
                          </div>
                        </TabContent>

                        {/* NTC wise */}
                        <TabContent value={4}>
                          <div
                            className="grid grid-cols-3 gap-1"
                            style={{
                              backgroundColor:
                                'rgb(31 41 55/var(--tw-bg-opacity))',
                              padding: '10px',
                              borderWidth: '1px',
                              borderColor:
                                'rgb(75 85 99/var(--tw-border-opacity))',
                              borderRadius: '.5rem',
                            }}
                          >
                            <div
                              className="col-span-2"
                              style={{
                                backgroundColor:
                                  'rgb(31 41 55/var(--tw-bg-opacity))',
                                padding: '10px',

                                borderRadius: '.5rem',
                              }}
                            >
                              <FormContainer>
                                <div className="grid grid-cols-2 gap-2">
                                  <FormItem asterisk label="RODP Category">
                                    <Select
                                      options={RODP}
                                      onChange={(e) =>
                                        handleSelectChange(e, 'TimeBandCode')
                                      }
                                      value={
                                        RODP !== null
                                          ? RODP.filter(
                                            (option) =>
                                              option.value ===
                                              formState.TimeBandCode?.value,
                                          )
                                          : ContentDemo.filter(
                                            (option) => option,
                                          )
                                      }
                                    />
                                  </FormItem>
                                  <FormItem asterisk label="NTC Type">
                                    <Select
                                      options={NTCType}
                                      onChange={(e) => {
                                        handleSelectChange(e, 'NTCTypeCode');
                                        setFormState((prevFormState) => ({
                                          ...prevFormState,
                                          IsNTC: 1,
                                        }));
                                      }}
                                      value={
                                        NTCType !== null
                                          ? NTCType.filter(
                                            (option) =>
                                              option.value ===
                                              formState.NTCTypeCode?.value,
                                          )
                                          : ContentDemo.filter(
                                            (option) => option,
                                          )
                                      }
                                    />
                                  </FormItem>
                                  <FormItem asterisk label="Spot Type">
                                    <Select
                                      options={SpotType}
                                      onChange={(e) =>
                                        handleSelectChange(e, 'SpotTypeCode')
                                      }
                                      value={
                                        SpotType !== null
                                          ? SpotType.filter(
                                            (option) =>
                                              option.value ===
                                              formState.SpotTypeCode?.value,
                                          )
                                          : ContentDemo.filter(
                                            (option) => option,
                                          )
                                      }
                                    />
                                  </FormItem>
                                  <div className="col-span-1">
                                    <FormItem label="Remark">
                                      <Input
                                        value={formState.LineItemRemark}
                                        onChange={(e) =>
                                          handleInputChange(
                                            e.target.value,
                                            'LineItemRemark',
                                          )
                                        }
                                      />
                                    </FormItem>
                                  </div>
                                </div>
                              </FormContainer>
                            </div>

                            <div
                              className="col-span-1"
                              style={{
                                backgroundColor:
                                  'rgb(31 41 55/var(--tw-bg-opacity))',
                                padding: '10px',
                                borderRadius: '.5rem',
                              }}
                            >
                              <FormContainer>
                                <div className="grid grid-cols-2 gap-2">
                                  <FormItem asterisk label="Start Time">
                                    <Input
                                      size="sm"
                                      disabled
                                      value={formState.StartTime}
                                      onChange={(e) =>
                                        handleInputChange(
                                          e.target.value,
                                          'StartTime',
                                        )
                                      }
                                    />
                                  </FormItem>
                                  <FormItem asterisk label="End Time">
                                    <Input
                                      size="sm"
                                      disabled
                                      value={formState.EndTime}
                                      onChange={(e) =>
                                        handleInputChange(
                                          e.target.value,
                                          'EndTime',
                                        )
                                      }
                                    />
                                  </FormItem>
                                  <FormItem asterisk label="Week Part">
                                    <Select
                                      options={Weekdays}
                                      onChange={(e) =>
                                        handleSelectChange(e, 'WeekDayCode')
                                      }
                                      value={
                                        Weekdays !== null
                                          ? Weekdays.filter(
                                            (option) =>
                                              option.value ===
                                              formState.WeekDayCode?.value,
                                          )
                                          : ContentDemo.filter(
                                            (option) => option,
                                          )
                                      }
                                    />
                                  </FormItem>
                                  <div className="col-span-1 ">
                                    <FormItem asterisk label="IsActive">
                                      <Switcher
                                        defaultChecked
                                        value={
                                          formState.LineItemCancelStatus == 1
                                            ? true
                                            : false
                                        }
                                        onChange={(e) =>
                                          handleSwitchChange(
                                            e,
                                            'LineItemCancelStatus',
                                          )
                                        }
                                      />
                                    </FormItem>
                                  </div>
                                </div>
                              </FormContainer>
                            </div>
                            <div className="col-span-3 mt-2">
                              <FormContainer>
                                <div className="grid grid-cols-6 gap-2">
                                  <div></div>
                                  <FormItem
                                    asterisk
                                    label={
                                      <p
                                        style={{
                                          fontSize: 16,
                                          fontWeight: 600,
                                        }}
                                      >
                                        Rate 10[sec]
                                      </p>
                                    }
                                  >
                                    <Input
                                      size="lg"
                                      value={formState.Rate}
                                      style={{ fontSize: 25, fontWeight: 600 }}
                                      onChange={(e) => {
                                        handleInputChange(
                                          e.target.value,
                                          'Rate',
                                        );
                                        if (formState.Second) {
                                          calculateValue(
                                            e.target.value,
                                            formState.Second,
                                          );
                                        }
                                      }}
                                    />
                                  </FormItem>
                                  <FormItem
                                    asterisk
                                    label={
                                      <p style={{ fontSize: 16 }}>NTC Spots</p>
                                    }
                                  >
                                    <Input
                                      size="lg"
                                      value={formState.NTCTotalSpots}
                                      onChange={(e) => {
                                        handleInputChange(
                                          e.target.value,
                                          'NTCTotalSpots',
                                        );
                                        if (formState.Rate) {
                                          calculateValueX(
                                            formState.Rate,
                                            e.target.value,
                                          );
                                        }
                                      }}
                                    />
                                  </FormItem>
                                  <FormItem
                                    asterisk
                                    label={
                                      <p style={{ fontSize: 16 }}>Amount</p>
                                    }
                                  >
                                    <Input
                                      size="lg"
                                      value={formState.Amount}
                                      disabled
                                      onChange={(e) =>
                                        handleInputChange(
                                          e.target.value,
                                          'Amount',
                                        )
                                      }
                                    />
                                  </FormItem>
                                  <FormItem
                                    label={
                                      <p style={{ fontSize: 16 }}>
                                        Internal Rate
                                      </p>
                                    }
                                  >
                                    <Input
                                      size="lg"
                                      value={formState.InternalRate}
                                      onChange={(e) =>
                                        handleInputChange(
                                          e.target.value,
                                          'InternalRate',
                                        )
                                      }
                                    />
                                  </FormItem>
                                  <div></div>
                                </div>
                              </FormContainer>
                            </div>
                          </div>
                        </TabContent>

                        {/* Slot wise */}
                        <TabContent value={5}>
                          <div
                            className="grid grid-cols-3 gap-1"
                            style={{
                              backgroundColor:
                                'rgb(31 41 55/var(--tw-bg-opacity))',
                              padding: '10px',
                              borderWidth: '1px',
                              borderColor:
                                'rgb(75 85 99/var(--tw-border-opacity))',
                              borderRadius: '.5rem',
                            }}
                          >
                            <div
                              className="col-span-2"
                              style={{
                                backgroundColor:
                                  'rgb(31 41 55/var(--tw-bg-opacity))',
                                padding: '10px',
                                borderRadius: '.5rem',
                              }}
                            >
                              <FormContainer>
                                <div className="grid grid-cols-2 gap-2">
                                  <FormItem asterisk label="Content">
                                    <Select
                                      options={ContentList}
                                      onChange={(e) => {
                                        handleSelectChange(e, 'ContentCode');

                                        if (
                                          formState.OriginalRepeatCode?.value
                                        ) {
                                          Bindstartnendtime(
                                            e.value,
                                            formState.OriginalRepeatCode?.value,
                                          );
                                        }
                                      }}
                                      value={
                                        ContentList !== null
                                          ? ContentList.filter(
                                            (option) =>
                                              option.value ===
                                              formState.ContentCode?.value,
                                          )
                                          : ContentDemo.filter(
                                            (option) => option,
                                          )
                                      }
                                    />
                                  </FormItem>
                                  <FormItem asterisk label="Org/Rep">
                                    <Select
                                      options={TimeBand}
                                      onChange={(e) => {
                                        handleSelectChange(
                                          e,
                                          'OriginalRepeatCode',
                                        );
                                        if (formState.ContentCode.value) {
                                          Bindstartnendtime(
                                            formState.ContentCode?.value,
                                            e.value,
                                          );
                                        }
                                      }}
                                      value={
                                        TimeBand !== null
                                          ? TimeBand.filter(
                                            (option) =>
                                              option.value ===
                                              formState.OriginalRepeatCode
                                                ?.value,
                                          )
                                          : ContentDemo.filter(
                                            (option) => option,
                                          )
                                      }
                                    />
                                  </FormItem>
                                  <FormItem asterisk label="Spot Type">
                                    <Select
                                      options={SpotType}
                                      onChange={(e) =>
                                        handleSelectChange(e, 'SpotTypeCode')
                                      }
                                      value={
                                        SpotType !== null
                                          ? SpotType.filter(
                                            (option) =>
                                              option.value ===
                                              formState.SpotTypeCode?.value,
                                          )
                                          : ContentDemo.filter(
                                            (option) => option,
                                          )
                                      }
                                    />
                                  </FormItem>
                                  <div className="col-span-1">
                                    <FormItem label="Remark">
                                      <Input
                                        value={formState.LineItemRemark}
                                        onChange={(e) =>
                                          handleInputChange(
                                            e.target.value,
                                            'LineItemRemark',
                                          )
                                        }
                                      />
                                    </FormItem>
                                  </div>
                                </div>
                              </FormContainer>
                            </div>

                            <div
                              className="col-span-1"
                              style={{
                                backgroundColor:
                                  'rgb(31 41 55/var(--tw-bg-opacity))',
                                padding: '10px',
                                borderRadius: '.5rem',
                              }}
                            >
                              <FormContainer>
                                <div className="grid grid-cols-2 gap-2">
                                  <FormItem asterisk label="Start Time">
                                    <Select
                                      options={Start}
                                      onChange={(e) =>
                                        handleSelectChange(e.value, 'StartTime')
                                      }
                                      value={
                                        Start !== null
                                          ? Start.filter(
                                            (option) =>
                                              option.value ===
                                              formState.StartTime,
                                          )
                                          : ContentDemo.filter(
                                            (option) => option,
                                          )
                                      }
                                    />
                                  </FormItem>
                                  <FormItem asterisk label="End Time">
                                    <Select
                                      options={End}
                                      onChange={(e) =>
                                        handleSelectChange(e.value, 'EndTime')
                                      }
                                      value={
                                        End !== null
                                          ? End.filter(
                                            (option) =>
                                              option.value ===
                                              formState.EndTime,
                                          )
                                          : ContentDemo.filter(
                                            (option) => option,
                                          )
                                      }
                                    />
                                  </FormItem>
                                  <FormItem asterisk label="Week Part">
                                    <Select
                                      options={Weekdays}
                                      onChange={(e) =>
                                        handleSelectChange(e, 'WeekDayCode')
                                      }
                                      value={
                                        Weekdays !== null
                                          ? Weekdays.filter(
                                            (option) =>
                                              option.value ===
                                              formState.WeekDayCode?.value,
                                          )
                                          : ContentDemo.filter(
                                            (option) => option,
                                          )
                                      }
                                    />
                                  </FormItem>
                                  <div className="col-span-1 ">
                                    <FormItem asterisk label="IsActive">
                                      <Switcher
                                        defaultChecked
                                        value={
                                          formState.LineItemCancelStatus == 1
                                            ? true
                                            : false
                                        }
                                        onChange={(e) =>
                                          handleSwitchChange(
                                            e,
                                            'LineItemCancelStatus',
                                          )
                                        }
                                      />
                                    </FormItem>
                                  </div>
                                </div>
                              </FormContainer>
                            </div>

                            <div className="col-span-3 mt-2">
                              <FormContainer>
                                <div className="grid grid-cols-6 gap-2">
                                  <div></div>
                                  <FormItem
                                    asterisk
                                    label={
                                      <p
                                        style={{
                                          fontSize: 16,
                                          fontWeight: 600,
                                        }}
                                      >
                                        Rate 10[sec]
                                      </p>
                                    }
                                  >
                                    <Input
                                      size="lg"
                                      value={formState.Rate}
                                      style={{ fontSize: 25, fontWeight: 600 }}
                                      onChange={(e) => {
                                        handleInputChange(
                                          e.target.value,
                                          'Rate',
                                        );
                                        if (formState.Second) {
                                          calculateValue(
                                            e.target.value,
                                            formState.Second,
                                          );
                                        }
                                      }}
                                    />
                                  </FormItem>
                                  <FormItem
                                    asterisk
                                    label={<p style={{ fontSize: 16 }}>Slot</p>}
                                  >
                                    <Input
                                      size="lg"
                                      value={formState.TotalSpots}
                                      onChange={(e) => {
                                        handleInputChange(
                                          e.target.value,
                                          'TotalSpots',
                                        );
                                        if (formState.Rate) {
                                          calculateValueX(
                                            formState.Rate,
                                            e.target.value,
                                          );
                                        }
                                      }}
                                    />
                                  </FormItem>
                                  <FormItem
                                    asterisk
                                    label={
                                      <p style={{ fontSize: 16 }}>Amount</p>
                                    }
                                  >
                                    <Input
                                      size="lg"
                                      value={formState.Amount}
                                      disabled
                                      onChange={(e) =>
                                        handleInputChange(
                                          e.target.value,
                                          'Amount',
                                        )
                                      }
                                    />
                                  </FormItem>
                                  <FormItem
                                    label={
                                      <p style={{ fontSize: 16 }}>
                                        Internal Rate
                                      </p>
                                    }
                                  >
                                    <Input
                                      size="lg"
                                      value={formState.InternalRate}
                                      onChange={(e) =>
                                        handleInputChange(
                                          e.target.value,
                                          'InternalRate',
                                        )
                                      }
                                    />
                                  </FormItem>
                                  <div></div>
                                </div>
                              </FormContainer>
                            </div>
                          </div>
                        </TabContent>

                        {/* slot RODP */}
                        <TabContent value={6}>
                          <div
                            className="grid grid-cols-3 gap-1"
                            style={{
                              backgroundColor:
                                'rgb(31 41 55/var(--tw-bg-opacity))',
                              padding: '10px',
                              borderWidth: '1px',
                              borderColor:
                                'rgb(75 85 99/var(--tw-border-opacity))',
                              borderRadius: '.5rem',
                            }}
                          >
                            <div
                              className="col-span-2"
                              style={{
                                backgroundColor:
                                  'rgb(31 41 55/var(--tw-bg-opacity))',
                                padding: '10px',

                                borderRadius: '.5rem',
                              }}
                            >
                              <FormContainer>
                                <div className="grid grid-cols-2 gap-2">
                                  <FormItem asterisk label="RODP Category..*..">
                                    <Select
                                      options={RODP}
                                      onChange={(e) =>
                                        handleSelectChange(e, 'TimeBandCode')
                                      }
                                      value={
                                        RODP !== null
                                          ? RODP.filter(
                                            (option) =>
                                              option.value ===
                                              formState.TimeBandCode?.value,
                                          )
                                          : ContentDemo.filter(
                                            (option) => option,
                                          )
                                      }
                                    />
                                  </FormItem>

                                  <FormItem asterisk label="Spot Type">
                                    <Select
                                      options={SpotType}
                                      onChange={(e) =>
                                        handleSelectChange(e, 'SpotTypeCode')
                                      }
                                      value={
                                        SpotType !== null
                                          ? SpotType.filter(
                                            (option) =>
                                              option.value ===
                                              formState.SpotTypeCode?.value,
                                          )
                                          : ContentDemo.filter(
                                            (option) => option,
                                          )
                                      }
                                    />
                                  </FormItem>
                                  <div className="col-span-2">
                                    <FormItem label="Remark">
                                      <Input
                                        value={formState.LineItemRemark}
                                        onChange={(e) =>
                                          handleInputChange(
                                            e.target.value,
                                            'LineItemRemark',
                                          )
                                        }
                                      />
                                    </FormItem>
                                  </div>
                                </div>
                              </FormContainer>
                            </div>

                            <div
                              className="col-span-1"
                              style={{
                                backgroundColor:
                                  'rgb(31 41 55/var(--tw-bg-opacity))',
                                padding: '10px',
                                borderRadius: '.5rem',
                              }}
                            >
                              <FormContainer>
                                <div className="grid grid-cols-2 gap-2">
                                  <FormItem asterisk label="Start Time">
                                    <Input
                                      size="sm"
                                      value={formState.StartTime}
                                      disabled
                                      onChange={(e) =>
                                        handleInputChange(
                                          e.target.value,
                                          'StartTime',
                                        )
                                      }
                                    />
                                  </FormItem>
                                  <FormItem asterisk label="End Time">
                                    <Input
                                      size="sm"
                                      value={formState.EndTime}
                                      disabled
                                      onChange={(e) =>
                                        handleInputChange(
                                          e.target.value,
                                          'EndTime',
                                        )
                                      }
                                    />
                                  </FormItem>
                                  <FormItem asterisk label="Week Part">
                                    <Select
                                      options={Weekdays}
                                      onChange={(e) =>
                                        handleSelectChange(e, 'WeekDayCode')
                                      }
                                      value={
                                        Weekdays !== null
                                          ? Weekdays.filter(
                                            (option) =>
                                              option.value ===
                                              formState.WeekDayCode?.value,
                                          )
                                          : ContentDemo.filter(
                                            (option) => option,
                                          )
                                      }
                                    />
                                  </FormItem>
                                  <div className="col-span-1 ">
                                    <FormItem asterisk label="IsActive">
                                      <Switcher
                                        defaultChecked
                                        value={
                                          formState.LineItemCancelStatus == 1
                                            ? true
                                            : false
                                        }
                                        onChange={(e) =>
                                          handleSwitchChange(
                                            e,
                                            'LineItemCancelStatus',
                                          )
                                        }
                                      />
                                    </FormItem>
                                  </div>
                                </div>
                              </FormContainer>
                            </div>
                            <div className="col-span-3 mt-2">
                              <FormContainer>
                                <div className="grid grid-cols-6 gap-2">
                                  <div></div>
                                  <FormItem
                                    asterisk
                                    label={
                                      <p
                                        style={{
                                          fontSize: 16,
                                          fontWeight: 600,
                                        }}
                                      >
                                        Rate 10[sec]
                                      </p>
                                    }
                                  >
                                    <Input
                                      size="lg"
                                      value={formState.Rate}
                                      style={{ fontSize: 25, fontWeight: 600 }}
                                      onChange={(e) => {
                                        handleInputChange(
                                          e.target.value,
                                          'Rate',
                                        );
                                        if (formState.Second) {
                                          calculateValue(
                                            e.target.value,
                                            formState.Second,
                                          );
                                        }
                                      }}
                                    />
                                  </FormItem>
                                  <FormItem
                                    asterisk
                                    label={<p style={{ fontSize: 16 }}>Slot</p>}
                                  >
                                    <Input
                                      size="lg"
                                      value={formState.TotalSpots}
                                      onChange={(e) => {
                                        handleInputChange(
                                          e.target.value,
                                          'TotalSpots',
                                        );
                                        if (formState.Rate) {
                                          calculateValueX(
                                            formState.Rate,
                                            e.target.value,
                                          );
                                        }
                                      }}
                                    />
                                  </FormItem>
                                  <FormItem
                                    asterisk
                                    label={
                                      <p style={{ fontSize: 16 }}>Amount</p>
                                    }
                                  >
                                    <Input
                                      size="lg"
                                      value={formState.Amount}
                                      disabled
                                      onChange={(e) =>
                                        handleInputChange(
                                          e.target.value,
                                          'Amount',
                                        )
                                      }
                                    />
                                  </FormItem>
                                  <FormItem
                                    label={
                                      <p style={{ fontSize: 16 }}>
                                        Internal Rate
                                      </p>
                                    }
                                  >
                                    <Input
                                      size="lg"
                                      value={formState.InternalRate}
                                      onChange={(e) =>
                                        handleInputChange(
                                          e.target.value,
                                          'InternalRate',
                                        )
                                      }
                                    />
                                  </FormItem>
                                  <div></div>
                                </div>
                              </FormContainer>
                            </div>
                          </div>
                        </TabContent>
                      </div>
                    </Tabs>
                  </div>
                  {currentTab != 0 && (
                    <div className="text-right px-6 py-3  rounded-bl-lg rounded-br-lg">
                      <Button
                        variant="solid"
                        size="sm"
                        onClick={() => {
                          console.log('formState edit', formState, currentTab);
                          //

                          // const filteredData = DataDisplay.some(obj => obj.ID == findId)
                          const indexToUpdate = DataDisplay.findIndex(
                            (obj) => obj.ID === findId,
                          );
                          console.log('indexToUpdate', indexToUpdate);
                          if (indexToUpdate !== -1) {
                            const updatedItem = {
                              ...DataDisplay[indexToUpdate],
                              name: currentTab,
                              DealLineItemNo: findId,
                              ...formState,
                            };
                            const updatedDataDisplay = [...DataDisplay];
                            updatedDataDisplay[indexToUpdate] = updatedItem;
                            setDataDisplay(updatedDataDisplay);
                            setfindId();
                            onDialogClose();
                          } else {
                            console.log('formState', formState, currentTab);
                            if (DealLineAddValidation(formState, currentTab)) {
                              setDataDisplay([
                                ...DataDisplay,
                                {
                                  name: currentTab,
                                  DealLineItemNo: DataDisplay.length + 1,
                                  ID: DataDisplay.length + 1,
                                  ...formState,
                                },
                              ]);
                              onDialogClose();
                            }
                          }
                        }}
                      >
                        {findId > 0 ? 'Edit' : 'Add'}
                      </Button>
                    </div>
                  )}
                  {/* </Dialog> */}
                  <DealCard
                    DataDisplay={DataDisplay}
                    setFormState={setFormState}
                    setfindId={setfindId}
                    setCurrentTab={setCurrentTab}
                    step={step}
                  />
                </div>
              );
            case 2:
              return (
                <div>
                  <DealHeader
                    datg={datg}
                    onPrevious={onPrevious}
                    onCollapse={onCollapse}
                    onDialogClose={onDialogClose}
                    collapse={collapse}
                    setCurrentTab={setCurrentTab}
                  />
                  <DealCard
                    DataDisplay={DataDisplay}
                    setFormState={setFormState}
                    setfindId={setfindId}
                    setCurrentTab={setCurrentTab}
                    step={step}
                  />
                  <Upload beforeUpload={beforeUpload} uploadLimit={maxUpload} />
                  <Button
                    onClick={() => {
                      try {
                        const res = DealDetailsComponentAdd(
                          datg,
                          DataDisplay,
                          currentTab,
                        );
                        console.log(res);

                        const bodyContent = new FormData();

                        const reader = new FileReader();
                        reader.onload = async (event) => {
                          const arrayBuffer = event.target.result;
                          const blob = new Blob([arrayBuffer], {
                            type: selectedFile.type,
                          });

                          bodyContent.append('file', blob, selectedFile.name);
                          // Append res.Deal directly
                          bodyContent.append('Deal', JSON.stringify(res.Deal));
                          bodyContent.append('details', res.details);

                          console.log(bodyContent);

                          const resp = await PostDealMaster(bodyContent, token);
                          console.log('resp1', resp);
                        };
                        reader.readAsArrayBuffer(selectedFile);
                      } catch (error) {
                        console.error('An error occurred:', error);
                      }
                    }}
                  >
                    GetId jmasn mdf
                  </Button>

                  <input
                    type="file"
                    onChange={(e) => {
                      const file = e.target.files[0]; // Access the first file from the FileList

                      // Access file properties
                      const fileName = file.name;
                      const filePath = URL.createObjectURL(file); // Creates a URL representing the file object
                      const fileSize = file.size;
                      const fileType = file.type;

                      // Log file information
                      console.log('File Name:', fileName);
                      console.log('File Path:', filePath);
                      console.log('File Size:', fileSize, 'bytes');
                      console.log('File Type:', fileType);
                    }}
                  />
                </div>
              );
            case 3:
              return (
                <>
                  {chart && (
                    <Card>
                      {/* <Chart
                                            donutTitle={chart[1][2]}
                                            donutText={'Expired'}
                                            series={chart[1]}
                                            customOptions={{ labels: chart[0] }}
                                            type="donut"
                                            height={150}
                                        /> */}
                      <Chart
                        options={{
                          chart: {
                            stacked: true,
                            toolbar: {
                              show: true,
                            },
                            zoom: {
                              enabled: true,
                            },
                          },
                          colors: COLORS,
                          responsive: [
                            {
                              breakpoint: 480,
                              options: {
                                legend: {
                                  position: 'bottom',
                                  offsetX: -10,
                                  offsetY: 0,
                                },
                              },
                            },
                          ],
                          plotOptions: {
                            bar: {
                              horizontal: false,
                            },
                          },
                          xaxis: {
                            type: 'datetime',
                            categories: [
                              '01/01/2011 GMT',
                              '01/02/2011 GMT',
                              '01/03/2011 GMT',
                              '01/04/2011 GMT',
                              '01/05/2011 GMT',
                              '01/06/2011 GMT',
                            ],
                          },
                          legend: {
                            position: 'right',
                            offsetY: 40,
                          },
                          fill: {
                            opacity: 1,
                          },
                        }}
                        series={[
                          {
                            name: 'PRODUCT A',
                            data: [44, 55, 41, 67, 22, 43],
                          },
                        ]}
                        type="bar"
                        height={300}
                      />
                    </Card>
                  )}
                </>
              );

            default:
              return null;
          }
        })()}

        <StickyFooter
          className="-mx-8 px-8 flex items-center justify-between py-4"
          stickyClass="border-t bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700"
        >
          <div className="md:flex items-center">
            <Button className="mx-2" disabled={step === 0} onClick={onPrevious}>
              Previous
            </Button>

            {step === 1 ? (
              <Button
                disabled={step === 3}
                variant="solid"
                onClick={() => {
                  console.log('DataDisplay.length', DataDisplay.length);
                  if (DataDisplay.length > 0) {
                    onChange(step + 1);
                  } else {
                    openNotification(
                      'Please add atleast one Deal Line!!',
                      'danger',
                    );
                    return;
                  }
                }}
              >
                {step === 3 ? 'Completed' : 'Next'}
              </Button>
            ) : step === 2 ? (
              <Button
                disabled={step === 3}
                variant="solid"
                onClick={() => {
                  onChange(step + 1);
                  const res = DealDetailsComponent(
                    datg,
                    DataDisplay,
                    currentTab,
                  );
                  console.log('btn_currentTab', step);
                  console.log(res);
                }}
              >
                {step === 3 ? 'Completed' : 'Next'}
              </Button>
            ) : (
              <Button
                disabled={step === 2}
                variant="solid"
                // onClick={onNext}
                onClick={() => {
                  if (step === 3) {
                    onFinalSave();
                  } else {
                    onNext();
                  }
                }}
              >
                {step === 3 ? 'Completed' : 'Next'}
              </Button>
            )}
          </div>
          <div className="flex">
            <p className="ml-2 pp">Total Amount = {totalAmount}</p>
            <p className="ml-2 pp">Total Sec = {totalSeconds}</p>
            <p className="ml-2 pp">Total Spot = 0</p>
          </div>
        </StickyFooter>
      </Card>
    </>
  );
});

export default DealMasterAddupload;
