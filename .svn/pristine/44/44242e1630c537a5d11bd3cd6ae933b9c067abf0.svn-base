{"version":3,"file":"static/js/2773.d31804cc.chunk.js","mappings":"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","sources":["views/Scheduling/Scheduler/components/SchedulingArea/components/Toolbar/components/RestoreSavedWorkDialog.js"],"sourcesContent":["import { Button, Dialog, Select } from 'components/ui';\r\nimport { convertDateToYMD } from 'components/validators';\r\nimport { format } from 'date-fns';\r\nimport React, { useContext, useEffect, useState } from 'react';\r\nimport { useSelector } from 'react-redux';\r\nimport {\r\n  apiGetRestoreCommercialScheduling,\r\n  apiGetRestoreDropDown,\r\n  apiGetRestoreScheduling,\r\n  apiGetgetauditfinallogschedulingCom,\r\n} from 'services/SchedulingService';\r\nimport { openNotification } from 'views/Controls/GLOBALFUNACTION';\r\nimport SchedulerContext from 'views/Scheduling/Scheduler/context/SchedulerContext';\r\nimport { operationTypesEnum, pagesEnum } from 'views/Scheduling/Scheduler/enum';\r\n\r\nconst RestoreSavedWorkDialog = ({ isOpen, setIsOpen }) => {\r\n  /* CONTEXT */\r\n  const { page, date, setShowLoader, executeOperation } =\r\n    useContext(SchedulerContext);\r\n\r\n  /* REDUX */\r\n  const channel = useSelector((state) => state.locale.selectedChannel);\r\n\r\n  /* STATES */\r\n  const [restoreSavedList, setRestoreSavedList] = useState([]);\r\n  const [restoreSavedValue, setRestoreSavedValue] = useState({\r\n    value: '',\r\n    label: '',\r\n  });\r\n\r\n  /* USE EFFECTS */\r\n  useEffect(() => {\r\n    if (isOpen) loadVersionList(convertDateToYMD(date));\r\n  }, [channel, isOpen]);\r\n\r\n  /* HELPER FUNCTIONS */\r\n  const getFormName = () => {\r\n    try {\r\n      if (page)\r\n        return page === pagesEnum.PROMO\r\n          ? 'PromoScheduling'\r\n          : page === pagesEnum.SONG\r\n          ? 'SongScheduling'\r\n          : page === pagesEnum.NTC\r\n          ? 'NTCScheduling'\r\n          : 'TransmissionLog';\r\n    } catch (error) {\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  const loadVersionList = async (telecastDate) => {\r\n    try {\r\n      setShowLoader(true);\r\n      let response;\r\n      if (page === pagesEnum.COMMERCIAL) {\r\n        response = await apiGetgetauditfinallogschedulingCom(\r\n          channel,\r\n          telecastDate,\r\n        );\r\n      } else {\r\n        response = await apiGetRestoreDropDown({\r\n          LocationCode: channel.LocationCode,\r\n          ChannelCode: channel.ChannelCode,\r\n          FormName: getFormName(),\r\n          TelecastDate: telecastDate,\r\n        });\r\n      }\r\n      if (response.status === 200) {\r\n        const formattedOptions = response.data?.map((option) => ({\r\n          value: option.D_date.substr(0, 23),\r\n          label: format(new Date(option.D_date), 'dd-MMM-yyyy - HH:mm:ss'),\r\n        }));\r\n        setRestoreSavedList([...formattedOptions]);\r\n      } else if (response.status === 204) {\r\n        openNotification('info', 'Previous version not found.');\r\n        setRestoreSavedList([]);\r\n      }\r\n      setShowLoader(false);\r\n    } catch (errors) {\r\n      openNotification(\r\n        'danger',\r\n        `Something went wrong while fetching previous versions`,\r\n      );\r\n      setShowLoader(false);\r\n    }\r\n  };\r\n\r\n  /* EVENT HANDLERS */\r\n  const handleRestoreClick = async () => {\r\n    try {\r\n      setShowLoader(true);\r\n      let response;\r\n      if (page === pagesEnum.COMMERCIAL) {\r\n        response = await apiGetRestoreCommercialScheduling({\r\n          LocationCode: channel.LocationCode,\r\n          ChannelCode: channel.ChannelCode,\r\n          ScheduleDate: convertDateToYMD(date),\r\n          D_date: restoreSavedValue.value,\r\n        });\r\n      } else {\r\n        response = await apiGetRestoreScheduling({\r\n          LocationCode: channel.LocationCode,\r\n          ChannelCode: channel.ChannelCode,\r\n          FormName: getFormName(),\r\n          TelecastDate: convertDateToYMD(date),\r\n          D_date: restoreSavedValue.value,\r\n        });\r\n      }\r\n      if (response.status === 200) {\r\n        await executeOperation({\r\n          operation: operationTypesEnum.INITIALIZE_SCHEDULER,\r\n          isGenerateLog: false,\r\n          mode: 'Edit',\r\n        });\r\n        openNotification('success', 'Restored previous version successfully.');\r\n      } else if (response.status !== 204) {\r\n        openNotification(\r\n          'danger',\r\n          `Something went wrong while restoring previous version. Server responded with status code ${response.status}`,\r\n        );\r\n      }\r\n      handleClose();\r\n      setShowLoader(false);\r\n    } catch (errors) {\r\n      openNotification(\r\n        'danger',\r\n        'Something went wrong while restoring previous version',\r\n      );\r\n      setShowLoader(false);\r\n    }\r\n  };\r\n\r\n  const handleClose = () => {\r\n    try {\r\n      setRestoreSavedValue({\r\n        value: '',\r\n        label: '',\r\n      });\r\n      setIsOpen(false);\r\n    } catch (error) {\r\n      console.error(error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Dialog isOpen={isOpen} onClose={handleClose} onRequestClose={handleClose}>\r\n      <h5 className=\"mb-4\">Restore Previous Version</h5>\r\n      <p className=\"text-white mb-1\">\r\n        Versions <span className=\"text-red-500\">*</span>\r\n      </p>\r\n      <Select\r\n        placeholder=\"Select\"\r\n        options={restoreSavedList}\r\n        onChange={(e) => setRestoreSavedValue(e)}\r\n        size=\"sm\"\r\n      ></Select>\r\n      <div className=\"text-right mt-6\">\r\n        <Button\r\n          variant=\"solid\"\r\n          disabled={!restoreSavedValue.value}\r\n          onClick={handleRestoreClick}\r\n        >\r\n          Restore\r\n        </Button>\r\n      </div>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default RestoreSavedWorkDialog;\r\n"],"names":["isOpen","setIsOpen","page","date","setShowLoader","executeOperation","useContext","SchedulerContext","channel","useSelector","state","locale","selectedChannel","restoreSavedList","setRestoreSavedList","useState","restoreSavedValue","setRestoreSavedValue","value","label","useEffect","loadVersionList","convertDateToYMD","getFormName","pagesEnum","error","async","response","apiGetgetauditfinallogschedulingCom","telecastDate","apiGetRestoreDropDown","LocationCode","ChannelCode","FormName","TelecastDate","status","formattedOptions","data","map","option","D_date","substr","format","Date","openNotification","errors","handleClose","console","onClose","onRequestClose","className","placeholder","options","onChange","e","size","variant","disabled","onClick","apiGetRestoreCommercialScheduling","ScheduleDate","apiGetRestoreScheduling","operation","operationTypesEnum","isGenerateLog","mode"],"sourceRoot":""}