"use strict";(self.webpackChunkelstar=self.webpackChunkelstar||[]).push([[1196],{44662:(e,t,n)=>{n.d(t,{AK:()=>d,Fq:()=>h,NJ:()=>i,SX:()=>r,Yj:()=>x,al:()=>o,b8:()=>p,iq:()=>c,qf:()=>m,y7:()=>u});var a=n(54048),l=n(46152);const s=n(74569);async function i(e){return l.Z.fetchData({url:"/ntcmaster/?&LocationCode=".concat(e.LocationCode,"&ChannelCode=").concat(e.ChannelCode),method:"get",data:e})}const r=(e,t)=>new Promise(((n,l)=>{let i={method:"post",maxBodyLength:1/0,url:a.Z.apiPrefix+"/ntcmaster/",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},data:e};s.request(i).then((e=>{n(e)})).catch((e=>{l(e)}))})),o=(e,t,n)=>new Promise(((l,i)=>{let r={method:"put",maxBodyLength:1/0,url:a.Z.apiPrefix+"/ntcmaster/"+t,headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},data:e};s.request(r).then((e=>{l(e)})).catch((e=>{i(e)}))}));async function c(e){return l.Z.fetchData({url:"/ntctypemaster/drop/",method:"get",data:e})}async function d(e){return l.Z.fetchData({url:"/ntctypemaster/",method:"get",data:e})}const u=(e,t)=>fetch(a.Z.apiPrefix+"/ntctypemaster/".concat(e.NTCTypeCode),{method:"PUT",headers:{Accept:"application/json",Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({NTCTypeName:e.NTCTypeName,NtcTypeShortName:e.NtcTypeShortName,NTCGroupCode:e.NTCGroupCode,DefaultGAP:e.DefaultGAP,IsActive:e.IsActive})}),m=(e,t)=>fetch(a.Z.apiPrefix+"/ntctypemaster",{method:"POST",headers:{Accept:"application/json",Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({NTCTypeName:e.NTCTypeName,NtcTypeShortName:e.NtcTypeShortName,NTCGroupCode:e.NTCGroupCode,DefaultGAP:e.DefaultGAP,IsActive:e.IsActive})}),h=(e,t)=>fetch(a.Z.apiPrefix+"/ntcgroupmaster/".concat(e.NTCGroupCode),{method:"PUT",headers:{Accept:"application/json",Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({NTCGroupName:e.NTCGroupName,IsActive:e.IsActive})}),x=(e,t)=>fetch(a.Z.apiPrefix+"/ntcgroupmaster",{method:"POST",headers:{Accept:"application/json",Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({NTCGroupName:e.NTCGroupName,IsActive:e.IsActive})});async function p(e){return l.Z.fetchData({url:"/ntcgroupmaster/",method:"get",data:e})}},44630:(e,t,n)=>{n.d(t,{Z:()=>l});var a=n(72791);const l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3e3;const[t,n]=(0,a.useState)("");return(0,a.useEffect)((()=>{if(t){let t=setTimeout((()=>n("")),e);return()=>{clearTimeout(t)}}}),[t]),[t,n]}},70178:(e,t,n)=>{n.d(t,{F:()=>l,V:()=>s});var a=n(64802);n(81320);const l=e=>{if(!Array.isArray(e))return void console.error("Data is not an array.");const t=e.map((e=>Object.values(e).join(","))).join("\n"),n=new Blob([t],{type:"text/csv;charset=utf-8"});(0,a.saveAs)(n,"PlayList.csv")},s=(e,t)=>{if(!Array.isArray(e))return void console.error("Data is not an array.");const n=e.map((e=>Object.values(e).join(","))).join("\n"),l=new Blob([n],{type:"text/csv;charset=utf-8"});(0,a.saveAs)(l,"".concat(t,".csv"))}},70291:(e,t,n)=>{n.r(t),n.d(t,{default:()=>ie});var a=n(72791),l=n(81721),s=n(2803),i=n(11308),r=n(60364),o=n(54748),c=n(60488),d=n(87350),u=n(9494),m=n(45987),h=n(1413),x=n(28536),p=n(46657),C=(n(88081),n(58617)),f=n(85880),g=n(79577),S=n(59856),j=n(25146),b=n(4489),v=n(81320),y=n(59054),N=n(37083),_=n(44630),T=n(44662),D=n(1063),w=n(33792),k=n(80184);const P=e=>{let{BreakwiseData:t}=e;return(0,k.jsx)("div",{style:{width:"100%"},children:(0,k.jsx)("div",{style:{height:"335px",overflow:"auto"},children:(0,k.jsx)(s.Bl,{children:(0,k.jsxs)(w.i,{value:t,resizableColumns:!0,showGridlines:!0,rowClassName:e=>(e.parent,"subrow"),children:[(0,k.jsx)(D.s,{style:{width:"200px",maxWidth:"200px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",background:"#111827",color:"white",fontSize:"13px"},field:"Event_Name",header:"Event Name",expander:!0}),(0,k.jsx)(D.s,{style:{width:"40px",maxWidth:"80px",background:"#111827",color:"white",fontSize:"13px",textAlign:"right"},field:"BreakNumber",header:"BK"}),(0,k.jsx)(D.s,{style:{width:"60px",maxWidth:"100px",background:"#111827",color:"white",fontSize:"13px",textAlign:"right"},field:"totalCMDuration",header:"CM"})]})})})})};var F=n(78971),E=n(36064),I=(n(70178),n(84373)),B=n(81694),z=n.n(B),Z=n(78820),R=n(21550),M=n(91323);function A(e,t){const n=(0,M.Q)(e),a=(0,M.Q)(t);return n.getTime()>a.getTime()}function q(e,t){return+(0,M.Q)(e)<+(0,M.Q)(t)}var O=n(43235),L=n(45682),G=n(39126);const H=["FPC_Time","Event_Name","FPC_ID","BreakNumber","Duration","F_C_S_P"],K=["header"],{Tr:V,Th:W,Td:Q,THead:U,TBody:J}=s.iA;var Y=[{header:"Type",name:"TxLogCode",code:"TxLogCode",width:"auto",ScreenType:"CommercialScheduling",Sequence:1,isvisible:!0},{header:"Event_Name",name:"Event_Name",code:"Event_Name",width:"auto",ScreenType:"CommercialScheduling",Sequence:1,isvisible:!0},{header:"PlayTime",name:"Start_Time",code:"Start_Time",width:"auto",ScreenType:"CommercialScheduling",Sequence:1,isvisible:!0},{header:"Duration",name:"Duration",code:"Duration",width:"auto",ScreenType:"CommercialScheduling",Sequence:1,isvisible:!0}],X=[{header:"Type",name:"TxLogCode",code:"TxLogCode",width:"auto",ScreenType:"CommercialScheduling",Sequence:1,isvisible:!0},{header:"Event_Name",name:"Event_Name",code:"Event_Name",width:"auto",ScreenType:"CommercialScheduling",Sequence:1,isvisible:!0},{header:"PlayTime",name:"Start_Time",code:"Start_Time",width:"auto",ScreenType:"CommercialScheduling",Sequence:1,isvisible:!0},{header:"Duration",name:"Duration",code:"Duration",width:"auto",ScreenType:"CommercialScheduling",Sequence:1,isvisible:!0}];const $=[{value:1,label:"Promos",shortcode:"PR"},{value:2,label:"Songs",shortcode:"SG"},{value:3,label:"NTCs",shortcode:"NTC"},{value:4,label:"Last Min Spot",shortcode:"N"},{value:6,label:"Drop Spot",shortcode:"CM"},{value:7,label:"Programs",shortcode:"S"}],ee=e=>{let{table1Data:t,setTable1Data:n,cities:D,setcities:w,Columnright:B,setColumnright:M,table2Data:ee,setTable2Data:ne,table3Data:ae,setTable3Data:le,fpcTimes:se,value:ie,value2:re,setValue:oe,breaknumbers:ce,setbreaknumbers:de,Columnleft:ue,setColumnleft:me,onCellSelect:he,evendata:xe,setheadername:pe}=e;console.log("table2Data",ee);const Ce=(0,r.useSelector)((e=>e.locale.selectedChannel)),fe=(0,r.useSelector)((e=>e.locale.dateForm));console.log();const[ge,Se]=(0,a.useState)([]),[je,be]=(0,a.useState)(),[ve,ye]=(0,a.useState)(0),[Ne,_e]=(0,a.useState)(0),[Te,De]=(0,a.useState)(!1),[we,ke]=(0,a.useState)([]),[Pe,Fe]=(0,a.useState)([]),[Ee,Ie]=(0,a.useState)([]),[Be,ze]=(0,a.useState)([]);(0,a.useEffect)((()=>(ma((0,E.rh)([ie,"Commercial Scheduling"])),pe(""),()=>{pe("Commercial Scheduling")})),[]),(0,a.useEffect)((()=>{let e=(0,c.a1)(t,!0,!1);n(e)}),[]),(0,a.useEffect)((()=>{Ze()}),[t]);const Ze=async()=>{try{const n=await(0,u.apiCallstoreprocedure)("USP_Sch_Commercial_scheduling_Counts",{par_ChannelCode:Ce.ChannelCode,par_LocationCode:Ce.LocationCode,par_TelecastDate:(0,o.Tk)(fe[0])});var e,t;if(ke(n.data),n.data.length>1)ye(null===(e=n.data[3])||void 0===e?void 0:e.FieldValue),_e(null===(t=n.data[4])||void 0===t?void 0:t.FieldValue)}catch(n){console.error("API call failed:",n)}},Re=()=>{let e=[];t.forEach((t=>{if("CM"===t.F_C_S_P){const n=(0,R.Qc)(t.Tel_Time,"HH:mm:ss:SS",new Date),a=t.SpotStartTime?(0,R.Qc)(t.SpotStartTime,"HH:mm:ss",new Date):null,l=t.SpotEndTime?(0,R.Qc)(t.SpotEndTime,"HH:mm:ss",new Date):null;if(a&&l){if(!(A(n,a)&&q(n,l))){const n=(0,h.Z)((0,h.Z)({},t),{},{TxLogCode:"Out of RODP"});e.push(n)}}else{const n=(0,h.Z)((0,h.Z)({},t),{},{TxLogCode:"Out of RODP"});e.push(n)}}})),console.log(e),sa(e)};function Me(e,t){const n=[];for(let a=0;a<e.length;a++)e[a].FPC_ID===t&&n.push(a);return n}const[Ae,qe]=(0,a.useState)([]),[Oe,Le]=(0,a.useState)([]),[Ge,He]=(0,a.useState)(!1),[Ke,Ve]=(0,a.useState)(!1),[We,Qe]=(0,a.useState)(!0),[Ue,Je]=(0,a.useState)(!1),[Ye,Xe]=(0,a.useState)([]),[$e,et]=(0,a.useState)(null),[tt,nt]=(0,a.useState)(null),[at,lt]=(0,a.useState)(!1),[st,it]=(0,a.useState)(!1),[rt,ot]=(0,a.useState)([]),[ct,dt]=(0,a.useState)([]),[ut,mt]=(0,a.useState)({NTC:[],Promos:[],Songs:[],Commercial:[],Programs:[]}),[ht,xt]=(0,a.useState)([...t]),[pt,Ct]=(0,a.useState)(!1),[ft,gt]=(0,a.useState)(0),[St,jt]=(0,a.useState)(),[bt,vt]=(0,a.useState)([{columnName:"",filterValue:"",filterOption:"contains"}]),yt=(0,a.useRef)(null);const Nt=(0,a.useRef)(null),_t=(0,a.useRef)(0),Tt=[];Tt[0]=(0,a.useRef)(null),Tt[1]=(0,a.useRef)(null),Tt[2]=(0,a.useRef)(null),Tt[3]=(0,a.useRef)(null),Tt[4]=(0,a.useRef)(null),Tt[5]=(0,a.useRef)(null),Tt[6]=(0,a.useRef)(null),Tt[7]=(0,a.useRef)(null),Tt[8]=(0,a.useRef)(null),Tt[9]=(0,a.useRef)(null),Tt[10]=(0,a.useRef)(null);const Dt=(0,a.useRef)(null),wt=(e,t)=>{Gn(t,e)},kt=async()=>{if(t.filter(((e,t)=>tn.includes(t)&&"CM"!==e.F_C_S_P)).length>0)return void wt("Kindly Select only Commercial.","warning");let e=t.filter(((e,t)=>tn.includes(t))).map((e=>e.BookingDetailID)).map((e=>({Id:e})));Pt(e,"E").then((e=>{if(e){let e=t.filter(((e,t)=>!tn.includes(t))),a=(0,c.a1)(e,!0,at);n(a);const l=t.filter(((e,t)=>tn.includes(t))),s=[...ee,l[0]];ne(s),nn([])}})).catch((e=>{console.error("Error updating booking status:",e)}))},Pt=async(e,t)=>{try{if(200==(await(0,d.pp)(e,t,Mn)).status)return!0}catch(n){return!1}},[Ft,Et]=(0,a.useState)(!1),[It,Bt]=(0,a.useState)(!1),[zt,Zt]=(0,a.useState)(!1),[Rt,Mt]=(0,a.useState)(!1),[At,qt]=(0,a.useState)(!1),[Ot,Lt]=(0,a.useState)(!1),Gt=e=>{Et(!1)},Ht=e=>{Bt(!1)},[Kt,Vt]=(0,a.useState)([]),[Wt,Qt]=(0,a.useState)(!0),[Ut,Jt]=(0,a.useState)("Maximize"),[Yt,Xt]=(0,a.useState)(""),[$t,en]=(0,a.useState)(!1),[tn,nn]=(0,a.useState)([]),[an,ln]=(0,a.useState)([0]),[sn,rn]=(0,a.useState)([]),[on,cn]=(0,a.useState)([]),[dn,un]=(0,a.useState)([]),[mn,hn]=(0,a.useState)(null),[xn,pn]=(0,a.useState)([]),[Cn,fn]=(0,a.useState)(!1),[gn,Sn]=(0,a.useState)(!1),[jn,bn]=(0,a.useState)(!1),[vn,yn]=(0,a.useState)(!1),[Nn,_n]=(0,a.useState)([]),[Tn,Dn]=(0,a.useState)(!1),[wn,kn]=(0,a.useState)(!1),[Pn,Fn]=(0,a.useState)(!1),[En,In]=(0,a.useState)([]),[Bn,zn]=(0,a.useState)(null),[Zn,Rn]=(0,a.useState)(null),Mn=(0,r.useSelector)((e=>e.auth.session.token)),An=[{label:"Cut",icon:"pi pi-fw pi-search",command:()=>{Hn(),fn(!1)}},{label:"Paste",icon:"pi pi-fw pi-search",command:()=>{Kn()}},{label:"Rotation Info",icon:"pi pi-fw pi-info-circle",command:()=>{On()}},{label:"Remove",icon:"pi pi-fw pi-trash",command:()=>{Yn()}}];function qn(e){!function(e){var t=[],n="",a="",l="";let s=0;t=[];for(let r=0;r<e.length;r++)if("CT"===e[r].F_C_S_P){n=e[r].FPC_Time,a=e[r].FPC_TimeTo,r;var i=e.slice(r+1,e.length).find((e=>"CT"===e.F_C_S_P));null!==i&&void 0!==i||(i=e[e.length-2]),i&&(l=e.indexOf(i),t.push({StartTime:n,EndTime:a,PlayTime:e[l+1].Start_Time,Diffrance:(0,v.parseDuration)(e[l+1].Start_Time)-(0,v.parseDuration)(a+":00:00"),columnIndex:s+1}),s+=1)}ot(t)}(e);const t=e.reduce(((e,t)=>{const{FPC_Time:n,Event_Name:a,FPC_ID:l,BreakNumber:s,Duration:i,F_C_S_P:r}=t,o=((0,m.Z)(t,H),e.find((e=>e.FPC_ID===l)));if(o){const e=o.data.find((e=>e.BreakNumber===s));e?"PR"===r?(void 0===e.totalDuration&&(e.totalDuration=0),e.totalDuration+=(0,v.parseDuration)(i)):"NTC"===r?(void 0===e.totalNTCCount&&(e.totalNTCCount=0),e.totalNTCCount+=1):"SG"===r?(void 0===e.totalSGDuration&&(e.totalSGDuration=0),e.totalSGDuration+=(0,v.parseDuration)(i)):"CM"===r?(void 0===e.totalCMDuration&&(e.totalCMDuration=0),e.totalCMDuration+=(0,v.parseDuration)(i)):(e.totalDuration+=0,e.totalSGDuration+=0,e.totalNTCCount+=0,e.totalCMDuration+=0):o.data.push({BreakNumber:s,totalDuration:"PR"===r?(0,v.parseDuration)(i):0,totalNTCCount:"NTC"===r?1:0,totalSGDuration:"SG"===r?(0,v.parseDuration)(i):0,totalCMDuration:"CM"===r?(0,v.parseDuration)(i):0})}else e.push({FPC_Time:n,FPC_ID:l,Event_Name:a,data:[{BreakNumber:s,totalDuration:"PR"===r?(0,v.parseDuration)(i):0,totalNTCCount:"NTC"===r?1:0,totalSGDuration:"SG"===r?(0,v.parseDuration)(i):0,totalCMDuration:"CM"===r?(0,v.parseDuration)(i):0}]});return e}),[]);console.log("groupedData",t);t.map((e=>{const t=e.data.reduce(((e,t)=>e+t.totalDuration),0),n=e.data.reduce(((e,t)=>e+t.totalSGDuration),0),a=e.data.reduce(((e,t)=>e+t.totalCMDuration),0);return{FPC_Time:e.FPC_Time,totalDuration:Math.round(t),totalSGDuration:Math.round(n),totalCMDuration:Math.round(a)}})).map((e=>{const t=Object.keys(se).find((t=>se[t]===e.FPC_Time));return t?(0,h.Z)((0,h.Z)({},e),{},{columnIndex:t}):e}));console.log("lets",t);const n=t.map((e=>{const t=e.data.map((t=>({key:"".concat(e.FPC_ID,"-").concat(t.BreakNumber),label:"BreakNumber",icon:"pi pi-fw pi-file",data:{BreakNumber:t.BreakNumber,totalDuration:t.totalDuration,totalSGDuration:t.totalSGDuration,totalCMDuration:t.totalCMDuration}}))),n=t.reduce(((e,t)=>e+t.data.totalDuration),0),a=t.reduce(((e,t)=>e+t.data.totalSGDuration),0),l=t.reduce(((e,t)=>e+t.data.totalCMDuration),0);return{key:"".concat(e.FPC_ID),label:"Event_Name",icon:"pi pi-fw pi-cog",data:{Event_Name:"[".concat(e.FPC_Time,"] ").concat(e.Event_Name),BreakNumber:t.length,totalDuration:n,totalSGDuration:a,totalCMDuration:l,FPC_Time:e.FPC_Time},children:t}}));console.log("transformedData",n),_n(n)}const On=()=>{let e=t.filter(((e,t)=>"CM"===e.F_C_S_P));le([...e])},Ln=async()=>{De(!0);const e=t.filter((e=>"CM"===e.F_C_S_P)).map(((e,t)=>({Id:e.BookingDetailID,BreakNumber:null!=e.BreakNumber?e.BreakNumber:0,ContentCode:e.ContentCode,logged:1,BookingStatus:"B",SpotPositionNumber:t+1,ScheduleTime:e.ScheduleTime})));try{const t=await(0,d.CY)(e,Mn);if(200==t.status&&(Gn("success","Data Saved Successfully."),De(!1)),204===t.status)return Gn("danger","Data Already Exists."),void De(!1)}catch(n){500==n.response.status&&(Gn("danger","Server Error."),De(!1))}De(!1)},Gn=(e,t)=>{s.Am.push((0,k.jsx)(s.P_,{title:e,type:e,children:t}))},Hn=()=>{fn(!1);let e=t.filter(((e,t)=>tn.includes(t)));pn(e),cn([...tn])},Kn=()=>{const e=xn.filter((e=>"CM"===e.F_C_S_P));if(e.length<=0)return;let a=t.slice(0,mn+1),l=t.slice(mn+1,t.length),s=t[mn];const i=[...a,...(0,c.yw)(e,s),...l];n(Cn?i:i.filter(((e,t)=>!on.includes(t)))),nn([]),fn(!1)};function Vn(e,t,n,a){Wn(e,t,n,a);let l=0;const s=e.slice(n,a);return console.log("filterdata",s),s.forEach((e=>{e.F_C_S_P===t&&(l+=(0,v.parseDuration)(e.Duration))})),(0,v.formatDurationHHMMSSFF)(l)}function Wn(e,t,n,a){const l=e.slice(n,a);let s=0;l.forEach((e=>{const t=e.BreakNumber;t>s&&(s=t)})),console.log("maxBreakNumber",s);let i=Array.from({length:s},((e,t)=>({BreakNumber:t+1,TotalDurationByBreak:0})));return l.forEach((e=>{if(e.F_C_S_P===t){const t=e.BreakNumber,n=(0,v.parseDuration)(e.Duration);t>0&&t<=i.length?i[t-1].TotalDurationByBreak+=n:console.error("Invalid breakNumber: ".concat(t))}})),i.map((e=>({BreakNumber:e.BreakNumber,TotalDurationByBreak:(0,v.formatDurationHHMMSSFF)(e.TotalDurationByBreak),TotalDurationByBreakint:e.TotalDurationByBreak})))}function Qn(e,t){console.log("draggedRows",e),console.log("referencerow",t);const n=e=>{const[t,n,a,l]=e.split(":").map(Number);return 3600*t+60*n+a+l/24};return(Array.isArray(e)?e:[e]).every((e=>{if(null==e.SpotStartTime)return e.ContentCode==t.ContentCode||((0,v.openNotification)("danger","Kindly Schedule in Same Program.","BATS"),!1);const a=n(e.SpotStartTime+":00"),l=n(e.SpotEndTime+":00"),s=n(t.Tel_Time+":00");return a<=s&&l>=s||((0,v.openNotification)("danger","Out of TimeBand","BATS"),!1)}))}function Un(e,t){if(e>t){let n=e;e=t,t=n}const n=t-e+1,a=Array(n).fill(0);for(let l=0;l<n;l++)a[l]=e+l;return a}function Jn(){let e=dn.map((e=>ee[e])),a=tn[0],l=t[a];const s=(0,c.yw)(e,l);const i=[...t.slice(0,a+1),...s,...t.slice(a+1,t.length)];n(i)}function Yn(){if(t.filter(((e,t)=>tn.includes(t)&&"PR"!==e.F_C_S_P&&"SG"!==e.F_C_S_P&&"NTC"!==e.F_C_S_P)).length>0)return void wt("Kindly Select only Promo/Song.","warning");let e=t.filter(((e,t)=>!tn.includes(t))),a=(0,c.a1)(e,!0,at);n(a),nn([])}(0,a.useEffect)((()=>{(0,c.SE)();const e=document.getElementsByClassName("Gbox2")[0],t=document.getElementsByClassName("Gbox2")[0].children[1];return e&&(e.style.display="block",t.style.display="block"),()=>{e&&(e.style.display="none",t.style.display="none")}}),[]),console.log("startTimeArray",rt),(0,a.useEffect)((()=>{const e=tn.filter(((e,n)=>{console.log("row",e);return"NTC"===t[e+1].F_C_S_P}));ln(e);const n=t.filter(((e,t)=>"NTC"===e.F_C_S_P&&tn.some((e=>t===e+1))));console.log("SelNTCRow",n);const a=t.filter(((e,t)=>tn.includes(t)));let l=!0;a[0]&&"NTC"===a[0].F_C_S_P&&(l=!1);const s=new Set(a.map((e=>e.PrimaryID)));let i=t.map(((e,t)=>{if(s.has(e.PrimaryID))return t})).filter((e=>void 0!==e));l?i.length!=tn.length&&nn(i):i=tn;const r=t.filter(((e,t)=>i.includes(t)&&"CM"===e.F_C_S_P)),o=r.reduce(((e,t)=>e+(0,v.parseDuration)(t.Duration)),0);console.log("SelRowwithNTCIndexsumOfDuration",o),nt((0,v.formatDurationHHMMSSFF)(o));const c=i[0],d=t.slice(0,t.findIndex(((e,t)=>t===c))).reverse().find((e=>"CT"===e.F_C_S_P)),u=t.slice(t.indexOf(d)+1,t.length).find((e=>"CT"===e.F_C_S_P)),m=Vn(t,"S",t.indexOf(d),t.indexOf(u)),h=Vn(t,"CM",t.indexOf(d),t.indexOf(u));let x=Wn(t,"CM",t.indexOf(d),t.indexOf(u));console.log("CommercialDurationBrkWise*",x),In([x]),kn(m),Fn(h),et(r.length),console.log(d),console.log(u);var p=[];if(void 0!==u&&void 0!==d){let e=d.FPC_Time,n=d.FPC_TimeTo,a=u.Tel_Time;p.push([e,n,a.substring(0,5),d.Event_Name]);const l=t.slice(t.indexOf(u)+1,t.length).find((e=>"CT"===e.F_C_S_P));console.log("nearest2NextbelowCTRow",l);if(void 0!==l){let e=u.FPC_Time,n=u.FPC_TimeTo,a=l.Tel_Time;p.push([e,n,a.substring(0,5),u.Event_Name]),t.slice(t.indexOf(l)+1,t.length).find((e=>"CT"===e.F_C_S_P))}}let C=[...new Set(p)];console.log("unique",C),ze(C)}),[tn]),(0,a.useEffect)((()=>{let e=ua(t);n(e),Qa(e)}),[]);const[Xn,$n]=(0,a.useState)(0),[ea,ta]=(0,a.useState)(0),[na,aa]=(0,a.useState)([]),[la,sa]=(0,a.useState)([]),[ia,ra]=(0,a.useState)([null,null]),[oa,ca]=(0,a.useState)({});function da(e){const t=$.find((t=>t.shortcode===e));return t?t.label:e}function ua(e){let t=0;const n=[];return e.forEach((e=>{"NTC"!==e.F_C_S_P&&t++;const a=(0,h.Z)((0,h.Z)({},e),{},{PrimaryID:t});n.push(a)})),n}(0,a.useEffect)((()=>{console.log("table1Data 1552 table1Data 1552 table1Data 1552 table1Data 1552"),Ge||Ke?_t.current>1&&(Ge&&He(!1),Ke&&Ve(!1)):(_t.current++,Vt([...Kt,t])),(e=>{const t=e.filter((e=>"S"===e.F_C_S_P)),n=e.filter((e=>"PR"===e.F_C_S_P)),a=e.filter((e=>"SG"===e.F_C_S_P)),l=e.filter((e=>"CM"===e.F_C_S_P)),s=e.filter((e=>"CT"===e.F_C_S_P));mt({NTC:[],Promos:[],Songs:[],Commercial:[],Programs:[]}),mt((e=>(0,h.Z)((0,h.Z)({},e),{},{NTC:[...e.NTC,...t],Promos:[...e.Promos,...n],Songs:[...e.Songs,...a],Commercial:[...e.Commercial,...l],Programs:[...e.Programs,...s]})))})(t);var e=t.reduce(((e,t)=>{const n=t.F_C_S_P;return"CT"!==t.F_C_S_P&&(e[n]||(e[n]={F_C_S_P:n,sumDuration:0,colors:t.EventDefaultBackColor}),e[n].sumDuration+=(0,v.parseDuration)(t.Duration)),e}),{});dt(Object.values(e).map((e=>({label:da(e.F_C_S_P),value:e.sumDuration,color:e.colors})))),qn(t);const n=t.filter((e=>"CM"===e.F_C_S_P)).filter((e=>e.TxLogCode));console.log("table1Data00p",n),aa(n);const a=n.length;$n(a);ca((e=>{const n={},a=new Set;t.forEach((e=>{const{EventDefaultBackColor:t,F_C_S_P:l,Event_Name:s}=e;s&&a.add(s),n[l]||(n[l]=t)}));const l=Array.from(a).length;return console.log("colorMapping",l),ta(l),n})()),Re()}),[t]);const ma=(0,r.useDispatch)();(0,a.useEffect)((()=>{console.log("table1Datappppp",t),ma((0,F.t)(t)),ma((0,F.BC)((new Date).toLocaleString())),ma((0,F.Cd)(ie))}),[t]),(0,a.useEffect)((()=>{console.log("Columnright Columnright1612 ",D);const e=D.filter((e=>!B.some((t=>t.code===e.code))));qe(e)}),[B]);const ha=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>{t.forEach((t=>{"function"===typeof t?t(e):t&&(t.current=e)}))}},[xa,pa]=(0,a.useState)(null),[Ca,fa]=(0,a.useState)(""),ga=(e,t)=>{if("he"==St){const n=[...Ae];n[e].header=t,qe(n)}if("she"==St){const n=[...Oe];n[e].header=t,Le(n)}};console.log(at,"---",ft),console.log(t);const Sa=()=>{const e=[{header:"FPC Time",name:"FPC_Time",code:"FPC_Time",width:"auto",ScreenType:"Commercial Scheduling",Sequence:1,isvisible:!0},{header:"Play Time",name:"Start_Time",code:"Start_Time",width:"auto",ScreenType:"Song",Sequence:1,isvisible:!0},{header:"Event Name",name:"Event_Name",code:"Event_Name",width:"auto",ScreenType:"Commercial Scheduling",Sequence:1,isvisible:!0}],t=B.filter((t=>!e.some((e=>e.name===t.name))));return(0,k.jsxs)("div",{className:"grid grid-cols-2 gap-4",style:{background:"transparent"},children:["he"==St&&(0,k.jsx)(s.Zb,{header:(0,k.jsx)("p",{style:{fontSize:"16px"},children:"Visible"}),children:null!=B&&(0,k.jsx)(x.Z5,{onDragEnd:n=>{if(!n.destination)return;let a=n.source.index,l=n.destination.index;if(a>l){let e=a;a=l,l=e}let s=t[a];const i=[...t.slice(0,a),...t.slice(a+1,l+1),s,...t.slice(l+1,t.length)];console.log("updatedTable1Data********",i),M([...e,...i])},children:(0,k.jsx)(x.bK,{droppableId:"list",children:n=>(0,k.jsxs)("div",(0,h.Z)((0,h.Z)({ref:n.innerRef},n.droppableProps),{},{children:[e.map(((e,t)=>(0,k.jsx)("div",{className:"flex",children:e.header},e.name))),t.map(((n,a)=>(0,k.jsx)(x._l,{draggableId:"item-".concat(n.name),index:a,children:a=>(0,k.jsx)("div",(0,h.Z)((0,h.Z)((0,h.Z)({ref:a.innerRef},a.draggableProps),a.dragHandleProps),{},{children:(0,k.jsxs)("div",{className:"flex",children:[(0,k.jsx)("i",{className:"pi pi-bars mr-2",onClick:()=>{let a=t.filter((e=>e.name!=n.name));console.log("setColumnright",a),M([...e,...a])}}),(0,k.jsx)("i",{className:"pi pi-minus-circle mr-2",onClick:()=>{let a=t.filter((e=>e.name!=n.name));M([...e,...a])}}),n.header]})}))},n.name))),n.placeholder]}))})})}),"she"==St&&(0,k.jsx)(s.Zb,{header:(0,k.jsx)("p",{style:{fontSize:"16px"},children:"Visible"}),children:null!=ue&&(0,k.jsx)(x.Z5,{onDragEnd:e=>{if(!e.destination)return;let t=e.source.index,n=e.destination.index;if(t>n){let e=t;t=n,n=e}let a=ue[t];const l=[...ue.slice(0,t),...ue.slice(t+1,n+1),a,...ue.slice(n+1,ue.length)];me(l)},children:(0,k.jsx)(x.bK,{droppableId:"list",children:e=>(0,k.jsxs)("div",(0,h.Z)((0,h.Z)({ref:e.innerRef},e.droppableProps),{},{children:[ue.map(((e,t)=>(0,k.jsx)(x._l,{draggableId:"item-".concat(e.name),index:t,children:t=>(0,k.jsx)("div",(0,h.Z)((0,h.Z)((0,h.Z)({ref:t.innerRef},t.draggableProps),t.dragHandleProps),{},{children:(0,k.jsxs)("div",{className:"flex",children:[(0,k.jsx)("i",{className:"pi pi-bars mr-2",onClick:()=>{let t=ue.filter((t=>t.name!=e.name));me(t)}}),ue.length<4?(0,k.jsx)("i",{className:"pi pi-minus-circle mr-2"}):(0,k.jsx)("i",{className:"pi pi-minus-circle mr-2",onClick:()=>{let t=ue.filter((t=>t.name!=e.name));me(t)}}),e.header]})}))},e.name))),e.placeholder]}))})})}),"he"==St&&(0,k.jsx)(s.Zb,{header:(0,k.jsx)("p",{style:{fontSize:"16px"},children:"Hidden"}),children:Ae.map(((e,t)=>(0,k.jsxs)(k.Fragment,{children:[" ",(0,k.jsxs)("div",{children:[(0,k.jsx)("i",{className:"pi pi-plus-circle mr-2",onClick:()=>{let t=Ae.filter((t=>t.name!=e.name));qe(t),M([e,...B])}}),(0,k.jsx)("span",{onClick:()=>{pa(t),fa("")},children:e.header})]},t),xa===t&&(0,k.jsxs)("div",{className:"flex",style:{marginBottom:"10px",marginTop:"10px"},children:[(0,k.jsx)("input",{style:{color:"black",borderRadius:"5px",padding:"5px",height:"35px",width:"150px",background:"transparent",border:"1px solid gray"},placeholder:"Header name",onBlur:e=>{fa(e.target.value)}}),"\xa0",(0,k.jsx)(s.zx,{shape:"circle",variant:"plain",size:"xs",style:{padding:"5px",marginTop:"3px"},onClick:()=>{Ca.length;Ca.length>0&&(ga(t,Ca),pa(null))},icon:(0,k.jsx)(f.Dey,{})}),"\xa0",(0,k.jsx)(s.zx,{shape:"circle",variant:"plain",size:"xs",style:{padding:"5px",marginTop:"3px"},onClick:()=>{pa(null)},icon:(0,k.jsx)(f.Fk5,{})})]})]})))}),"she"==St&&(0,k.jsx)(s.Zb,{header:(0,k.jsx)("p",{style:{fontSize:"16px"},children:"Hidden"}),children:Oe.map(((e,t)=>(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("i",{className:"pi pi-plus-circle mr-2",onClick:()=>{let t=Oe.filter((t=>t.name!=e.name));ue.length>2&&(Le(t),me([e,...ue]))}}),(0,k.jsx)("span",{onClick:()=>{pa(t),fa("")},children:e.header})]},t),xa===t&&(0,k.jsxs)("div",{className:"flex",style:{marginBottom:"10px",marginTop:"10px"},children:[(0,k.jsx)("input",{style:{color:"black",borderRadius:"5px",padding:"5px",height:"35px",width:"150px",background:"transparent",border:"1px solid gray"},placeholder:"Header name",onBlur:e=>{fa(e.target.value)}}),"\xa0",(0,k.jsx)(s.zx,{shape:"circle",variant:"plain",size:"xs",style:{padding:"5px",marginTop:"3px"},onClick:()=>{Ca.length;Ca.length>0&&(ga(t,Ca),pa(null))},icon:(0,k.jsx)(f.Dey,{})}),"\xa0",(0,k.jsx)(s.zx,{shape:"circle",variant:"plain",size:"xs",style:{padding:"5px",marginTop:"3px"},onClick:()=>{pa(null)},icon:(0,k.jsx)(f.Fk5,{})})]})]})))})]})},[ja,ba]=(0,a.useState)([{value:0,label:"All"}]),[va,ya]=(0,a.useState)([]),[Na,_a]=(0,a.useState)(0),[Ta,Da]=(0,a.useState)(),[wa,ka]=(0,a.useState)(1);(0,a.useEffect)((()=>{Fa(Ce,(0,o.Tk)(ie)),(async()=>{let e={};e.LocationCode=re.LocationCode,e.ChannelCode=re.ChannelCode;let t=(0,o.Tk)(ie);(0,d.sb)(e,t).then((e=>{e.data,ne(e.data)}))})()}),[]);(0,r.useSelector)((e=>e.auth.session.LoginId));const Pa=async e=>{if(2==e){var t=[{value:1,label:"All"},{value:-2,label:"Not Used Last 2 Days"},{value:-1,label:"Frequntly used in 7 Days"}];const e=(await(0,i.bD)()).data.map((e=>({value:e.SongCategoryCode,label:e.SongCategoryName})));ba([...t,...e])}if(3==e){t=[{value:1,label:"All"}];const e=(await(0,T.iq)()).data.map((e=>({value:e.NTCTypeCode,label:e.NTCTypeName})));ba([...t,...e])}},Fa=async(e,t)=>{const n=(await(0,d.f7)(e,t)).data.map((e=>({value:e.D_date,label:e.D_date})));console.log(n),ya([...n])},Ea=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(console.log("selectedEventType",wa),0==n&&(n=wa),console.log("vselectedEventType",n),1==n){let t={ChannelCode:Ce.ChannelCode,LocationCode:Ce.LocationCode,TelecastDate:(0,o.Tk)(ie),Mode:e};(0,u.apiCallstoreprocedure)("USP_Sch_Commercial_scheduling",t).then((e=>e.data)).then((e=>{ne(e),console.log("setTable2DataCopy*",e);let t=Object.keys(e[0]).map((e=>{let t={};return t.name=e,t.code=e,t.width=100,t.header=e,t}));console.log("setTable2DataCopy",e),Je(e);const n=t.filter((e=>!ue.some((t=>t.code===e.code))));Le(n)}))}},Ia=()=>{},[Ba,za]=(0,_.Z)(),[Za,Ra]=(0,a.useState)(""),Ma=(0,k.jsxs)("div",{children:[(0,k.jsx)(s.zx,{size:"sm",icon:(0,k.jsx)(f.Fk5,{}),onClick:()=>yn(!1),children:"Cancel"}),(0,k.jsx)(s.zx,{variant:"solid",icon:(0,k.jsx)(f.Dey,{style:{marginTop:"2px"}}),onClick:()=>{yn(!1),"he"==St&&(async()=>{const e=B.map(((e,t)=>({ScreenName:"Commercial Scheduling",ColumnName:e.code,Header:e.header,SequenceNo:t,IsVisible:1})));if(e.length>4)try{const t=await(0,d.nR)(e,Mn);if(200===t.status)return Ra("success"),void za("Data Inserted Successfully.");if(204===t.status)Gn("danger","Data Already Exists.")}catch(t){if(500===t.response.status)return Ra("error"),void za("Server Error.")}else Ra("danger"),za("Kindly Select Aleast 5 Columns")})(),"she"==St&&(async()=>{const e=ue.map(((e,t)=>({ScreenName:"CommercialSchedulingLeft",ColumnName:e.code,Header:e.header,SequenceNo:t,IsVisible:1})));if(e.length>2)try{const t=await(0,d.nR)(e,Mn);if(200===t.status)return Ra("success"),void za("Data Inserted Successfully.");if(204===t.status)Gn("danger","Data Already Exists.")}catch(t){if(500===t.response.status)return Ra("error"),void za("Server Error.")}else Ra("danger"),za("Kindly Select Aleast 2 Columns")})()},autoFocus:!0,size:"sm",children:"Save\xa0\xa0"})]}),[Aa,qa]=(0,a.useState)([]);(0,a.useEffect)((()=>{qa([]);for(let e=1;e<t.length;e++){const n=t[e];if("NTC"===n.F_C_S_P){const a=t[e-1];"S"===a.F_C_S_P&&a.Start_Time<n.OffsetStartTime&&qa((t=>[...t,(0,h.Z)((0,h.Z)({},n),{},{index:e})]))}}}),[t]);const Oa=e=>{const t="".concat(e.className," justify-content-space-between items-center");return(0,k.jsx)("div",{className:t,children:(0,k.jsxs)("div",{className:"flex justify-between items-center",children:[(0,k.jsx)("span",{className:"font-bold",children:Yt}),(0,k.jsxs)("div",{className:"flex items-center ",children:[dn&&dn.length>0&&(0,k.jsx)(s.u,{title:"Columns Setting",children:(0,k.jsx)("span",{style:{fontSize:20,marginRight:"10px",marginLeft:"10px",cursor:"pointer"},onClick:()=>{yn(!0),jt("she")},children:(0,k.jsx)(C.XlX,{})})}),(0,k.jsx)("div",{className:"mt-2",children:(0,k.jsx)(s.zx,{icon:(0,k.jsx)(C.fMW,{}),size:"xs",style:{marginTop:-5},onClick:()=>Xt("")})})]})]})})},La=e=>{const t="".concat(e.className," justify-content-space-between items-center");return(0,k.jsx)("div",{className:t,children:(0,k.jsxs)("div",{className:"flex justify-between items-center",children:[(0,k.jsx)("span",{className:"font-bold",children:"Rotation Info"}),(0,k.jsxs)("div",{className:"flex items-center ",children:[(0,k.jsx)("span",{className:"mt-1 mr-1",children:(0,k.jsx)(N.C,{value:ae.length,severity:"success"})}),(0,k.jsx)("div",{className:"mt-2",children:(0,k.jsx)(s.zx,{icon:(0,k.jsx)(C.fMW,{}),size:"xs",style:{marginTop:-5},onClick:()=>Xt("")})})]})]})})},Ga=e=>{const t="".concat(e.className," justify-content-space-between items-center");return(0,k.jsxs)("div",{className:t,children:[(0,k.jsxs)("div",{className:"flex justify-between items-center",children:[(0,k.jsx)("div",{className:"flex align-items-center items-center",children:(0,k.jsx)("span",{className:"font-bold",children:"Break Wise Duration"})}),(0,k.jsx)("div",{className:"mt-2",children:(0,k.jsx)(s.zx,{icon:(0,k.jsx)(C.fMW,{}),size:"xs",style:{marginTop:-5},onClick:()=>Xt("")})})]}),(0,k.jsx)("div",{className:"flex align-items-end",children:(0,k.jsx)("div",{children:e.togglerElement})})]})};s.u,s.u,s.u,s.u,s.u;(0,a.useEffect)((()=>{var e;let n=null===(e=t[tn[0]])||void 0===e?void 0:e.Event_Name,a=t.filter(((e,t)=>e.Event_Name==n));le([...a])}),[tn]);const Ha=()=>{const e=[];for(let t=1;t<=6;t++)e.push((0,k.jsxs)(s.XZ,{value:t,children:["Break ",t]},t));return e},Ka=()=>(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{className:"text-700 mb-6",children:"Do you want to include commercials during these breaks?"}),(0,k.jsx)(s.XZ.Group,{value:ce,onChange:e=>{de(e)},children:Ha()}),(0,k.jsx)("ul",{className:"list-none p-0 m-0",children:(0,k.jsx)("li",{className:"flex align-items-center py-3 px-2 border-top-1 border-300 flex-wrap",children:(0,k.jsxs)("div",{className:"mr-5 flex align-items-center mt-3",children:[(0,k.jsx)(s.MG,{value:Bn,onChange:zn,style:{color:"black"}}),(0,k.jsx)(s.MG,{value:Zn,onChange:Rn,style:{color:"black"}})]})})})]}),Va=[{value:"starts_with",label:"Starts With"},{value:"contains",label:"Contains"},{value:"not_contains",label:"Not Contains"},{value:"ends_with",label:"Ends With"},{value:"equals",label:"Equals"},{value:"not_equals",label:"Not Equals"}];let Wa="".concat(Wt?"70%":"100%");const Qa=e=>{console.log("BackToBack_updtk");let t=e.map(((e,t,n)=>{let a="";return console.log("event.Brand",e.Brand),t>0&&n[t-1].Event_Name===e.Event_Name&&null!=e.Event_Name&&""!==e.Event_Name||t<n.length-1&&n[t+1].Event_Name===e.Event_Name&&null!=e.Event_Name&&""!==e.Event_Name?a="Event_Name":t>0&&n[t-1].Brand===e.Brand&&null!=e.Brand&&""!==String(e.Brand).trim()||t<n.length-1&&n[t+1].Brand===e.Brand&&null!=e.Brand&&""!==String(e.Brand).trim()?a="Brand":(t>0&&n[t-1].Client===e.Client&&null!=e.Client&&""!==e.Client||t<n.length-1&&n[t+1].Client===e.Client&&null!=e.Client&&""!==e.Client)&&(a="Client"),(0,h.Z)((0,h.Z)({},e),{},{TxLogCode:a})}));console.log("updtk",t),n(t)};return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(L.default,{showLoader:Te}),Ba&&(0,k.jsx)(s.bZ,{className:"mb-4",type:Za,showIcon:!0,children:Ba}),(0,k.jsx)("div",{className:"pb-1 pt-1 ",children:Ce.AutoSave?(0,k.jsx)(s.u,{title:"Auto Save",children:(0,k.jsx)(c.SU,{Progress:s.Ex,PromoSchdulingSave:Ln,openNotification:v.openNotification})}):null}),(0,k.jsx)("div",{children:(0,k.jsxs)("div",{className:"flex justify-between",children:[gn&&(0,k.jsx)("div",{className:"flex justify-start",children:(0,k.jsx)(s.u,{title:"Columns Setting",children:(0,k.jsx)("span",{style:{fontSize:25,marginTop:"5px",marginRight:"10px",cursor:"pointer"},onClick:()=>{yn(!0),jt("he")},children:(0,k.jsx)(C.XlX,{})})})}),(0,k.jsx)("div",{className:"flex justify-end",children:gn&&(0,k.jsx)("div",{className:"flex justify-end gap-2",children:(0,k.jsxs)("div",{className:"flex justify-justify-end gap-2",children:[(0,k.jsx)("div",{className:"",style:{overflow:"auto",whiteSpace:"nowrap",width:600,height:45},children:rt.map(((e,t)=>(0,k.jsx)(s.zx,{size:"xs",className:"ml-1 fpctimebtn",onClick:()=>{document.getElementById("div1").querySelector(".row-".concat(e.columnIndex)).scrollIntoView({behavior:"smooth",block:"center"})},style:{backgroundColor:e.Diffrance>0?"#f26f7f":"#6ff2b9",color:"black"},children:e.StartTime},t)))}),(0,k.jsxs)("div",{className:"flex justify-end gap-1",children:[(0,k.jsx)(s.u,{title:"Undo",children:(0,k.jsx)(s.zx,{shape:"circle",size:"sm",variant:"twoTone",onClick:()=>{Kt[_t.current-1];let e=Kt[_t.current-2];_t.current>1&&(He(!0),_t.current--,n(e))},icon:(0,k.jsx)(f.HDP,{})})}),_t.current<Kt.length&&(0,k.jsx)(s.u,{title:"Redo",children:(0,k.jsx)(s.zx,{shape:"circle",size:"sm",variant:"twoTone",onClick:()=>{let e=Kt[_t.current];Ve(!0),_t.current++,n(e)},icon:(0,k.jsx)(f.RjR,{})})}),(0,k.jsx)(s.u,{title:"Hide",children:(0,k.jsx)(s.zx,{shape:"circle",size:"sm",variant:"twoTone",onClick:()=>Qt(!Wt),icon:Wt?(0,k.jsx)(f.gry,{}):(0,k.jsx)(f.OPR,{})})})]})]})})})]})}),(0,k.jsx)(p.F,{ref:yt}),(0,k.jsx)(b.x,{model:An,ref:Nt,breakpoint:"767px"}),(0,k.jsx)(x.Z5,{onDragEnd:e=>{if("Drop Spot"!=Yt&&"table2"==e.destination.droppableId)return;if(!e.destination)return;let a="table2"==e.source.droppableId?ee[e.source.index]:t[e.source.index];if(console.log("draggedrow",a),"table2"===e.source.droppableId&&"table1"==e.destination.droppableId);else{const e=t.filter(((e,t)=>tn.includes(t)));for(const t of e){if("S"===t.F_C_S_P&&!pt)return void wt("Segment cannot be dragged","warning");if("CT"===t.F_C_S_P&&!pt)return void wt("Content cannot be dragged","warning")}}if("table1"===e.source.droppableId&&"table2"==e.destination.droppableId)if(tn.length){const a=t.filter(((e,t)=>tn.includes(t)));let l=t.filter(((e,t)=>tn.includes(t))).map((e=>e.BookingDetailID)).map((e=>({Id:e})));Pt(l,"E").then((l=>{if(l){n(t.filter(((e,t)=>!tn.includes(t))));let l=ee.slice(0,e.destination.index),s=ee.slice(e.destination.index,ee.length);const i=[...l,...a,...s];ne(i),nn([]),ye((e=>e+1))}}))}else{let a=t[e.source.index],l=t.filter(((e,t)=>tn.includes(t))).map((e=>e.BookingDetailID)).map((e=>({Id:e})));Pt(l,"E").then((e=>{if(e){let e=(0,h.Z)({},a);n(t.filter((e=>e!==a))),console.log("clonedRow",e);const l=[...ee,e];ne(l),ye((e=>e+1))}}))}else if("table2"===e.source.droppableId&&"table1"==e.destination.droppableId)if(console.log("result.destination.index0*",e.destination.index,dn.length),dn.length){let l=ee.filter(((e,t)=>dn.includes(t))),s=t[e.destination.index-1];if(console.log("CheckRODP5"),console.log(Qn(l,s)),!Qn(l,s))return console.log("CheckRODP5"),l=[],void(s=[]);let i=ee.filter(((e,t)=>dn.includes(t))).map((e=>e.BookingDetailID)).map((e=>({Id:e})));Pt(i,"B").then((i=>{if(i){s=t[e.destination.index-1];let i=(0,c.yw)(l,s);const r=[...t.slice(0,e.destination.index),...i,...t.slice(e.destination.index,t.length)];let o=ua((0,c.a1)(r,!0,at));n(o),Qa(o),ne(ee.filter((e=>e!==a))),un([]),ye((e=>e-1))}})).catch((e=>{console.error("Error updating booking status:",e)}))}else{console.log("result.destination.index2",e.destination.index);let l=ee[e.source.index],s=t[e.destination.index-1];if(console.log("CheckRODP4"),!Qn(l,s))return l=[],void(s=[]);let i=(0,c.yw)(l,s);const r=[...t.slice(0,e.destination.index),i,...t.slice(e.destination.index,t.length)];let o=ua((0,c.a1)(r,!0,at));ne(ee.filter((e=>e!==a))),n(o),Qa(o)}else if("table1"===e.source.droppableId&&"table1"==e.destination.droppableId){let a=e.source.index,l=e.destination.index,s=t[a],i=[];if(tn.length){const i=t.filter(((e,t)=>tn.includes(t)));let r=0,o=0;a>l?r=1:o=1;let d=t[e.destination.index-r];if(!Qn(i,d))return s=[],void(d=[]);let u=(0,c.yw)(i,d);const m=t.map(((e,t)=>tn.includes(t)?(0,h.Z)((0,h.Z)({},e),{},{F_C_S_P:$t?e.F_C_S_P:"DELETE"}):e));let x=e.destination.index;const p=[...m.slice(0,x+o),...u,...m.slice(x+o,m.length)].filter((e=>"DELETE"!==e.F_C_S_P));let C=(0,c.a1)(p,!0,at);console.log("res",C);let f=ua(C);return console.log("prm",f),n(f),Qa(f),void nn([])}if(a>l){let e=t[l-1],n=(0,c.yw)(s,e),r=a;a=l,l=r;let o=t.slice(0,a),d=t.slice(a,l),u=t.slice(l+1,t.length);i=[...o,n,...d,...u],$t&&(i=[...o,n,...d,s,...u])}else{let e=t.slice(0,a),n=t.slice(a+1,l+1),r=t.slice(l+1,t.length),o=t[l],d=(0,c.yw)(s,o);i=[...e,...n,d,...r],$t&&(i=[...e,s,...n,d,...r])}let r=ua((0,c.a1)(i,!0,at));n(r),Qa(r)}else if("table2"===e.source.droppableId&&"table2"==e.destination.droppableId){let t=e.source.index,n=e.destination.index;if(t>n){let e=t;t=n,n=e}let a=ee[t];const l=[...ee.slice(0,t),...ee.slice(t+1,n+1),a,...ee.slice(n+1,ee.length)];(0,c.a1)(l,!0,at);let s=ua(l);ne(s)}},children:(0,k.jsxs)("div",{className:Wt?"flex gap-5":"flex-full-width",children:[(0,k.jsx)("div",{className:"grid grid-cols-1 gap-2  table-container",style:{backgroundColor:"#1F2937",overflow:"auto",maxHeight:"100vh",maxWidth:Wa,height:"80vh"},id:"div1",children:(0,k.jsx)(s.Bl,{children:(0,k.jsx)(x.bK,{droppableId:"table1",children:e=>null!=B&&(0,k.jsxs)(s.iA,{ref:ha(e.innerRef,Dt),className:"resizable-table",children:[(0,k.jsx)(U,{className:"theade",children:(0,k.jsx)(V,{className:"tre",children:B.map(((e,a)=>(0,k.jsx)(k.Fragment,{children:(0,k.jsx)(y.Z,{columnName:e.name,table2Data:t,setTable2Data:n,table2DataCopy:ht,filterOptions:Va,columnFilters:bt,setColumnFilters:vt,IsSortingAllow:!1,selectedCities:B,setSelectedCities:M,ColIndex:a,ColumnInfo:e,DisplayFilter:jn})})))})}),(0,k.jsxs)(J,(0,h.Z)((0,h.Z)({},e.droppableProps),{},{className:"tbodye",children:[t.map(((e,t)=>(0,k.jsx)(k.Fragment,{children:(at||"C"!==e.F_C_S_P)&&(0,k.jsx)(x._l,{draggableId:"row-".concat(t),index:t,children:n=>(0,k.jsx)(V,(0,h.Z)((0,h.Z)((0,h.Z)({ref:ha(n.innerRef,Dt)},n.draggableProps),n.dragHandleProps),{},{className:"backcolor  rowINeed-".concat(e.SequenceNo,"  draggble-row row-").concat(e.Id," ").concat(e.PrimaryID===ft?"showntcRow":at||"NTC"!==e.F_C_S_P?"":"Rowhidden","\n                                                                                "),onClick:n=>{"CM"===e.F_C_S_P&&On(),n.ctrlKey?nn((e=>e.includes(t)?e.filter((e=>e!==t)):[...e,t])):nn([t])},onContextMenu:e=>{Nt.current.show(e),hn(t)},children:B.map((n=>{const a=ge.find((t=>t.FPC_ID===e.FPC_ID));return(0,k.jsx)(Q,{className:"jhh ",style:(0,h.Z)({borderBottom:"1px solid #8c7777",borderRight:"1px solid #8c7777"},tn.includes(t)?te.pressed:{backgroundColor:e.TxLogCode.length>2&&n.name===e.TxLogCode?"#C0C0C0":e.EventDefaultBackColor,color:e.EventDefaultFrontColor,width:e.width}),children:(0,k.jsxs)("div",{className:"Event_Name"===n.name?"flex items-center ":"flex justify-center items-center",children:["Event_Name"===n.name&&e.Event_Name&&e.F_C_S_P&&(0,k.jsx)(s.qE,{size:20,shape:"circle",className:z()("mr-4 text-white dark:text-white bg-black dark:bg-black"),children:e.F_C_S_P}),0!==e.FPC_Time.length&&"FPC_Time"===n.name&&"CT"===e.F_C_S_P&&tn.includes(t)&&(a?(0,k.jsx)("span",{className:" pi pi-sync text-base",style:{cursor:"pointer"},onClick:()=>{qt(!0),Lt(e.FPC_ID)}}):null)," ",e[n.name],0===e.FPC_Time.length&&"FPC_Time"===n.name&&("PR"===e.F_C_S_P||"SG"===e.F_C_S_P||"CM"===e.F_C_S_P)&&tn.includes(t)&&(0,k.jsxs)("div",{className:"flex gap-2",children:[(0,k.jsx)(s.u,{title:"Drop Spot",children:(0,k.jsx)("button",{onClick:()=>{kt()},children:(0,k.jsx)("span",{className:" pi pi-box text-base"})})}),(0,k.jsx)("button",{onClick:()=>(Xt("Rotation Info"),void On()),children:(0,k.jsx)("span",{className:" pi pi-info-circle text-base"})}),an.includes(t)&&(0,k.jsx)("button",{onClick:()=>{gt(ft===e.PrimaryID?0:e.PrimaryID)},children:(0,k.jsx)(C.LhU,{})})]}),0===e.FPC_Time.length&&"FPC_Time"===n.name&&"S"===e.F_C_S_P&&an.includes(t)&&(0,k.jsx)("div",{className:"flex gap-2",children:(0,k.jsx)("button",{onClick:()=>{gt(ft===e.PrimaryID?0:e.PrimaryID)},children:(0,k.jsx)(C.LhU,{size:80})})})]})},n.name)}))}))},e.Id)}))),e.placeholder]}))]})})})}),(0,k.jsxs)(s.Vq,{isOpen:At,onClose:()=>qt(!1),onRequestClose:()=>qt(!1),children:[(0,k.jsx)("h5",{className:"mb-4",children:"Are you sure you want to change program?"}),(0,k.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,k.jsxs)(s.Zb,{header:"Current Program",children:[ge.filter((e=>e.FPC_ID===Ot&&"CT"===e.F_C_S_P)).map(((e,t)=>(0,k.jsx)("p",{style:{fontSize:12,color:"wheat"},children:e.Event_Name},t))),(0,k.jsxs)("p",{style:{fontSize:12,color:"wheat"},children:["Totel Break\xa0= \xa0",ge.filter((e=>e.FPC_ID===Ot&&"S"===e.F_C_S_P)).length]})]}),(0,k.jsxs)(s.Zb,{header:"New Program",children:[Pe.filter((e=>e.FPC_ID==Ot&&"CT"===e.F_C_S_P)).map(((e,t)=>(0,k.jsx)("p",{style:{fontSize:12,color:"wheat"},children:e.Event_Name}))),(0,k.jsxs)("p",{style:{fontSize:12,color:"wheat"},children:["Totel Break\xa0= \xa0",Pe.filter((e=>e.FPC_ID===Ot&&"S"===e.F_C_S_P)).length]})]})]}),(0,k.jsxs)("div",{className:"text-right mt-6",children:[(0,k.jsx)(s.zx,{className:"ltr:mr-2 rtl:ml-2",variant:"plain",onClick:()=>qt(!1),children:"No"}),(0,k.jsx)(s.zx,{variant:"solid",onClick:()=>{const e=((e,n)=>{const a=t.map((t=>{if(t.FPC_ID===n){const a=e.findIndex((e=>t.F_C_S_P===e.F_C_S_P&&t.BreakNumber===e.BreakNumber));return-1!==a?(e[a].FPC_ID=n,e[a].Start_Time="00:00:00:00",(0,h.Z)((0,h.Z)({},t),e[a])):t}return t})),l=e.filter((e=>!a.some((t=>t.F_C_S_P===e.F_C_S_P&&t.FPC_ID===n&&t.BreakNumber===e.BreakNumber)))),s=a.reduce(((e,t,a)=>(t.FPC_ID===n&&(e=a),e)),-1);-1===s||a.splice(s+1,0,...l);const i=a.filter((t=>{const a=Math.max(...e.map((e=>e.BreakNumber)));return!(t.FPC_ID===n&&t.BreakNumber>a)}));return ua((0,c.a1)(i,!0,at))})(Pe,Ot);qt(!1);const a=ge.filter((e=>e.FPC_ID!=Ot));Se(a);const l=a.filter((e=>"CT"===e.F_C_S_P)).length;be(l),n(e)},children:"Yes"})]})]}),(0,k.jsxs)(s.Vq,{isOpen:Rt,onClose:()=>Mt(!1),onRequestClose:()=>Mt(!1),children:[(0,k.jsx)("h5",{className:"mb-4",children:"Are you sure to Generate log. ?"}),(0,k.jsxs)("div",{className:"text-right mt-6",children:[(0,k.jsx)(s.zx,{className:"ltr:mr-2 rtl:ml-2",variant:"plain",onClick:()=>Mt(!1),children:"No"}),(0,k.jsx)(s.zx,{variant:"solid",onClick:()=>(0,d.Bs)(Ce,(0,o.Tk)(ie),"GEN").then((e=>e.data)).then((e=>{let t=(0,c.a1)(e,!0,!1);t&&(n(t),Mt(!1))})),children:"Yes"})]})]}),Wt?(0,k.jsxs)("div",{className:"card flex flex-col gap-5",children:[(0,k.jsxs)("div",{className:"grid grid-cols-9 gap-2",children:[(0,k.jsx)(s.u,{title:"Menu",children:(0,k.jsx)(s.zx,{className:"text-lg",size:"sm",variant:gn?"solid":"twoTone",icon:(0,k.jsx)(G.mPA,{}),onClick:()=>{Sn(!gn)}})}),(0,k.jsx)(s.u,{title:"Export",children:(0,k.jsx)(s.zx,{className:"text-lg",size:"sm",variant:"twoTone",icon:(0,k.jsx)(C.tw,{}),onClick:()=>{const e=B.map((e=>{const{header:t}=e;return(0,m.Z)(e,K)}));(0,j.J)(!1,!1,0,0,!0,t,"Commercial Scheduling",e,!0)}})}),(0,k.jsx)(s.u,{title:Ut,children:(0,k.jsx)(s.zx,{className:"text-lg",size:"sm",variant:"twoTone",icon:(0,k.jsx)(C.TBf,{}),onClick:()=>{(()=>{const e=window.document,t=e.documentElement,n=t.requestFullscreen||t.mozRequestFullScreen||t.webkitRequestFullScreen||t.msRequestFullscreen,a=e.exitFullscreen||e.mozCancelFullScreen||e.webkitExitFullscreen||e.msExitFullscreen;e.fullscreenElement||e.mozFullScreenElement||e.webkitFullscreenElement||e.msFullscreenElement?(Jt(" Maximize"),a.call(e)):(Jt("Minimize"),n.call(t))})()}})}),(0,k.jsx)(s.u,{title:"Filter",children:(0,k.jsx)(s.zx,{className:"text-lg",size:"sm",variant:jn?"solid":"twoTone",icon:jn?(0,k.jsx)(C.Iit,{}):(0,k.jsx)(C.Yv7,{}),onClick:()=>{bn(!jn)}})}),(0,k.jsx)(s.u,{title:"Restore",children:(0,k.jsx)(s.zx,{className:"text-lg",size:"sm",variant:"twoTone",icon:(0,k.jsx)(C.zHJ,{}),onClick:()=>{Fa(Ce,(0,o.Tk)(ie)),Et(!0)}})}),(0,k.jsx)(s.u,{title:"Smart Shuffle",children:(0,k.jsx)(s.zx,{className:"text-lg",size:"sm",variant:jn?"solid":"twoTone",icon:(0,k.jsx)(I.aR5,{}),onClick:()=>Zt(!0)})}),(0,k.jsx)(s.u,{title:"Import Sequence",children:(0,k.jsx)(s.zx,{className:"text-lg",size:"sm",variant:"twoTone",icon:(0,k.jsx)(I.zom,{}),onClick:()=>{Bt(!0)}})})]}),(0,k.jsxs)(s.Zb,{className:"".concat(Yt?"hidden":null," "),children:[(0,k.jsxs)("div",{className:" web-card px-5",style:{height:200,overflow:"scroll"},children:[(0,k.jsx)("h4",{className:"",style:{fontSize:15,fontWeight:700,color:"rgba(255, 255, 255, 0.8)",letterSpacing:0},children:"Break Wise Inventory"}),null===En||void 0===En?void 0:En.map(((e,t)=>(0,k.jsx)("div",{children:Object.entries(e).map((e=>{let[t,n]=e;return(0,k.jsxs)("div",{className:"mb-2",children:[(0,k.jsxs)("div",{className:"flex justify-between items-center mx-1",children:[(0,k.jsxs)("p",{children:["Break Number - ",n.BreakNumber]})," ",(0,k.jsx)("p",{children:"".concat(n.TotalDurationByBreak)},t)]}),(0,k.jsx)(s.Ex,{percent:Number((0,v.parseDuration)(n.TotalDurationByBreak))/180*100,size:"xl",color:"green-500",customInfo:(0,k.jsx)(k.Fragment,{})})]})}))},t)))]}),(0,k.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,k.jsxs)(s.zx,{size:"xs",onClick:()=>{console.log("Drop Spots"),Ea("D",""),Xt("Drop Spot"),ka(1),Da(2),Pa(1),Ea("D","",1),Qe(!0)},children:[" ",(0,k.jsx)(s.Ct,{content:ve,children:" "}),"Drop Spots"]}),(0,k.jsxs)(s.zx,{size:"xs",onClick:()=>{Xt("Last Minute Spots"),ne([]),ka(2),Da(1),Pa(2),Ea("N","",2),Qe(!0)},children:[(0,k.jsx)(s.Ct,{content:Ne,children:" "}),"Last Minute"]}),(0,k.jsxs)(s.zx,{size:"xs",onClick:()=>{Xt("Rules Check")},children:[(0,k.jsx)(s.Ct,{content:Xn,children:" "}),"Rules Check"]}),(0,k.jsx)(s.zx,{size:"xs",onClick:()=>{Xt("Verify RODP"),Re()},children:"Check RODP"}),(0,k.jsx)(s.zx,{size:"xs",onClick:()=>Xt("Break Wise Duration"),children:"Duration"}),(0,k.jsx)(s.zx,{size:"xs",onClick:()=>Xt("Rotation Info"),children:"Rotation Info"}),(0,k.jsx)(s.zx,{size:"xs",onClick:()=>Xt("Summary"),children:"Summary"})]})]}),(()=>{switch(Yt){case"Drop Spot":case"Last Minute Spots":case"Program Search":return(0,k.jsxs)(s.Zb,{header:(0,k.jsx)(Oa,{}),children:[(0,k.jsx)(g.P,{}),(0,k.jsx)("div",{style:{width:"auto"},children:(0,k.jsx)("div",{style:{height:"400px",width:"400px",overflow:"hidden"},children:(0,k.jsx)(s.Bl,{children:(0,k.jsx)(x.bK,{droppableId:"table2",children:(e,t)=>(0,k.jsxs)(s.iA,(0,h.Z)((0,h.Z)({ref:e.innerRef},e.droppableProps),{},{className:"table table-striped",children:[(0,k.jsx)(U,{children:(0,k.jsx)(V,{className:"tre",children:ue.map(((e,t)=>(0,k.jsx)(y.Z,{columnName:e.name,table2Data:ee,setTable2Data:ne,table2DataCopy:Ue,filterOptions:Va,columnFilters:bt,setColumnFilters:vt,IsSortingAllow:!0,selectedCities:ue,setSelectedCities:me,ColIndex:t,ColumnInfo:e})))})}),(0,k.jsxs)(J,(0,h.Z)((0,h.Z)({},e.droppableProps),{},{children:[ee.map(((e,t)=>(0,k.jsx)(x._l,{draggableId:"row1-".concat(t),index:t,children:n=>(0,k.jsx)(V,(0,h.Z)((0,h.Z)((0,h.Z)({ref:n.innerRef},n.draggableProps),n.dragHandleProps),{},{className:"backcolor draggble-row row-".concat(e.Id," ").concat(st||"S"!==e.F_C_S_P?"":"Rowhidden"),onClick:n=>{const a=Me(ee,e.FPCIDForDrag);a.length>0?un(a):n.ctrlKey?un((e=>e.includes(t)?e.filter((e=>e!==t)):[...e,t])):n.shiftKey?(n.preventDefault(),dn.length&&un((e=>{if(e.includes(t))return e.filter((e=>e!==t));{let n=e.sort(),a=Un(n[n.length-1],t);return[...e,...a]}}))):un([t])},children:ue.map((n=>(0,k.jsx)(Q,{className:"jhh ",style:(0,h.Z)({borderBottom:"1px solid #8c7777",borderRight:"1px solid #8c7777"},dn.includes(t)?te.pressed:{backgroundColor:e.EventDefaultBackColor,color:e.EventDefaultFrontColor,width:e.width}),children:(0,k.jsx)("div",{className:"Event_Name"===n.name?"flex items-center ":"flex justify-center items-center",children:e[n.name]})},n.name)))}))},e.Id))),e.placeholder]}))]}))})})})})]});case"Rules Check":return(0,k.jsxs)(s.Zb,{header:(0,k.jsx)(Oa,{}),children:[(0,k.jsx)(g.P,{}),(0,k.jsx)("div",{style:{width:"auto"},children:(0,k.jsx)("div",{style:{height:"300px",width:"400px",overflow:"hidden"},children:(0,k.jsx)(s.Bl,{children:(0,k.jsx)(x.bK,{droppableId:"table2",children:(e,t)=>(0,k.jsxs)(s.iA,(0,h.Z)((0,h.Z)({ref:e.innerRef},e.droppableProps),{},{className:"table table-striped",children:[(0,k.jsx)(U,{children:(0,k.jsx)(V,{className:"tre",children:Y.map(((e,t)=>(0,k.jsx)(y.Z,{columnName:e.name,table2Data:ee,setTable2Data:ne,table2DataCopy:Ue,filterOptions:Va,columnFilters:bt,setColumnFilters:vt,IsSortingAllow:!0,selectedCities:Y,ColIndex:t,ColumnInfo:e})))})}),(0,k.jsxs)(J,(0,h.Z)((0,h.Z)({},e.droppableProps),{},{children:[na.map(((e,t)=>(0,k.jsx)(x._l,{draggableId:"row1-".concat(t),index:t,children:n=>(0,k.jsx)(V,(0,h.Z)((0,h.Z)((0,h.Z)({ref:n.innerRef},n.draggableProps),n.dragHandleProps),{},{className:"backcolor draggble-row row-".concat(e.Id," ").concat(st||"S"!==e.F_C_S_P?"":"Rowhidden"),onClick:n=>{const a=Me(ee,e.FPCIDForDrag);a.length>0?un(a):n.ctrlKey?un((e=>e.includes(t)?e.filter((e=>e!==t)):[...e,t])):n.shiftKey?(n.preventDefault(),dn.length&&un((e=>{if(e.includes(t))return e.filter((e=>e!==t));{let n=e.sort(),a=Un(n[n.length-1],t);return[...e,...a]}}))):un([t])},children:Y.map((n=>(0,k.jsx)(Q,{className:"Event_Name"===n.name?"jhh":"tde",style:(0,h.Z)({},dn.includes(t)?te.pressed:{backgroundColor:e.EventDefaultBackColor,color:e.EventDefaultFrontColor,width:e.width}),children:e[n.name]},n.name)))}))},e.Id))),e.placeholder]}))]}))})})})})]});case"Verify RODP":return(0,k.jsxs)(s.Zb,{header:(0,k.jsx)(Oa,{}),children:[(0,k.jsx)(g.P,{}),(0,k.jsx)("div",{style:{width:"auto"},children:(0,k.jsx)("div",{style:{height:"300px",width:"400px",overflow:"hidden"},children:(0,k.jsx)(s.Bl,{children:(0,k.jsx)(x.bK,{droppableId:"table2",children:(e,t)=>(0,k.jsxs)(s.iA,(0,h.Z)((0,h.Z)({ref:e.innerRef},e.droppableProps),{},{className:"table table-striped",children:[(0,k.jsx)(U,{children:(0,k.jsx)(V,{className:"tre",children:X.map(((e,t)=>(0,k.jsx)(y.Z,{columnName:e.name,table2Data:ee,setTable2Data:ne,table2DataCopy:Ue,filterOptions:Va,columnFilters:bt,setColumnFilters:vt,IsSortingAllow:!0,selectedCities:Y,ColIndex:t,ColumnInfo:e})))})}),(0,k.jsxs)(J,(0,h.Z)((0,h.Z)({},e.droppableProps),{},{children:[la.map(((e,t)=>(0,k.jsx)(x._l,{draggableId:"row1-".concat(t),index:t,children:n=>(0,k.jsx)(V,(0,h.Z)((0,h.Z)((0,h.Z)({ref:n.innerRef},n.draggableProps),n.dragHandleProps),{},{className:"backcolor draggble-row row-".concat(e.Id," ").concat(st||"S"!==e.F_C_S_P?"":"Rowhidden"),onClick:n=>{const a=Me(ee,e.FPCIDForDrag);a.length>0?un(a):n.ctrlKey?un((e=>e.includes(t)?e.filter((e=>e!==t)):[...e,t])):n.shiftKey?(n.preventDefault(),dn.length&&un((e=>{if(e.includes(t))return e.filter((e=>e!==t));{let n=e.sort(),a=Un(n[n.length-1],t);return[...e,...a]}}))):un([t])},children:Y.map((n=>(0,k.jsx)(Q,{className:"Event_Name"===n.name?"jhh":"tde",style:(0,h.Z)({},dn.includes(t)?te.pressed:{backgroundColor:e.EventDefaultBackColor,color:e.EventDefaultFrontColor,width:e.width}),children:e[n.name]},n.name)))}))},e.Id))),e.placeholder]}))]}))})})})})]});case"Summary":return(0,k.jsx)(s.Zb,{children:(0,k.jsxs)("div",{children:[(0,k.jsxs)("div",{className:"flex justify-between items-center mb-5",children:[(0,k.jsx)("h4",{className:"",children:" Summary"})," ",(0,k.jsx)(s.zx,{icon:(0,k.jsx)(C.fMW,{}),size:"xs",style:{marginTop:-5},onClick:()=>Xt("")})]}),(0,k.jsxs)("div",{className:"flex justify-between items-center px-2  border-b pb-3 border-inherit mt-3",children:[(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)(s.Ct,{className:"mr-4",innerClass:"bg-emerald-500"}),"Spots"]}),(0,k.jsx)("h6",{children:Number(ut.Commercial.length)+Number(ve)+Number(Ne)})]}),(0,k.jsxs)("div",{className:"flex justify-between items-center px-2  border-b pb-3 border-inherit mt-3",children:[(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)(s.Ct,{className:"mr-4",innerClass:"bg-red-500"}),"Schedule"]}),(0,k.jsx)("h6",{children:ut.Commercial.length})]}),(0,k.jsxs)("div",{className:"flex justify-between items-center px-2  border-b pb-3 border-inherit mt-3",children:[(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)(s.Ct,{className:"mr-4",innerClass:"bg-yellow-500"}),"Drops"]}),(0,k.jsx)("h6",{children:ve})]}),(0,k.jsxs)("div",{className:"flex justify-between items-center px-2  border-b pb-3 border-inherit mt-3",children:[(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)(s.Ct,{className:"mr-4",innerClass:"bg-yellow-500"}),"Last Min Spots"]}),(0,k.jsx)("h6",{children:Ne})]}),(0,k.jsxs)("div",{className:"flex justify-between items-center px-2  border-b pb-3 border-inherit mt-3",children:[(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)(s.Ct,{className:"mr-4",innerClass:"bg-yellow-500"}),"Back to Back"]}),(0,k.jsx)("p",{children:Xn})]}),(0,k.jsxs)("div",{className:"flex justify-between items-center px-2  border-b pb-3 border-inherit mt-3",children:[(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)(s.Ct,{className:"mr-4",innerClass:"bg-yellow-500"}),"Out Of RODP"]}),(0,k.jsx)("p",{children:"0"})]}),(0,k.jsxs)("div",{className:"flex justify-between items-center px-2  border-b pb-3 border-inherit mt-3",children:[(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)(s.Ct,{className:"mr-4",innerClass:"bg-yellow-500"}),"Breaks"]}),(0,k.jsx)("p",{children:ea})]}),(0,k.jsxs)("div",{className:"flex justify-between items-center px-2  border-b pb-3 border-inherit mt-3",children:[(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)(s.Ct,{className:"mr-4",innerClass:"bg-yellow-500"}),"Commercial Duration in Min"]}),(0,k.jsx)("p",{children:Number((0,v.parseDuration)((0,v.sumDurationsss)(t)+":00")/60)})]})]})});case"Rotation Info":return(0,k.jsx)(s.Zb,{header:(0,k.jsx)(La,{}),style:{height:"500px"},children:(0,k.jsx)("div",{style:{width:380},children:(0,k.jsx)("div",{style:{height:"400px",overflow:"auto"},children:(0,k.jsx)(s.Bl,{children:(0,k.jsxs)(s.iA,{children:[(0,k.jsx)(U,{children:(0,k.jsxs)(V,{children:[(0,k.jsx)(W,{children:"Play Time"}),(0,k.jsx)(W,{children:"Event_Name"}),(0,k.jsx)(W,{children:"Duration"})]})}),(0,k.jsx)(J,{children:ae.map(((e,t)=>(0,k.jsxs)(V,{onClick:()=>{console.log(e.SequenceNo);document.getElementById("div1").querySelector(".rowINeed-".concat(e.SequenceNo)).scrollIntoView({behavior:"smooth",block:"center"})},style:{cursor:"pointer"},className:"backcolor",children:[(0,k.jsx)(Q,{className:"tde",style:(0,h.Z)({},dn.includes(t)?te.pressed:{backgroundColor:e.EventDefaultBackColor,color:e.EventDefaultFrontColor,width:e.width}),children:e.Start_Time}),(0,k.jsx)(Q,{className:"tde",style:(0,h.Z)({},dn.includes(t)?te.pressed:{backgroundColor:e.EventDefaultBackColor,color:e.EventDefaultFrontColor,width:e.width}),children:e.Event_Name}),(0,k.jsx)(Q,{className:"tde",style:(0,h.Z)({},dn.includes(t)?te.pressed:{backgroundColor:e.EventDefaultBackColor,color:e.EventDefaultFrontColor,width:e.width}),children:e.Duration})]},t)))})]})})})})});case"Break Wise Duration":return(0,k.jsx)(s.Zb,{header:(0,k.jsx)(Ga,{}),children:(0,k.jsx)(P,{className:"p-0",BreakwiseData:Nn})});default:return null}})()]}):(0,k.jsx)(k.Fragment,{})]})}),(0,k.jsx)(l.gi,{className:"-mx-8 px-8 py-4 pt-2 pb-2",stickyClass:"border-t bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:(0,k.jsxs)("div",{className:"flex justify-between",children:[(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)(s.zx,{type:"button",onClick:()=>{let e=Kt[1];_t.current=1,n(e),Vt([[]]),oe(null)},className:"mr-2",variant:"",size:"sm",icon:(0,k.jsx)(C.BCj,{}),children:"Back"})," ","\xa0",(0,k.jsx)(s.zx,{onClick:Ln,variant:"solid",type:"submit",size:"sm",disabled:(0,v.convertDateFormatyyyyMMdd)(ie)<(0,O.WU)(new Date,"yyyy-MM-dd"),icon:(0,k.jsx)(Z.JMf,{}),children:"Save"})," ",(0,v.convertDateFormatyyyyMMdd)(ie)<(0,O.WU)(new Date,"yyyy-MM-dd")&&(0,k.jsx)("p",{className:"ml-2 text-red-500",children:"Backdated Commercials are non-editable"})]}),(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsxs)("div",{className:"flex flex-col lbl mr-2",children:[(0,k.jsx)("span",{className:"font-medium text-gray-600 dark:text-gray-300 text-sm mr-2 text-center",children:"Total Spots"}),(0,k.jsx)("span",{className:"font-medium text-lg text-center",children:ut.Commercial.length})]}),(0,k.jsxs)("div",{className:"flex flex-col lbl mr-2",children:[(0,k.jsx)("span",{className:"font-medium text-gray-600 dark:text-gray-300 text-sm mr-2 text-center",children:"Selected Spots"}),(0,k.jsx)("span",{className:"font-medium text-lg text-center",children:$e})]}),(0,k.jsxs)("div",{className:"flex flex-col lbl mr-5",children:[(0,k.jsx)("span",{className:"font-medium text-gray-600 dark:text-gray-300 text-sm mr-2 text-center",children:"Selected Duration"}),(0,k.jsx)("span",{className:"font-medium text-lg text-center",children:tt})]})]})]})}),(0,k.jsx)(S.V,{header:"Colums Setting",visible:vn,position:"top",style:{width:"40vw",backgroundColor:"#111827"},onHide:()=>yn(!1),footer:Ma,draggable:!1,resizable:!1,className:"lmop",children:(0,k.jsx)(Sa,{})}),(0,k.jsxs)(s.Vq,{isOpen:Ft,onClose:Gt,onRequestClose:Gt,children:[(0,k.jsx)("h5",{className:"mb-4",children:"Restore Previous Version "}),(0,k.jsx)(s.Ph,{placeholder:"Kindly Select",options:va,onChange:e=>_a(e)}),(0,k.jsxs)("div",{className:"text-right mt-6",children:[(0,k.jsx)(s.zx,{className:"ltr:mr-2 rtl:ml-2",onClick:Gt,children:"Cancel"}),(0,k.jsx)(s.zx,{variant:"solid",onClick:async e=>{De(!0);try{let e={LocationCode:Ce.LocationCode,ChannelCode:Ce.ChannelCode,ScheduleDate:(0,o.Tk)(ie),D_date:Na.value};const t=await(0,d.cn)(e);if(200==t.status&&(he(xe,!1),Gn("success","Data Saved Successfully."),De(!1)),204===t.status)return Gn("danger","Data Already Exists."),void De(!1)}catch(t){500==t.response.status&&(Gn("danger","Server Error."),De(!1)),De(!1)}Et(!1)},children:"Ok"})]})]}),(0,k.jsxs)(s.Vq,{isOpen:It,onClose:Ht,children:[(0,k.jsx)("h5",{className:"mb-4",children:"Import Sequence"}),(0,k.jsx)(s.Mt,{vlaue:ia,placeholder:"Pick a date",onChange:e=>ra(e)}),(0,k.jsxs)("div",{className:"text-right mt-6",children:[(0,k.jsx)(s.zx,{className:"ltr:mr-2 rtl:ml-2",onClick:Ht,children:"Cancel"}),(0,k.jsx)(s.zx,{variant:"solid",onClick:async()=>{if(ia){const t={ChannelCode:Ce.ChannelCode,scheduledate_From:(0,o.Tk)(fe[0]),scheduledate_To:(0,o.Tk)(ia)};try{200==(await(0,u.apiCallstoreprocedure)("Spot_Replicate",t)).status&&((0,v.openNotification)("success","Sequence imported Successfully."),ra([null,null]),Bt(!1))}catch(e){500==e.response.status&&((0,v.openNotification)("danger","Server Error."),ra([null,null]),Bt(!1))}}else(0,v.openNotification)("danger","Kindly Select Date")},children:"Ok"})]})]}),(0,k.jsxs)(s.Vq,{isOpen:zt,style:{content:{marginTop:250}},contentClassName:"pb-0 px-0",onClose:()=>Zt(!1),children:[(0,k.jsxs)("div",{className:"px-6 pb-6",children:[(0,k.jsx)("h5",{className:"mb-4",children:"Update Duration"}),(0,k.jsx)("p",{children:"We are currently saving your data. You will get updated duration accordingly."})]}),(0,k.jsxs)("div",{className:"text-right px-6 py-3 bg-gray-100 dark:bg-gray-700 rounded-bl-lg rounded-br-lg",children:[(0,k.jsx)(s.zx,{className:"ltr:mr-2 rtl:ml-2",onClick:()=>Zt(!1),children:"No"}),(0,k.jsx)(s.zx,{variant:"solid",onClick:()=>(async()=>{const e=await(0,u.apiCallstoreprocedure)("AutoShuffle2",{par_LocationCode:Ce.LocationCode,par_ChannelCode:Ce.ChannelCode,par_scheduledate:(0,o.Tk)(ie),par_BreakDur:200});console.log(e)})(),children:"Yes"})]})]})]})},te={pressed:{boxShadow:"0px 0px 0px rgb(198, 198, 198)",transition:"background-color 0.1s ease-in-out",scale:1},pressed2:{boxShadow:"0px 0px 0px rgb(13, 12, 12)",transition:"background-color 0.1s ease-in-out",scale:1}};var ne=n(24933),ae=n(92959);const le=[{header:"FPC Time",name:"FPC_Time",code:"FPC_Time",width:"auto",ScreenType:"Commercial Scheduling",Sequence:1,isvisible:!0},{header:"Event Name",name:"Event_Name",code:"Event_Name",width:"auto",ScreenType:"Commercial Scheduling",Sequence:1,isvisible:!0},{header:"Tel_Time",name:"Tel_Time",code:"Tel_Time",width:"auto",ScreenType:"Commercial Scheduling",Sequence:1,isvisible:!0},{header:"SeasonNo",name:"SeasonNo",code:"SeasonNo",width:"auto",ScreenType:"Commercial Scheduling",Sequence:1,isvisible:!0},{header:"EpisodeNo",name:"EpisodeNo",code:"EpisodeNo",width:"auto",ScreenType:"Commercial Scheduling",Sequence:1,isvisible:!0},{header:"Duration",name:"Duration",code:"Duration",width:"auto",ScreenType:"Commercial Scheduling",Sequence:1,isvisible:!0}],se=[{header:"FPC_ID",name:"FPC_ID",code:"FPC_ID",width:"auto",ScreenType:"CommercialSchedulingLeft",Sequence:1,isvisible:!0},{header:"FPC_Time",name:"FPC_Time",code:"FPC_Time",width:"auto",ScreenType:"CommercialSchedulingLeft",Sequence:1,isvisible:!0},{header:"Event_Name",name:"Event_Name",code:"Event_Name",width:"auto",ScreenType:"CommercialSchedulingLeft",Sequence:1,isvisible:!0},{header:"Duration",name:"Duration",code:"Duration",width:"auto",ScreenType:"CommercialSchedulingLeft",Sequence:1,isvisible:!0}],ie=()=>{const e=(0,r.useSelector)((e=>e.locale.selectedChannel)),t=(0,r.useSelector)((e=>e.auth.scheduling.DatainF)),n=(0,r.useSelector)((e=>e.auth.scheduling.timestoreF)),m=(0,r.useSelector)((e=>e.auth.scheduling.datestoreF)),h=(0,r.useDispatch)(),[x,p]=(0,a.useState)(null),[C,f]=(0,a.useState)([]),[g,S]=(0,a.useState)([]),[j,b]=(0,a.useState)([]),[y,N]=(0,a.useState)([]),[_,T]=(0,a.useState)([]),[D,w]=(0,a.useState)([]),[P,F]=(0,a.useState)([]),[I,B]=(0,a.useState)({}),[z,Z]=(0,a.useState)(null),[R,M]=(0,a.useState)([]),[A,q]=(0,a.useState)(new Date),[O,L]=(0,a.useState)(!1),[G,H]=(0,a.useState)(""),[K,V]=(0,a.useState)("");(0,a.useEffect)((()=>{const e=document.getElementsByClassName("Gbox2")[0],t=document.getElementsByClassName("Gbox2")[0].children[1];return h((0,E.rh)([(0,o.Tk)(A),"Commercial Scheduling"])),e&&(e.style.display="block",t.style.display="none"),()=>{e&&(e.style.display="none",t.style.display="none")}}),[]),(0,a.useEffect)((()=>{J();let t={};Z(null),t.LocationCode=e.LocationCode,t.ChannelCode=e.ChannelCode,t.Screen="COM",(0,d.c0)(t,(0,o.Tk)(A)).then((e=>{console.log("response",e.data),Z((0,o.Jl)(e.data,"commercialScheduling"))})).catch((e=>{e.response.status&&Z(null)}))}),[A,e,x]);const W=(0,r.useSelector)((e=>e.auth.session.LoginId)),Q=(n,a)=>{if(L(!1),null!=e){let l={ChannelCode:e.ChannelCode,LocationCode:e.LocationCode,TelecastDate:(0,o.Tk)(n.start),Mode:"S"};(0,u.apiCallstoreprocedure)("USP_Sch_Commercial_scheduling",l).then((e=>e.data)).then((e=>{if(0==e.length)return void s.Am.push((0,k.jsx)(s.P_,{title:"Error",type:"danger",children:"Daily FPC Not Ready"}));let l=(0,c.a1)(e,!0,!1);a?(null===t||void 0===t?void 0:t.length)>0&&S(t):S(l),p(n.start);const i=e.reduce(((e,t)=>{const n=t.FPC_Time?t.Id:"";return""!==n&&(e[n]=t.FPC_Time),e}),{});B(i);let r=Object.keys(e[0]).map((e=>{let t={};return t.name=e,t.code=e,t.width=100,t.header=e,t}));b(r),(async e=>{try{const e=await(0,ae.Q)("Commercial Scheduling");if(204==e.status){const e=le.map(((e,t)=>({header:e.header,name:e.name,code:e.code,width:"auto",ScreenType:e.ScreenType,Sequence:e.Sequence,isvisible:!0})));N(e)}const t=e.data.map(((e,t)=>({header:e.Header,name:e.ColumnName,code:e.ColumnName,width:"auto",ScreenType:e.ScreenName,Sequence:e.SequenceNo,isvisible:!0})));200==e.status&&N(t)}catch(t){}})(),(async e=>{try{const e=await(0,ae.Q)("CommercialSchedulingLeft");if(204==e.status){const e=se.map(((e,t)=>({header:e.header,name:e.name,code:e.code,width:"auto",ScreenType:e.ScreenType,Sequence:e.Sequence,isvisible:!0})));T(e)}const t=e.data.map(((e,t)=>({header:e.Header,name:e.ColumnName,code:e.ColumnName,width:"auto",ScreenType:e.ScreenName,Sequence:e.SequenceNo,isvisible:!0})));200==e.status&&T(t)}catch(t){}})()}))}else s.Am.push((0,k.jsx)(s.P_,{title:"Error",type:"danger",children:"Kindly Select Channel"}))},U=e=>{L(!1)},J=async()=>{const e=(await(0,i.bu)(W)).data.map((e=>({value:e.ChannelCode,label:e.ChannelName,ChannelCode:e.ChannelCode,LocationCode:e.LocationCode})));f(e)};return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(s.Zb,{children:[(0,k.jsxs)(s.Vq,{isOpen:O,onClose:U,onRequestClose:U,children:[(0,k.jsx)("h5",{className:"mb-4",children:"Unsaved work has been detected. Do you want to load it now?"}),(0,k.jsxs)("div",{style:{marginTop:"10px",display:"flex"},children:[(0,k.jsxs)("div",{className:"flex",children:[(0,k.jsx)("h1",{style:{color:"rgb(20 184 166)"},children:(0,o.QK)(m)[0].day}),(0,k.jsxs)("h6",{style:{color:"rgb(20 184 166)",fontSize:"13px"},children:[(0,o.QK)(m)[0].month,(0,k.jsx)("br",{}),(0,k.jsx)("h6",{style:{color:"rgb(20 184 166)",fontSize:"12px",marginTop:"-10px"},children:(0,o.QK)(m)[0].year})]})]}),(0,k.jsx)("span",{style:{fontSize:"15px",color:"white",marginTop:"10px",marginLeft:"10px"},onClick:()=>{let e=[...g].filter((e=>"PR"!=e.F_C_S_P));S(e)},children:e.label})]}),(0,k.jsx)("p",{children:(0,k.jsx)("p",{children:n})}),(0,k.jsxs)("div",{className:"text-right mt-6",children:[(0,k.jsx)(s.zx,{className:"ltr:mr-2 rtl:ml-2",variant:"plain",onClick:()=>Q(G,!1),children:"No"}),(0,k.jsx)(s.zx,{variant:"solid",onClick:()=>Q(G,!0),children:"Yes"})]})]}),null!=x?(0,k.jsx)(ee,{table1Data:g,setTable1Data:S,cities:j,setcities:b,Columnright:y,setColumnright:N,table2Data:D,setTable2Data:w,table3Data:P,setTable3Data:F,fpcTimes:I,value:x,value2:e,setValue:p,breaknumbers:R,setbreaknumbers:M,Columnleft:_,setColumnleft:T,onCellSelect:Q,evendata:G,setheadername:V}):(0,k.jsx)("div",{className:"grid grid-cols-2 gap-2",children:(0,k.jsx)("div",{className:"col-span-3",children:(0,k.jsx)(l.W2,{style:{height:550},children:(0,k.jsx)(l.wr,{events:z,select:t=>{if((0,v.isChannelSelected)(e)){z.some((e=>e.start===t.startStr))?(e=>{(0,o.qP)((0,o.QK)((0,o.Tk)(e.start)),(0,o.QK)(m))?(H(e),L(!0)):Q(e,!1)})(t):(0,v.openNotification)("info","Daily FPC not available for selected date")}else h((0,E.ar)(!0))},selectable:!0,datesSet:e=>{q(e.view.currentStart)}})})})})]}),(0,k.jsx)(ne.Z,{})]})}}}]);
//# sourceMappingURL=1196.64bf158f.chunk.js.map