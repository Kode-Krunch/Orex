import React from 'react'
import { FaRegFilePdf } from 'react-icons/fa';
import { RiFileExcel2Line } from 'react-icons/ri';
import { IoDocumentTextOutline } from 'react-icons/io5';
import { BsFiletypeGif, BsFiletypeJpg, BsFiletypeJson } from 'react-icons/bs';
import { TbFileTypePng } from 'react-icons/tb';
import { GoFileZip } from 'react-icons/go';
import { SlDocs } from 'react-icons/sl';
import { Avatar, Button, Card, Tooltip } from 'components/ui';

/* HELPER FUNCTIONS */
const getFileExtension = (filename) => {
    if (!filename || typeof filename !== "string") return "";
    return filename.split(".").pop().toLowerCase();
};

/* CONSTANTS */
const fileIcons = {
    pdf: <FaRegFilePdf className='text-red-500 text-2xl' />,
    xlsx: <RiFileExcel2Line className='text-green-500 text-2xl' />,
    xls: <RiFileExcel2Line className='text-green-500 text-2xl' />,
    csv: <RiFileExcel2Line className='text-teal-500 text-2xl' />,
    txt: <IoDocumentTextOutline className='text-blue-500 text-2xl' />,
    jpg: <BsFiletypeJpg className='text-sky-500 text-2xl' />,
    jpeg: <BsFiletypeJpg className='text-sky-500 text-2xl' />,
    png: <TbFileTypePng className='text-sky-500 text-2xl' />,
    gif: <BsFiletypeGif className='text-sky-500 text-2xl' />,
    zip: <GoFileZip className='text-yellow-500 text-2xl' />,
    json: <BsFiletypeJson className='text-yellow-500 text-2xl' />,
    doc: <SlDocs className='text-blue-500 text-2xl' />,
    docx: <SlDocs className='text-blue-500 text-2xl' />,
};

const AttachmentList = ({ dealAttachment, setDealAttachment, handleDownloadAndView }) => {
    return (
        dealAttachment && (
            <div className="mt-4">
                <div className="flex justify-between items-center">
                    <h6 className="mb-2">Attachment</h6>
                    <Button
                        size="sm"
                        className="py-0 !px-2 mb-2 !h-8"
                        onClick={() => setDealAttachment(null)}>
                        <span>Close</span>
                    </Button>
                </div>
                {dealAttachment.length == 0 ? <p className='flex justify-center items-center'>Not File Attached</p> : dealAttachment.map((item, index) => {
                    const ext = getFileExtension(item.AttachmentName);
                    return (
                        <Card
                            key={index}
                            bordered={false}
                            style={{ backgroundColor: "rgb(41 52 69)" }}
                            bodyClass="p-3 flex flex-col gap-6 mb-2 cursor-pointer" >
                            <div className="grid grid-cols-12 gap-4 " >
                                <div className='flex items-center gap-4 col-span-9 '>
                                    <Tooltip title={ext}>
                                        {fileIcons[ext] || <IoDocumentTextOutline className='text-yellow-500 text-2xl' />}
                                    </Tooltip>
                                    <Tooltip title={'Download This Attachment'}>
                                        <p onClick={() => handleDownloadAndView(item.AttachmentName)}>{item.AttachmentName}</p>
                                    </Tooltip>
                                </div>

                                <p className='flex items-center col-span-3'>
                                    <Avatar shape="circle" size="sm" className="mr-2 bg-indigo-100 text-indigo-600 dark:bg-indigo-500/20 dark:text-indigo-100">
                                        {item.LoginName[0]}
                                    </Avatar>
                                    {item.LoginName}
                                </p>
                            </div>
                        </Card>);
                })}
            </div>))
};


export default AttachmentList