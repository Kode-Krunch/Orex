import React, { useEffect, useMemo, useState } from 'react';
import HeaderCardDealMaster from './components/HeaderCardDealMaster';
import { apiCallstoreprocedure } from 'services/CommonService';
import { openNotification } from 'views/Controls/GLOBALFUNACTION';
import { useDispatch, useSelector } from 'react-redux';
import Loader from 'views/Controls/Loader';
import { headerCardDetails } from './components/Constant';
import { formatNumberToIndianSystem } from 'components/validators';
import MonthlyDealProjectionCard from './components/MonthlyDealProjectionCard';
import { addDays, format, subDays } from 'date-fns';
import { apiDashboardDoughnut, apiGetdealmaster } from 'services/DealServices';
import DonutGraph from './components/DonutGraph';
import { Avatar, Button, Input, Progress, Tabs, Tooltip } from 'components/ui';
import TabNav from 'components/ui/Tabs/TabNav';
import TabList from 'components/ui/Tabs/TabList';
import { useNavigate } from 'react-router-dom';
import DatePickerRange from 'components/ui/DatePicker/DatePickerRange';
import { MdContentCopy, MdOutlineRefresh } from 'react-icons/md';
import TabContent from 'components/ui/Tabs/TabContent';
import { setContent } from 'store/base/commonSlice';
import { getRandomColorClass } from 'views/Billing/BillGeneration/dtat';
import ReportsTable from 'views/Controls/ReportsTable/ReportsTable';
import ThisMonthDealCard from './components/ThisMonthDealCard';
import DealDetailsDialog from 'views/Controls/DealDetailsDialog/DealDetailsDialog';
import AchievementDialog from './components/AchievementDialog';
import CardData from './CardData';
import { BsInfoLg } from 'react-icons/bs';

const TooblbarOption = { groupBy: false, manageColumns: false };
const DealMaster = () => {
  /* HOOKS */
  const dispatch = useDispatch();
  const navigate = useNavigate();

  /* REDUX */
  const channel = useSelector((state) => state.locale.selectedChannel);

  /* STATES */
  const [showLoader, setShowLoader] = useState(false);
  const [isDashboardShow, setIsDashboardShow] = useState(false);
  const [dashBoardDoughnut, setDashBoardDoughnut] = useState([]);
  const [sum, setSum] = useState('');
  const [currentTab, setCurrentTab] = useState('tab1');
  const [isCustomCardVisible, setIsCustomCardVisible] = useState(true);
  const [customCardName, setCustomCardName] = useState('');
  const [montlyProjection, setMontlyProjection] = useState([]);
  const [yearlyTargetAcheived, setYearlyTargetAcheived] = useState([]);
  const [dueAmountandOverDueAmount, setDueAmountandOverDueAmount] = useState(
    {},
  );
  const [ActiveDeal, setActiveDeal] = useState(0);
  const [ApprovalPending, setApprovalPending] = useState(0);
  const [DealExpires, setDealExpires] = useState(0);
  const [dealMasterData, setDealMasterData] = useState([]);
  const [salesExecutiveData, setSalesExecutiveData] = useState([]);
  const [currentDate, setCurrentDate] = useState(new Date());
  const [dateRange, setDateRange] = useState([
    new Date(new Date().setDate(new Date().getDate() - 60)),
    new Date(new Date().setDate(new Date().getDate() + 30)),
  ]);
  const [globalFilter, setGlobalFilter] = useState('');
  const [allDealList, setAllDealList] = useState([]);
  const [thisMonthDealList, setThisMonthDealList] = useState([]);
  const [managedColumnAllDealTable, setManagedColumnAllDealTable] = useState(
    [],
  );
  const [recentDealList, setRecentDealList] = useState([]);
  const [managedColumnRecentDealTable, setManagedColumnRecentDealTable] =
    useState([]);
  const [expireDealList, setExpireDealList] = useState([]);
  const [managedColumnExpireDealTable, setManagedColumnExpireDealTable] =
    useState([]);
  const [rejectedDealList, setRejectedDealList] = useState([]);
  const [managedColumnRejectedDealTable, setManagedColumnRejectedDealTable] =
    useState([]);
  const [isDealDetailsDialogOpen, setIsDealDetailsDialogOpen] = useState(false);
  const [selectedDeal, setSelectedDeal] = useState({
    DealNumber: '',
    DealCode: '',
  });
  const [monthlySalesGrowthData, setmonthlySalesGrowthData] = useState();
  const [isAchievementDialogOpen, setIsAchievementDialogOpen] = useState(false);
  const [getSalesExecutiveId, setGetSalesExecutiveId] = useState(false);
  const [hardRefresh, setHardRefresh] = useState(1);

  /* HOOKS MEMO */
  const columns = useMemo(
    () => [
      {
        header: 'Deal Number',
        accessorKey: 'DealCode',
        cell: ({ row: { original } }) => (
          <div className="flex justify-between items-center gap-2">
            <div
              className="cursor-pointer bg-gray-500 dark:bg-[#5B92E633] text-black dark:text-gray-400 px-3 py-1 rounded-full font-bold"
              onClick={() => {
                dispatch(setContent(original));
                navigate('/DealMasterAdd', {
                  state: {
                    mode: 'edit',
                  },
                });
              }}
            >
              {original.DealCode}
            </div>
            <div className="flex justify-between items-center gap-2">
              <Tooltip title="Show Details">
                <Button
                  shape="circle"
                  icon={<BsInfoLg className="text-sm" />}
                  size="xs"
                  className="!h-5 !w-5"
                  onClick={() => handleShowDetailsClick(original)}
                />
              </Tooltip>
              <Tooltip title="Copy Deal">
                <Button
                  shape="circle"
                  icon={<MdContentCopy className="text-sm" />}
                  size="xs"
                  className="!h-6 !w-6"
                  onClick={() => {
                    dispatch(setContent(original));
                    navigate('/DealMasterAdd', {
                      state: {
                        mode: 'copy',
                      },
                    });
                  }}
                />
              </Tooltip>
            </div>
          </div>
        ),
        options: {
          cell: {
            style: {
              paddingBlock: 0,
            },
          },
        },
      },
      {
        header: 'Client',
        accessorKey: 'ClientName',
        cell: ({ row: { original } }) => (
          <div className="flex items-center">
            <Avatar
              size={25}
              className={`dark:${original.color} ${original.color} dark:text-gray-200 text-gray-800`}
            >
              {original.ClientName.charAt(0)}
            </Avatar>
            <p className="ml-2 capitalize">{original.ClientName}</p>
          </div>
        ),
        options: {
          cell: {
            style: {
              paddingBlock: 0,
            },
          },
        },
      },
      {
        header: 'Start Date',
        accessorKey: 'DealPeriodFromDate',
        cell: ({ row: { original } }) => (
          <p className="capitalize">
            {format(new Date(original.DealPeriodFromDate), 'dd MMM yyyy')}
          </p>
        ),
        options: {
          cell: {
            style: {
              paddingBlock: 0,
            },
          },
        },
      },
      {
        header: 'End Date',
        accessorKey: 'DealPeriodToDate',
        cell: ({ row: { original } }) => (
          <p className="capitalize">
            {format(new Date(original.DealPeriodToDate), 'dd MMM yyyy')}
          </p>
        ),
        options: {
          cell: {
            style: {
              paddingBlock: 0,
            },
          },
        },
      },
      {
        header: 'Utilization',
        cell: ({ row: { original } }) => {
          const total = Number(original.TotalAmount);
          const balance = Number(original.BalanceAmount);
          const utilization =
            total === 0 ? 0 : ((balance / total) * 100).toFixed(2);
          return (
            <Progress
              color={utilization < 90 ? 'green-500' : 'red-500'}
              size="sm"
              className="rounded"
              percent={100 - utilization}
              customInfo
            />
          );
        },
        options: {
          cell: {
            style: {
              paddingBlock: 0,
            },
          },
        },
      },
      {
        header: 'Amount',
        accessorKey: 'TotalAmount',
        cell: ({ row: { original } }) => {
          const { TotalAmount, CurrencySymbol } = original;
          const formattedAmount = new Intl.NumberFormat('en-US', {
            maximumFractionDigits: 2,
          }).format(TotalAmount);
          return (
            <p className="cursor-pointer flex items-center font-semibold">
              {`${CurrencySymbol} ${formattedAmount}`}
            </p>
          );
        },
        options: {
          cell: {
            style: {
              paddingBlock: 0,
            },
          },
        },
      },
    ],
    [],
  );

  /* USE EFFECTS */
  useEffect(() => {
    const fetchData = async () => {
      setShowLoader(true);
      const params = {
        LocationCode: channel.LocationCode,
        ChannelCode: channel.ChannelCode,
      };
      const apiCalls = [
        {
          key: 'salesPerformance',
          procedure: 'USP_DealDashboardSalesPerformance',
          params,
        },
        {
          key: 'dueAmount',
          procedure: 'Get_DueAmountandOverDueAmount',
          params,
        },
        {
          key: 'monthlyProjection',
          procedure: 'USP_DealDashboardMontlyProjection',
          params,
        },
        {
          key: 'yearlyTarget',
          procedure: 'USP_DealDashboardYearlyTargetAcheived',
          params: {},
        },
        {
          key: 'activeDeals',
          procedure: 'USP_DealDashboardActiveDeals',
          params,
        },
        {
          key: 'approvalPending',
          procedure: 'USP_DealDashboardApprovalPendingDeals',
          params,
        },
        {
          key: 'dealExpires',
          procedure: 'USP_DealDashboardDealExpiresinMonth',
          params,
        },
        { key: 'thisMonthDeal', procedure: 'usp_Deal_ThisMonthDeal', params },
        {
          key: 'monthlySalesGrowth',
          procedure: 'USP_MonthlySalesGrowth',
          params,
        },
      ];
      try {
        const results = await Promise.allSettled(
          apiCalls.map(({ procedure, params }) =>
            apiCallstoreprocedure(procedure, params),
          ),
        );
        results?.forEach((result, index) => {
          const { key } = apiCalls[index];
          if (result.status === 'fulfilled') {
            switch (key) {
              case 'salesPerformance':
                setSalesExecutiveData(
                  result.value.status === 204 ? [] : result.value.data,
                );
                break;
              case 'dueAmount':
                setDueAmountandOverDueAmount(
                  result.value.status === 204 ? {} : result.value.data[0],
                );
                break;
              case 'monthlyProjection':
                setMontlyProjection(result.value.data);
                break;
              case 'yearlyTarget':
                setYearlyTargetAcheived(result.value.data);
                break;
              case 'activeDeals':
                setActiveDeal(result.value.data[0]?.ActiveDeals || 0);
                break;
              case 'approvalPending':
                setApprovalPending(
                  result.value.data[0]?.ApprovalPendingDeals || 0,
                );
                break;
              case 'dealExpires':
                setDealExpires(result.value.data[0]?.DealExpiresinMonth || 0);
                break;
              case 'thisMonthDeal':
                setThisMonthDealList(
                  result?.value?.data?.map((item) => ({
                    color: getRandomColorClass(),
                    ...item,
                  })),
                );
                break;
              case 'monthlySalesGrowth':
                setmonthlySalesGrowthData(
                  result.value.data[0]?.MonthlySalesGrowth || 0,
                );
                break;
              default:
                break;
            }
          } else {
            console.error(`Error fetching ${key}:`, result.reason);
          }
        });
      } catch (error) {
        console.error('Unexpected error fetching dashboard data:', error);
      } finally {
        setShowLoader(false);
        setIsDashboardShow(true);
      }
    };
    fetchData();
  }, []);

  useEffect(() => {
    (async (values) => {
      try {
        const resp = await apiDashboardDoughnut(
          format(currentDate, 'yyyy-MM-dd'),
        );
        const transformedData = resp.data
          .filter((item) => item.ReportType === 'DealType')
          .map((item) => ({
            name: item.FieldType,
            quantity: item.FieldAmount,
          }));
        setDashBoardDoughnut(transformedData);
        let quantities = [];
        transformedData.forEach(function (n) {
          quantities.push(n.quantity);
        });
        setSum(quantities.reduce((acc, cur) => acc + cur, 0));
      } catch (error) {
        setDashBoardDoughnut([]);
      }
    })();
  }, [currentDate]);

  useEffect(() => {
    if (dateRange[0] && dateRange[1]) {
      getAllDeals();
      getExpireDeals();
    }
  }, [dateRange, hardRefresh, channel]);

  useEffect(() => {
    getRecentDeals();
    getRejectedDeals();
  }, [hardRefresh, channel]);

  /* EVENT HANDLERS */
  const handlePreviousMonth = () => {
    const yesterday = subDays(currentDate, 1);
    setCurrentDate(yesterday);
  };
  const handleNextMonth = () => {
    const tommorrow = addDays(currentDate, 1);
    setCurrentDate(tommorrow);
  };

  /* HELPER FUNCTIONS */
  const getDealMasterData = async (
    IsApproved,
    IsExpiring,
    IsRejected,
    name,
  ) => {
    setShowLoader(true);
    let param = {
      par_IsApproved: IsApproved,
      par_IsExpiring: IsExpiring,
      par_IsRejected: IsRejected,
      par_LocationCode: channel.LocationCode,
      par_ChannelCode: channel.ChannelCode,
    };
    try {
      let resp = await apiCallstoreprocedure(name, param);
      if (resp.status == 200) {
        setDealMasterData(resp.data);
      } else if (resp.status === 204) {
        setDealMasterData([]);
      }
    } catch (error) {
      if (error.response.status == 500) {
        openNotification('warning', 'Please Contact Team');
      }
      console.error('Error fetching data:', error);
    } finally {
      setShowLoader(false);
    }
  };
  const getAllDeals = async () => {
    setShowLoader(true);
    let param = {
      LocationCode: channel.LocationCode,
      ChannelCode: channel.ChannelCode,
    };
    try {
      const resp = await apiGetdealmaster(param, dateRange);
      if (resp.status == 200) {
        const formattedData = resp.data.map((item) => ({
          color: getRandomColorClass(),
          ...item,
        }));
        setAllDealList(formattedData);
      } else if (resp.status === 204) {
        setAllDealList([]);
      }
    } catch (error) {
      openNotification('warning', 'Deals Not Found!');
      console.error('Error fetching data:', error);
    } finally {
      setShowLoader(false);
    }
  };
  const getRecentDeals = async () => {
    setShowLoader(true);
    let param = {
      LocationCode: channel.LocationCode,
      ChannelCode: channel.ChannelCode,
    };
    try {
      const resp = await apiCallstoreprocedure('RecentlyAddDeal', param);
      if (resp.status == 200) {
        const formattedData = resp.data.map((item) => ({
          color: getRandomColorClass(),
          ...item,
        }));
        setRecentDealList(formattedData);
      } else if (resp.status === 204) {
        setRecentDealList([]);
      }
    } catch (error) {
      openNotification('warning', 'Recently Added Deal Not Found!');
      console.error('Error fetching data:', error);
    } finally {
      setShowLoader(false);
    }
  };
  const getExpireDeals = async () => {
    setShowLoader(true);

    let param = {
      LocationCode: channel.LocationCode,
      ChannelCode: channel.ChannelCode,
      FromDate: format(dateRange[0], 'yyyy-MM-dd'),
      Todate: format(dateRange[1], 'yyyy-MM-dd'),
    };
    try {
      const resp = await apiCallstoreprocedure('USP_DEAL_GetExpireDeal', param);
      if (resp.status == 200) {
        const formattedData = resp.data.map((item) => ({
          color: getRandomColorClass(),
          ...item,
        }));
        setExpireDealList(formattedData);
      } else if (resp.status === 204) {
        setExpireDealList([]);
      }
    } catch (error) {
      openNotification('warning', 'Expired Deal Not Found!');
      console.error('Error fetching data:', error);
    } finally {
      setShowLoader(false);
    }
  };
  const getRejectedDeals = async () => {
    setShowLoader(true);
    let param = {
      par_IsApproved: 0,
      par_IsExpiring: 0,
      par_IsRejected: 2,
      par_LocationCode: channel.LocationCode,
      par_ChannelCode: channel.ChannelCode,
    };
    try {
      const resp = await apiCallstoreprocedure('USP_DealDisplay', param);
      if (resp.status == 200) {
        const formattedData = resp.data.map((item) => ({
          color: getRandomColorClass(),
          ...item,
        }));
        setRejectedDealList(formattedData);
      } else if (resp.status === 204) {
        setRejectedDealList([]);
      }
    } catch (error) {
      openNotification('warning', 'Rejected Deal Not Found!');
      console.error('Error fetching data:', error);
    } finally {
      setShowLoader(false);
    }
  };
  const handleShowDetailsClick = (deal) => {
    setSelectedDeal({
      DealNumber: deal.DealNumber,
      DealCode: deal.DealCode,
    });
    setIsDealDetailsDialogOpen(true);
  };
  const openDialog = (id) => {
    setGetSalesExecutiveId(id);
    setIsAchievementDialogOpen(true);
  };
  return (
    <div className="p-4 mb-4 dark:bg-slate-800 bg-slate-100">
      {isDashboardShow && (
        <>
          {isCustomCardVisible ? (
            <>
              <div className="grid grid-cols-6 gap-2 mb-2">
                <HeaderCardDealMaster
                  item={headerCardDetails[0]}
                  setIsCustomCardVisible={setIsCustomCardVisible}
                  setCustomCardName={setCustomCardName}
                  getDealMasterData={getDealMasterData}
                  statusCount={ActiveDeal}
                />
                <HeaderCardDealMaster
                  item={headerCardDetails[1]}
                  setIsCustomCardVisible={setIsCustomCardVisible}
                  setCustomCardName={setCustomCardName}
                  getDealMasterData={getDealMasterData}
                  statusCount={ApprovalPending}
                />
                <HeaderCardDealMaster
                  item={headerCardDetails[2]}
                  setIsCustomCardVisible={setIsCustomCardVisible}
                  setCustomCardName={setCustomCardName}
                  getDealMasterData={getDealMasterData}
                  statusCount={DealExpires}
                />
                <HeaderCardDealMaster
                  item={headerCardDetails[3]}
                  setIsCustomCardVisible={setIsCustomCardVisible}
                  setCustomCardName={setCustomCardName}
                  getDealMasterData={getDealMasterData}
                  statusCount={`â‚¹ ${formatNumberToIndianSystem(
                    yearlyTargetAcheived[0]?.TargetAmount,
                  )}`}
                  percent={
                    yearlyTargetAcheived[0]?.TargetAchievedPercent.toFixed() !=
                    null
                      ? yearlyTargetAcheived[0]?.TargetAchievedPercent.toFixed()
                      : 0
                  }
                  handleClickFn={() => navigate('/SalesTarget')}
                />
                <MonthlyDealProjectionCard
                  montlyProjection={montlyProjection}
                />
              </div>
              <div className="grid grid-cols-5 gap-2">
                <div className="col-span-4 web-card dark:!bg-[#1f2639] !bg-[#fff] dark:!border-[#374558] dark:!border ">
                  <div className="card-bodyR">
                    <Tabs
                      value={currentTab}
                      onChange={(val) => {
                        setCurrentTab(val);
                        setGlobalFilter('');
                      }}
                      variant="pill"
                      className="h-[500px] flex flex-col"
                    >
                      <div className="flex justify-between items-center">
                        <TabList>
                          <TabNav value="tab1">Recent Deal</TabNav>
                          <TabNav value="tab2">All Deal</TabNav>
                          <TabNav value="tab3">Expired Deal</TabNav>
                          <TabNav value="tab4">Rejected Deals</TabNav>
                        </TabList>
                        <div className="flex">
                          <TabContent value="tab2">
                            <DatePickerRange
                              value={dateRange}
                              placeholder="Pick date & time"
                              size="sm"
                              className="mr-2"
                              onChange={(e) => setDateRange(e)}
                            />
                          </TabContent>
                          <TabContent value="tab3">
                            <DatePickerRange
                              value={dateRange}
                              placeholder="Pick date & time"
                              size="sm"
                              className="mr-2 flex justify-end items-center"
                              onChange={(e) => setDateRange(e)}
                            />
                          </TabContent>
                          <Input
                            style={{ width: '200px' }}
                            size="sm"
                            value={globalFilter ?? ''}
                            className="ml-2"
                            placeholder="Search"
                            onChange={(e) => {
                              if (/^[0-9a-zA-Z\s/]*$/.test(e.target.value)) {
                                setGlobalFilter(e.target.value);
                              }
                            }}
                          />
                          <Button
                            onClick={() => {
                              navigate('/DealMasterAdd', {
                                state: {
                                  mode: 'add',
                                },
                              });
                              dispatch(setContent([]));
                            }}
                            size="sm"
                            variant="solid"
                            className="ml-2"
                          >
                            Add Deal
                          </Button>
                          <Button
                            onClick={() => {
                              setHardRefresh(
                                Math.floor(Math.random() * 100) + 1,
                              );
                            }}
                            size="sm"
                            variant="solid"
                            className="ml-2"
                            icon={<MdOutlineRefresh />}
                          />
                        </div>
                      </div>
                      <TabContent
                        value="tab1"
                        className="grow"
                        style={{ overflow: 'scroll' }}
                      >
                        <div className="mt-2">
                          <ReportsTable
                            tableData={recentDealList}
                            originalColumns={columns}
                            managedColumns={managedColumnRecentDealTable}
                            setManagedColumns={setManagedColumnRecentDealTable}
                            toolbarOptions={TooblbarOption}
                            exportFileName={'Recent Deals'}
                            tableName={'Recent Deals'}
                            externalGlobalFilter={globalFilter}
                            columnsToFormatInINR={[]}
                          />
                        </div>
                      </TabContent>
                      <TabContent
                        value="tab2"
                        className="grow"
                        style={{ overflow: 'scroll' }}
                      >
                        <div className="mt-2 ">
                          <ReportsTable
                            tableData={allDealList}
                            originalColumns={columns}
                            managedColumns={managedColumnAllDealTable}
                            setManagedColumns={setManagedColumnAllDealTable}
                            toolbarOptions={TooblbarOption}
                            exportFileName={'All Deals'}
                            tableName={'All Deals'}
                            externalGlobalFilter={globalFilter}
                            columnsToFormatInINR={[]}
                          />
                        </div>
                      </TabContent>
                      <TabContent
                        value="tab3"
                        className="grow"
                        style={{ overflow: 'scroll' }}
                      >
                        <div className="mt-2 ">
                          <ReportsTable
                            tableData={expireDealList}
                            originalColumns={columns}
                            managedColumns={managedColumnExpireDealTable}
                            setManagedColumns={setManagedColumnExpireDealTable}
                            toolbarOptions={TooblbarOption}
                            exportFileName={'Expired Deals'}
                            tableName={'Expired Deals'}
                            externalGlobalFilter={globalFilter}
                            columnsToFormatInINR={[]}
                          />
                        </div>
                      </TabContent>
                      <TabContent
                        value="tab4"
                        className="grow"
                        style={{ overflow: 'scroll' }}
                      >
                        <div className="mt-2 ">
                          <ReportsTable
                            tableData={rejectedDealList}
                            originalColumns={columns}
                            managedColumns={managedColumnRejectedDealTable}
                            setManagedColumns={
                              setManagedColumnRejectedDealTable
                            }
                            toolbarOptions={TooblbarOption}
                            exportFileName={'Rejected Deals'}
                            tableName={'Rejected Deals'}
                            externalGlobalFilter={globalFilter}
                            columnsToFormatInINR={[]}
                          />
                        </div>
                      </TabContent>
                    </Tabs>
                  </div>
                </div>
                <div className="web-card dark:!bg-[#1f2639] !bg-[#fff] dark:!border-[#374558] dark:!border h-[600px]">
                  <DonutGraph
                    handlePreviousMonth={handlePreviousMonth}
                    handleNextMonth={handleNextMonth}
                    currentDate={currentDate}
                    dashBoardDoughnut={dashBoardDoughnut}
                    sum={sum}
                    title={'Earn by Categories'}
                  />
                </div>
              </div>

              <ThisMonthDealCard
                thisMonthDealList={thisMonthDealList}
                handleShowDetailsClick={handleShowDetailsClick}
                monthlySalesGrowthData={monthlySalesGrowthData}
                dueAmountandOverDueAmount={dueAmountandOverDueAmount}
                salesExecutiveData={salesExecutiveData}
                openDialog={openDialog}
              />

              {isDealDetailsDialogOpen && (
                <DealDetailsDialog
                  isDialogOpen={isDealDetailsDialogOpen}
                  setIsDialogOpen={setIsDealDetailsDialogOpen}
                  dealNumber={selectedDeal.DealNumber}
                  dealCode={selectedDeal.DealCode}
                />
              )}

              {isAchievementDialogOpen && (
                <AchievementDialog
                  salesExecutiveData={salesExecutiveData}
                  isAchievementDialogOpen={isAchievementDialogOpen}
                  getSalesExecutiveId={getSalesExecutiveId}
                  setIsAchievementDialogOpen={setIsAchievementDialogOpen}
                  setGetSalesExecutiveId={setGetSalesExecutiveId}
                />
              )}
            </>
          ) : (
            <CardData
              data={dealMasterData}
              setIsCustomCardVisible={setIsCustomCardVisible}
              Name={customCardName}
            />
          )}
        </>
      )}

      <Loader showLoader={showLoader} />
    </div>
  );
};

export default DealMaster;
