import {
  rowDataTypesEnum,
  secTableBottomToolbarFeaturesEnum,
} from 'views/Scheduling/Scheduler/enum';

const classNames = require('classnames');

const getClassNames = (isFeatureActive) => {
  try {
    return classNames(
      isFeatureActive
        ? '!bg-teal-700 hover:!bg-teal-700'
        : 'hover:!bg-teal-800',
      'transition-all !h-8 !w-8',
    );
  } catch (error) {
    console.error(error);
  }
};

const isReplaceFeatureDisabled = (
  schedulingTableSelectedRows,
  secondaryTableSelectedRows,
) => {
  try {
    if (
      secondaryTableSelectedRows.length === 1 &&
      schedulingTableSelectedRows.length > 0
    ) {
      const selectedRowDataType = secondaryTableSelectedRows[0].F_C_S_P;
      const isSchTableSelectedRowsValid = schedulingTableSelectedRows.every(
        (item) => item.F_C_S_P === selectedRowDataType,
      );
      if (!isSchTableSelectedRowsValid) {
        return true;
      }
      return false;
    }
    return true;
  } catch (error) {
    throw error;
  }
};

const isFeatureDisabled = (
  schedulingTableSelectedRows,
  secondaryTableSelectedRows,
  feature,
) => {
  try {
    switch (feature) {
      case secTableBottomToolbarFeaturesEnum.INSERT:
        return (
          schedulingTableSelectedRows.length !== 1 ||
          secondaryTableSelectedRows.length === 0 ||
          (secondaryTableSelectedRows.length > 0 &&
            secondaryTableSelectedRows[0].F_C_S_P === rowDataTypesEnum.NTC &&
            schedulingTableSelectedRows.length === 1 &&
            (schedulingTableSelectedRows[0].F_C_S_P ===
              rowDataTypesEnum.COMMERCIAL ||
              schedulingTableSelectedRows[0].F_C_S_P ===
                rowDataTypesEnum.CONTENT_TERMINATION))
        );
      case secTableBottomToolbarFeaturesEnum.BULK_INSERT:
        return secondaryTableSelectedRows.length === 0 ? true : false;
      case secTableBottomToolbarFeaturesEnum.REPLACE:
        return isReplaceFeatureDisabled(
          schedulingTableSelectedRows,
          secondaryTableSelectedRows,
        );
      case secTableBottomToolbarFeaturesEnum.REPLACE_ALL:
        return isReplaceFeatureDisabled(
          schedulingTableSelectedRows,
          secondaryTableSelectedRows,
        );
      default:
        return false;
    }
  } catch (error) {
    console.error(error);
  }
};

const getBreaks = (tableData) => {
  try {
    let breaks = [];
    let maxBreaks = 0;
    tableData.forEach((row) => {
      if (Number(row.BreakNumber) > maxBreaks) {
        maxBreaks = Number(row.BreakNumber);
      }
    });
    for (let i = 1; i <= maxBreaks; i++) {
      breaks.push({ value: i, label: `Break ${i}` });
    }
    return breaks;
  } catch (error) {
    console.error(error);
  }
};

export { getClassNames, isFeatureDisabled, getBreaks };
