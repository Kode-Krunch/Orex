import React, { useEffect, useState } from 'react';
import {
  flexRender,
  getCoreRowModel,
  getSortedRowModel,
  useReactTable,
  getFilteredRowModel,
  getPaginationRowModel,
} from '@tanstack/react-table';
import { generatePassword } from '../../components/validators';
import { Button, Dialog } from 'components/ui';
import {
  Pagination,
  Select,
  Table,
  Input,
  Tooltip,
  toast as toastwe,
} from 'components/ui';
import {
  HiEye,
  HiDownload,
  HiOutlinePencil,
  HiOutlineUser,
  HiOutlineEyeOff,
  HiOutlineEye,
  HiOutlineBadgeCheck,
} from 'react-icons/hi';
import { useSelector } from 'react-redux';
import { Link } from 'react-router-dom';
import {
  CreateLogin,
  loginupdate,
  apiGetChannelmaster,
  loginlocchnlmapping,
  getChannelsEmployee,
  apiGetEmployeemasterApproved,
  apiGetChannelmasterdrop,
  apiGetEmployeemaster,
  apipostcopyrights,
} from 'services/MasterService';
import { FaChromecast, FaRegCopy } from 'react-icons/fa';
import { ExportxlswithColor } from './ExportxlswithColor';
import Notification from 'components/ui/Notification';
import './Displaytable.css';
import { CgClose } from 'react-icons/cg';
import { openNotification } from './GLOBALFUNACTION';
import Loader from './Loader';

/* CONSTANTS */
const { Tr, Th, Td, THead, TBody, Sorter } = Table;

// Define strong password requirements
const passwordRequirements = {
  minLength: 8,
  uppercase: true,
  lowercase: true,
  number: true,
  symbol: true,
};

const pageSizeOption = [
  { value: 10, label: '10 / page' },
  { value: 20, label: '20 / page' },
  { value: 30, label: '30 / page' },
  { value: 40, label: '40 / page' },
  { value: 50, label: '50 / page' },
];

const DisplayTableEmp = ({
  data,
  columns,
  sorting,
  globalFilter,
  setSorting,
  setGlobalFilter,
  link,
  link2,
  getemp,
}) => {
  /* REDUX */
  const tokenS = useSelector((state) => state.auth.session.token);
  const themeColor = useSelector((state) => state.theme.themeColor);
  const Path = useSelector((state) => state.base.common.Path);
  const LoginId = useSelector((state) => state.auth.session.LoginId);
  const mode = useSelector((state) => state.theme.mode);
  const channel = useSelector((state) => state.locale.selectedChannel);
  /* STATES */
  const [dialogIsOpen, setIsOpen] = useState(false);
  const [dialogChannelsIsOpen, setIsOpen2] = useState(false);
  const [dialogCopyRightIsOpen, setDialogCopyRightIsOpen] = useState(false);
  const [LoginName, setLoginName] = useState(false);
  const [Password, setPassword] = useState('');
  const [confirmPassword, setConfirmPassword] = useState('');
  const [validationErrors, setValidationErrors] = useState([]);
  const [ShowconfirmPassword, setShowconfirmPassword] = useState(true);
  const [PasswordMatch, setPasswordMatch] = useState(false);
  const [LoginCode, setLoginCode] = useState(false);
  const [message, setmessage] = useState(false);
  const [employee, setemployee] = useState(false);
  const [ChannelList, setChannelList] = useState([]);
  const [selectedChannels, setselectedChannels] = useState([]);
  const [selectedUser, setselectedUser] = useState();
  const [rowselectedUser, setrowselectedUser] = useState();
  const [UsersList, setUsersList] = useState([]);
  const [pwInputType, setPwInputType] = useState('password');
  const [pwInputType2, setPwInputType2] = useState('password');
  const [loader, setLoader] = useState(false);

  /* USE EFFECTS */
  useEffect(() => {
    (async (values) => {
      const resp = await apiGetChannelmasterdrop(LoginId);
      const channels = resp.data.map((channel) => {
        let res = {};
        res.name = channel.ChannelName;
        res.ChannelCode = channel.ChannelCode;
        res.label = channel.LocationName + '-' + channel.ChannelName;
        res.value = channel.LocationCode + '-' + channel.ChannelCode;
        // Below fields (label and value) is required by Elstar's <Select/> component
        res.LocationCode = channel.LocationCode;
        return res;
      });
      setChannelList(channels);
    })();
  }, []);

  /* EVENT HANDLERS */
  const openDialogChannels = (empdetails) => {
    getChannelsEmployee(empdetails.EmployeeCode)
      .then((response) => response.data)
      .then((data) => {
        let res = channelsAssignedToEmployeeConversion(data);
        const channels = res.map((channel) => {
          let res = {};
          res.name = channel.label;
          res.ChannelCode = channel.ChannelCode;
          res.label = channel.label;
          res.value = channel.value;
          // Below fields (label and value) is required by Elstar's <Select/> component
          res.LocationCode = channel.LocationCode;
          return res;
        });
        setselectedChannels(channels);
        setIsOpen2(true);
      })
      .catch((error) => {
        console.error(error);
        setIsOpen2(true);
      });
    setLoginCode(empdetails.EmployeeCode);
  };

  const openDialogUserList = async (e) => {
    setrowselectedUser(e)
    setLoader(true)
    try {
      const resp = await apiGetEmployeemaster();
      const formatDate = resp.data.map((item) => ({ value: item.LoginCode, label: `${item.Emp_FirstName} ${item.Emp_LastName}` }))
      setUsersList(formatDate);
      setDialogCopyRightIsOpen(true);
    } catch (error) {
      setUsersList([]);
      setDialogCopyRightIsOpen(false);
    } finally {
      setLoader(false)
    }
  };


  const onDialogChannelsClose = (e) => {
    setIsOpen2(false);
  };

  const onDialogChannelsOk = (e) => {
    let data = [];
    selectedChannels.forEach((selectedChannel) => {
      let res = {};
      res.LoginCode = LoginCode;
      res.LocationCode = selectedChannel.LocationCode;
      res.ChannelCode = selectedChannel.ChannelCode;
      data.push(res);
    });
    console.log('data', data);
    Loginlocchnlmapping(data, tokenS, toastwe);
    setIsOpen2(false);
    setselectedChannels([]);
  };
  const copyRightApiSave = async () => {
    setLoader(true)
    try {
      const resp = await apipostcopyrights({ From: selectedUser.value, to: rowselectedUser.LoginCode })
      if (resp.status == 200) {
        openNotification('success', 'Rights Copy Succesfully')

        return
      }
      openNotification('warning', 'Somthing Went Wrong')
    } catch (error) {
      setUsersList([]);
      openNotification('warning', 'Somthing Went Wrong')
    } finally {
      setDialogCopyRightIsOpen(false);
      setselectedUser()
      setrowselectedUser()
      setLoader(false)
    }

  };


  const openDialog = (employee, msg) => {
    setLoginName(
      employee.LoginName !== 0
        ? employee.LoginName
        : employee.Emp_FirstName + employee.Emp_LastName + employee.Emp_Code,
    );
    setemployee(employee);
    if (msg !== 'Change password') {
      let pwd = generatePassword(employee);
      setConfirmPassword(pwd);
      setPassword(pwd);
      // setConfirmPassword(pwd)
    }
    setmessage(msg);
    setTimeout(() => {
      setIsOpen(true);
    }, 500);
  };

  const onDialogOk = () => {
    let values = {
      LoginName: LoginName,
      Password: Password,
      EmployeeCode: employee.EmployeeCode,
      DefaultLocChnlCode: 'DefaultLocChnlCode',
      RegisteredMobileNo: '1234567890',
      MPIN: '0000',
      TPIN: '1111',
      IsFinalize: 1,
      IsActive: 1,
      IsAdmin: 1,
      SuperAdmin: 1,
      AddedBy: 0,
    };
    Create_Login(values, tokenS, toastwe);
    setIsOpen(false);
  };

  const onPasswordVisibleClick = (e) => {
    e.preventDefault();
    setPwInputType(pwInputType === 'password' ? 'text' : 'password');
  };

  const onPasswordVisibleClick2 = (e) => {
    e.preventDefault();
    setPwInputType2(pwInputType2 === 'password' ? 'text' : 'password');
  };

  const onPaginationChange = (page) => {
    table.setPageIndex(page - 1);
  };

  const onSelectChange = (value) => {
    table.setPageSize(Number(value));
  };

  const handleExportToExcel = () => {
    //ExportXls(data,ExportName)
    const mapping = {};
    columns.forEach((item) => {
      if (item.accessorKey) {
        mapping[item.accessorKey] = item.header;
      }
    });
    // Update keys in the data array based on the mapping
    const updatedArray = table.getRowModel().rows.map((item) => {
      const updatedItem = {};
      Object.keys(item.original).forEach((key) => {
        if (mapping[key]) {
          updatedItem[mapping[key]] = item.original[key];
        } else {
          updatedItem[key] = item.original[key];
        }
      });
      return updatedItem;
    });
    ExportxlswithColor(
      false,
      false,
      0,
      0,
      true,
      updatedArray,
      'Emp Master',
      columns,
      false,
    );
    return;
  };

  const onDialogClose = () => {
    setPassword('');
    setConfirmPassword('');
    setIsOpen(false);
    setPwInputType2('password');
    setPwInputType('password');
    setShowconfirmPassword(true);
    setPasswordMatch(false);
    setValidationErrors([]);
  };

  /* HELPER FUNCTIONS */
  const Create_Login = async (values, token, toastwe) => {
    try {
      const resp = await CreateLogin(values, token, channel);
      if (resp.status === 200) {
        toastwe.push(
          <Notification title={'success'} type={'success'}>
            Login Created Successfully
          </Notification>,
        );

        return;
      } else {
        toastwe.push(
          <Notification title={'danger'} type={'danger'}>
            {resp.detail}
          </Notification>,
        );
        return;
      }
    } catch (error) {
      toastwe.push(
        <Notification title={'warning'} type={'warning'}>
          {error.response.data.detail}
        </Notification>,
      );
      return {};
    }
  };

  const Loginlocchnlmapping = async (values, token, toastwe) => {
    try {
      const resp = await loginlocchnlmapping(values, token);
      if (resp.status === 200) {
        toastwe.push(
          <Notification title={'success'} type={'success'}>
            Channels Assigned Successfully
          </Notification>,
        );
        return;
      } else {
        toastwe.push(
          <Notification title={'warning'} type={'warning'}>
            {resp.detail}
          </Notification>,
        );
        return;
      }
    } catch (error) {
      toastwe.push(
        <Notification title={'warning'} type={'warning'}>
          {error.response.data.detail}
        </Notification>,
      );
      return {};
    }
  };

  function channelsAssignedToEmployeeConversion(array1) {
    const array2 = array1.map((object) => {
      const channelCode = object.Channel.ChannelCode;
      const channelName = object.Channel.ChannelName;
      const LocationCode = object.locations.LocationCode;
      const LocationName = object.locations.LocationName;
      return {
        name: channelName,
        ChannelCode: channelCode,
        LocationCode: LocationCode,
        // Below fields (label and value) is required by Elstar's <Select/> component
        label: LocationName + '-' + channelName,
        value: LocationCode + '-' + channelCode,
      };
    });

    return array2;
  }

  const validatePassword = (password) => {
    const errors = [];
    if (password.length < passwordRequirements.minLength) {
      errors.push(
        `Password must be at least ${passwordRequirements.minLength} characters long.`,
      );
    } else if (!/[A-Z]/.test(password)) {
      errors.push('Password must contain at least one uppercase letter.');
    } else if (!/[a-z]/.test(password)) {
      errors.push('Password must contain at least one lowercase letter.');
    } else if (!/\d/.test(password)) {
      errors.push('Password must contain at least one number.');
    } else if (!/[^a-zA-Z0-9]/.test(password)) {
      errors.push('Password must contain at least one special symbol.');
    }
    if (errors.length === 0) {
      setShowconfirmPassword(false);
    }
    setValidationErrors(errors);
  };

  /* HELPER COMPONENTS */
  const inputIcon = (
    <span className="cursor-pointer" onClick={(e) => onPasswordVisibleClick(e)}>
      {pwInputType === 'password' ? <HiOutlineEyeOff /> : <HiOutlineEye />}
    </span>
  );

  const inputIconw = (
    <span
      className="cursor-pointer"
      onClick={(e) => onPasswordVisibleClick2(e)}
    >
      {pwInputType2 === 'password' ? <HiOutlineEyeOff /> : <HiOutlineEye />}
    </span>
  );

  /* TABLE PROPERTIES */
  const table = useReactTable({
    data,
    columns,
    state: {
      sorting,
      globalFilter: globalFilter.toUpperCase(),
    },
    onSortingChange: setSorting,
    onGlobalFilterChange: setGlobalFilter,
    enableColumnResizing: true,
    getCoreRowModel: getCoreRowModel(),
    getSortedRowModel: getSortedRowModel(),
    getFilteredRowModel: getFilteredRowModel(),
    getPaginationRowModel: getPaginationRowModel(),
  });
  const totalData = data.length;

  return (
    <div className="root-container">
      {!loader && (
        <Table className="table">
          <THead
            className="border-b-1"
            style={{
              borderColor: themeColor,
              height: '4%',
            }}
            variant="solid"
          >
            {table.getHeaderGroups().map((headerGroup) => (
              <Tr key={headerGroup.id} className="tr3">
                <Th
                  className={mode == 'dark' ? 'srno th' : 'srno th Light'}
                  style={{ textAlign: 'Center' }}
                >
                  <h6
                    className={
                      mode == 'dark'
                        ? 'capitalize text-xs'
                        : 'capitalize text-xs Light'
                    }
                  >
                    Sr.
                  </h6>
                </Th>
                {headerGroup.headers.map((header) => {
                  return (
                    <Th key={header.id} colSpan={header.colSpan}>
                      <h6 className="capitalize text-xs">
                        {header.isPlaceholder ? null : (
                          <div
                            {...{
                              className: header.column.getCanSort()
                                ? 'cursor-pointer select-none'
                                : '',
                              onClick: header.column.getToggleSortingHandler(),
                            }}
                          >
                            {flexRender(
                              header.column.columnDef.header,
                              header.getContext(),
                            )}
                            {
                              <>
                                <Sorter sort={header.column.getIsSorted()} />
                                <div
                                  className={`cursor-all-scroll ${header.column.getIsResizing()
                                    ? 'isResizing'
                                    : ''
                                    }`}
                                  onMouseDown={header.getResizeHandler()}
                                  onTouchStart={header.getResizeHandler()}
                                ></div>
                              </>
                            }
                          </div>
                        )}
                      </h6>
                    </Th>
                  );
                })}
                <Th>
                  <h6 className="text-xs capitalize">Actions</h6>
                </Th>
              </Tr>
            ))}
          </THead>
          {data.length == 0 && (
            <div className="flex justify-center mb-3 pt-3">
              <h6>No Record Found!</h6>
            </div>
          )}
          <TBody className="tbody">
            {table.getRowModel().rows.map((row, index) => {
              const currentPage = table.getState().pagination.pageIndex;
              const pageSize = table.getState().pagination.pageSize;
              const serialNumber = currentPage * pageSize + index + 1;
              return (
                <Tr key={row.id} className="tr">
                  <Td
                    className={
                      mode == 'dark'
                        ? 'text-xs text-center srno td'
                        : 'text-xs text-center srno tdLight'
                    }
                  >
                    {serialNumber}
                  </Td>
                  {row.getVisibleCells().map((cell) => {
                    return (
                      <Td
                        key={cell.id}
                        className={
                          mode == 'dark'
                            ? 'text-xs font-medium actions td'
                            : 'text-xs font-medium actions tdLight'
                        }
                      >
                        {flexRender(
                          cell.column.columnDef.cell,
                          cell.getContext(),
                        )}
                      </Td>
                    );
                  })}
                  {Path == '/UserMaster' ? (
                    <Td
                      className={
                        mode == 'dark'
                          ? 'text-xs font-medium actions td'
                          : 'text-xs font-medium actions tdLight'
                      }
                    >
                      <Link
                        to={link}
                        state={{ editData: row.original }}
                        size="xs"
                        variant="twoTone"
                      >
                        <Tooltip title="Edit Details">
                          <Button
                            size="xs"
                            variant="twoTone"
                            icon={<HiOutlinePencil />}
                          ></Button>
                        </Tooltip>
                      </Link>
                      &nbsp;
                      <Tooltip
                        title={
                          row.original.LoginCode
                            ? 'Change password'
                            : 'Create Login'
                        }
                      >
                        <Button
                          size="xs"
                          variant="twoTone"
                          icon={<HiOutlineUser />}
                          onClick={() =>
                            openDialog(
                              row.original,
                              row.original.LoginCode
                                ? 'Change password'
                                : 'Create Login',
                            )
                          }
                        ></Button>
                      </Tooltip>
                      {row.original.Emp_BloodGroup != null && (
                        <Link
                          to={link2 + row.original.EmployeeCode}
                          state={{ editData: row.original }}
                          size="xs"
                          variant="twoTone"
                          className="ml-1"
                        >
                          <Tooltip title={`Access Control`}>
                            <Button
                              size="xs"
                              variant="twoTone"
                              icon={<HiEye />}
                            ></Button>
                          </Tooltip>
                        </Link>
                      )}
                      &nbsp;
                      {row.original.Emp_BloodGroup != null && (
                        <Tooltip title="Assign Channels">
                          <Button
                            size="xs"
                            variant="twoTone"

                            icon={<FaChromecast />}
                            onClick={() => openDialogChannels(row.original)}
                          ></Button>
                        </Tooltip>
                      )}
                      {row.original.Emp_BloodGroup != null && (
                        <Tooltip title="Copy Rights">
                          <Button
                            size="xs"
                            variant="twoTone"
                            className="ml-1"
                            icon={<FaRegCopy />}
                            onClick={() => openDialogUserList(row.original)}
                          ></Button>
                        </Tooltip>
                      )}
                    </Td>
                  ) : (
                    <Td
                      className={
                        mode == 'dark'
                          ? 'text-xs font-medium actions td'
                          : 'text-xs font-medium actions tdLight'
                      }
                    >
                      <Tooltip
                        title={
                          row.original.LoginCode != 0
                            ? 'Change password'
                            : 'Create Login'
                        }
                      >
                        <Button
                          size="xs"
                          className="mr-2"
                          variant="twoTone"
                          icon={<HiOutlineUser />}
                          onClick={() =>
                            openDialog(
                              row.original,
                              row.original.LoginCode != 0
                                ? 'Change password'
                                : 'Create Login',
                            )
                          }
                        ></Button>
                      </Tooltip>
                      {row.original.LoginCode != 0 && (
                        <Tooltip title="Approve ">
                          <Button
                            onClick={() => {
                              setLoader(true);
                              const { EmployeeCode, LoginCode } = row.original;
                              try {
                                (async () => {
                                  const resp =
                                    await apiGetEmployeemasterApproved(
                                      EmployeeCode,
                                      LoginCode,
                                      1,
                                    );
                                  if (resp.status == 200) {
                                    openNotification(
                                      'success',
                                      'User has been Approved !!',
                                    );
                                    getemp();
                                    setLoader(false);
                                  }

                                  if (resp.status == 204) {
                                    openNotification(
                                      'warnig',
                                      'Data Not Found !!',
                                    );
                                    setLoader(false);
                                  }
                                })();
                              } catch (error) {
                                if (error.response.status == 404) {
                                  openNotification(
                                    'success',
                                    'Action Already Taken!!',
                                  );
                                  setLoader(false);
                                }
                              }
                            }}
                            className="mr-2"
                            size="xs"
                            variant="twoTone"
                            icon={<HiOutlineBadgeCheck />}
                          ></Button>
                        </Tooltip>
                      )}
                      <Tooltip title="Reject">
                        <Button
                          size="xs"
                          className="mr-2"
                          variant="twoTone"
                          onClick={() => {
                            setLoader(true);
                            const { EmployeeCode, LoginCode } = row.original;
                            try {
                              (async (values) => {
                                const resp = await apiGetEmployeemasterApproved(
                                  EmployeeCode,
                                  LoginCode,
                                  2,
                                );
                                if (resp.status == 200) {
                                  openNotification(
                                    'danger',
                                    'User has been Rejected !!',
                                  );
                                  getemp();
                                  setLoader(false);
                                }

                                if (resp.status == 204) {
                                  openNotification(
                                    'warnig',
                                    'Data Not Found !!',
                                  );
                                  setLoader(false);
                                }
                              })();
                            } catch (error) {
                              if (error.response.status == 404) {
                                openNotification(
                                  'success',
                                  'Action Already Taken!!',
                                );
                                setLoader(false);
                              }
                            }
                          }}
                          icon={<CgClose />}
                        ></Button>
                      </Tooltip>
                    </Td>
                  )}
                </Tr>
              );
            })}
          </TBody>
        </Table>
      )}
      <div className="bottom-actions-container">
        <div className="flex items-center justify-between mt-1">
          <Pagination
            pageSize={table.getState().pagination.pageSize}
            currentPage={table.getState().pagination.pageIndex + 1}
            total={totalData}
            onChange={onPaginationChange}
          />
          <div className="flex items-center justify-end mt-1">
            <Button
              className="mr-2"
              onClick={handleExportToExcel}
              style={{ width: 130 }}
              block
              size="sm"
              icon={<HiDownload />}
            >
              Export
            </Button>
            {data.length > 10 ? (
              <div style={{ minWidth: 130 }}>
                <Select
                  size="sm"
                  isSearchable={false}
                  value={pageSizeOption.filter(
                    (option) =>
                      option.value === table.getState().pagination.pageSize,
                  )}
                  options={pageSizeOption}
                  onChange={(option) => onSelectChange(option.value)}
                />
              </div>
            ) : null}
          </div>
        </div>
        <div className="flex  justify-end mt-2">
          <h1 className="text-xs  font-light">
            Records : {table.getRowModel().rows.length}
          </h1>
        </div>
      </div>
      <Dialog isOpen={dialogIsOpen} width={390} onClose={onDialogClose}>
        <div className="flex flex-col h-full justify-between">
          <h5 className="mb-4">{message}</h5>
          <div className="mb-4">
            <Input
              placeholder="Enter your name"
              prefix={<HiOutlineUser className="text-lg" />}
              value={LoginName}
              disabled={message === 'Change password'}
              onChange={(e) => setLoginName(e.target.value)}
            />
          </div>
          <div>
            <Input
              type={pwInputType}
              value={Password}
              onChange={(e) => setPassword(e.target.value)}
              suffix={inputIcon}
              onBlur={(e) => validatePassword(e.target.value)}
              onPaste={(e) => {
                e.preventDefault();
                return false;
              }}
              onCopy={(e) => {
                e.preventDefault();
                return false;
              }}
              maxLength="20"
              placeholder="New Password"
            />
            {validationErrors.length > 0 && (
              <ul>
                {validationErrors.map((error) => (
                  <li className="text-red-600" key={error}>
                    {error}
                  </li>
                ))}
              </ul>
            )}
            {/* {message === 'Change password' && ( */}
            <div style={{ marginTop: '15px' }}>
              <Input
                type={pwInputType2} // Use the same type as the password field
                value={confirmPassword}
                disabled={ShowconfirmPassword}
                maxLength="20" // Store the confirm password value
                onChange={(e) => setConfirmPassword(e.target.value)}
                onBlur={(e) => setPasswordMatch(Password == e.target.value)}
                onPaste={(e) => {
                  e.preventDefault();
                  return false;
                }}
                onCopy={(e) => {
                  e.preventDefault();
                  return false;
                }}
                suffix={inputIconw} // Optional: Add the same suffix icon if desired
                placeholder="Confirm Password"
              />
              {!PasswordMatch && !ShowconfirmPassword && (
                <div className="text-red-500 text-sm mt-1">
                  Passwords do not match.
                </div>
              )}
            </div>
            {/* )} */}
          </div>
          <div className="text-right mt-6">
            <Button
              className="ltr:mr-2 rtl:ml-2"
              variant="plain"
              onClick={() => onDialogClose(setPassword, setConfirmPassword)}
            >
              Cancel
            </Button>

            <Button
              disabled={!PasswordMatch}
              variant="solid"
              onClick={() => {
                if (message === 'Change password') {
                  let data = {};
                  data.password = Password;
                  loginupdate(employee.LoginCode, data, tokenS).then((resp) => {
                    if (resp.status === 200) {
                      toastwe.push(
                        <Notification title={'success'} type={'success'}>
                          Password Updated Successfully
                        </Notification>,
                      );
                      setIsOpen(false);
                    } else {
                      toastwe.push(
                        <Notification title={'danger'} type={'danger'}>
                          {resp.detail}
                        </Notification>,
                      );
                    }
                  });
                } else {
                  onDialogOk();
                }
              }}
            >
              Submit
            </Button>
          </div>
        </div>
      </Dialog>
      <Dialog
        isOpen={dialogChannelsIsOpen}
        onClose={onDialogChannelsClose}
        onRequestClose={onDialogChannelsClose}
      >
        <div>
          <h5 className="mb-4">Assign Channels</h5>
          <div>
            <Select
              isMulti
              placeholder="Select"
              options={ChannelList}
              value={selectedChannels}
              onChange={(e) => {
                setselectedChannels(e);
              }}
              styles={{
                valueContainer: (base) => ({
                  ...base,
                  padding: '5px 8px',
                }),
                multiValue: (base) => ({
                  ...base,
                  marginRight: '8px',
                  marginBlock: '5px',
                }),
                input: (base) => ({
                  ...base,
                  color: 'white',
                }),
              }}
            />
          </div>
          <div className="text-right mt-6">
            <Button
              className="ltr:mr-2 rtl:ml-2"
              variant="plain"
              onClick={onDialogChannelsClose}
            >
              Cancel
            </Button>
            <Button
              variant="solid"
              disabled={selectedChannels.length == 0}
              onClick={onDialogChannelsOk}
            >
              Assign
            </Button>
          </div>
        </div>
      </Dialog>
      <Dialog
        isOpen={dialogCopyRightIsOpen}
        onClose={() => { setDialogCopyRightIsOpen(false); setselectedUser(); setrowselectedUser() }}
        onRequestClose={() => { setDialogCopyRightIsOpen(false); setselectedUser(); setrowselectedUser() }}
      >
        <div>
          <h5 className="mb-4">Copy Right</h5>
          <div>
            <Select
              placeholder="Select"
              options={UsersList}
              value={UsersList.filter((item) => item.value == selectedUser?.value)}
              onChange={(e) => {
                setselectedUser(e);
              }}
              styles={{
                valueContainer: (base) => ({
                  ...base,
                  padding: '5px 8px',
                }),
                multiValue: (base) => ({
                  ...base,
                  marginRight: '8px',
                  marginBlock: '5px',
                }),
                input: (base) => ({
                  ...base,
                  color: 'white',
                }),
              }}
            />
          </div>
          <div className="text-right mt-6">
            <Button
              className="ltr:mr-2 rtl:ml-2"
              variant="plain"
              onClick={() => { setDialogCopyRightIsOpen(false); setselectedUser(); setrowselectedUser() }}
            >
              Cancel
            </Button>
            <Button
              variant="solid"
              disabled={!selectedUser}
              onClick={copyRightApiSave}
            >
              Assign
            </Button>
          </div>
        </div>
      </Dialog>
      <Loader showLoader={loader} />
    </div>
  );
};

export default DisplayTableEmp;
