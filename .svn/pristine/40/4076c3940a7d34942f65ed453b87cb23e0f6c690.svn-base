{"version":3,"file":"static/js/1600.7ed78bb9.chunk.js","mappings":"yNAsJA,QA3IA,SAAoC,GAAoC,IAApC,aAAEA,EAAY,gBAAEC,GAAiB,EAEnE,MAAMC,GAAUC,EAAAA,EAAAA,cAAaC,GAAUA,EAAMC,OAAOC,kBAC9CC,GAAkBJ,EAAAA,EAAAA,cACrBC,GAAUA,EAAMI,KAAKC,QAAQC,sBAI1B,oBAAEC,EAAmB,KAAEC,IAASC,EAAAA,EAAAA,YAAWC,EAAAA,IAG1CC,EAAMC,IAAWC,EAAAA,EAAAA,UAAS,CAAEC,UAAW,GAAIC,QAAS,KAGrDC,EAAgB,KACpBJ,EAAQ,CAAEE,UAAW,GAAIC,QAAS,KAClClB,GAAgB,EAAM,EA2BlBoB,EAAe,KACnB,IACE,IAAIC,EAAY,GACZC,EAAW,KACbC,EAAS,KACX,IAAK,IAAIC,EAAQ,EAAGA,EAAQd,EAAoBe,OAAQD,IAAS,CAC/D,MAAME,EAAMhB,EAAoBc,IAC3BF,GAAYI,EAAIC,UAAYb,EAAKG,YACpCK,EAAWI,GAGXJ,GACAI,EAAIE,SAAWN,EAASM,UACxBF,EAAIC,UAAYb,EAAKI,UAErBK,EAASG,GAENH,GAAUC,IAAUd,EAAoBe,OAAS,IACpDF,EAASG,EAEb,CAMA,OALIJ,GAAYC,IACdF,EAAY,IAAIX,GAAqBmB,MACnCP,EAASM,SACTL,EAAOK,SAAW,IAEfP,CAGT,CAFE,MAAOS,GACP,MAAMA,CACR,GAGF,OACE,UAAC,KAAM,CACLC,OAAQhC,EACRiC,QAASb,EACTc,eAAgBd,EAAc,WAE9B,eAAIe,UAAU,OAAM,qCACpB,iBAAKA,UAAU,OAAM,WACnB,eAAGA,UAAU,kBAAiB,yBACjB,iBAAMA,UAAU,eAAc,mBAE3C,SAAC,KAAK,CACJC,KAAK,KACLC,MAAOtB,EAAKG,UACZoB,SAAWC,GACTvB,GAASwB,IAAI,kBACRA,GAAI,IACPtB,WAAWuB,EAAAA,EAAAA,kBAAiBF,EAAOxB,EAAKG,eAG5CwB,OAAQ,IACN1B,GAASwB,IAAI,kBACRA,GAAI,IACPtB,WAAWyB,EAAAA,EAAAA,kBAAiB5B,EAAKG,eAGrC0B,YAAY,oBAGhB,4BACE,eAAGT,UAAU,kBAAiB,uBACnB,iBAAMA,UAAU,eAAc,mBAEzC,SAAC,KAAK,CACJC,KAAK,KACLC,MAAOtB,EAAKI,QACZmB,SAAWC,GACTvB,GAASwB,IAAI,kBACRA,GAAI,IACPrB,SAASsB,EAAAA,EAAAA,kBAAiBF,EAAOxB,EAAKI,aAG1CuB,OAAQ,IACN1B,GAASwB,IAAI,kBACRA,GAAI,IACPrB,SAASwB,EAAAA,EAAAA,kBAAiB5B,EAAKI,aAGnCyB,YAAY,oBAGhB,gBAAKT,UAAU,kBAAiB,UAC9B,SAAC,KAAM,CACLU,QAAQ,QACRC,SAAoC,KAA1B/B,EAAKG,UAAUQ,QAAyC,KAAxBX,EAAKI,QAAQO,OACvDqB,QA/GaC,UACnB,IACE,MAAM1B,EAAYD,IACO,IAArBC,EAAUI,QACZuB,EAAAA,EAAAA,kBAAiB,OAAQ,qDAEnBC,EAAAA,EAAAA,IACJtC,EACAV,EACAoB,EACAf,EAAgB4C,QACbC,GACCA,EAAKC,QAAQC,cAAgBpD,EAAQoD,aACrCF,EAAKG,UAAUC,eAAiBtD,EAAQsD,eAC1C,IAENpC,GAIF,CAHE,MAAOW,IACPkB,EAAAA,EAAAA,kBAAiB,SAAU,wCAC3BQ,QAAQ1B,MAAMA,EAChB,GA2F4B,wBAOhC,C","sources":["views/Scheduling/Scheduler/components/SchedulingArea/components/Toolbar/components/PartialPlayoutExportDialog.js"],"sourcesContent":["import { Button, Dialog, Input } from 'components/ui';\r\nimport React, { useContext, useState } from 'react';\r\nimport {\r\n  autoCompleteTime,\r\n  getFormattedTime,\r\n  openNotification,\r\n} from 'views/Controls/GLOBALFUNACTION';\r\nimport { exportPlayout } from '../utils/utils';\r\nimport { useSelector } from 'react-redux';\r\nimport SchedulerContext from 'views/Scheduling/Scheduler/context/SchedulerContext';\r\n\r\nfunction PartialPlayoutExportDialog({ isDialogOpen, setIsDialogOpen }) {\r\n  /* REDUX */\r\n  const channel = useSelector((state) => state.locale.selectedChannel);\r\n  const channelSettings = useSelector(\r\n    (state) => state.auth.session.ChannelSettingMain,\r\n  );\r\n\r\n  /* CONTEXT */\r\n  const { schedulingTableData, date } = useContext(SchedulerContext);\r\n\r\n  /* STATES */\r\n  const [time, setTime] = useState({ startTime: '', endTime: '' });\r\n\r\n  /* EVENT HANDLERS */\r\n  const onDialogClose = () => {\r\n    setTime({ startTime: '', endTime: '' });\r\n    setIsDialogOpen(false);\r\n  };\r\n\r\n  const handleExport = async () => {\r\n    try {\r\n      const tableData = getTableData();\r\n      if (tableData.length === 0)\r\n        openNotification('info', 'No events to export for selected time range');\r\n      else\r\n        await exportPlayout(\r\n          date,\r\n          channel,\r\n          tableData,\r\n          channelSettings.filter(\r\n            (item) =>\r\n              item.Channel.ChannelCode === channel.ChannelCode &&\r\n              item.locations.LocationCode === channel.LocationCode,\r\n          )[0],\r\n        );\r\n      onDialogClose();\r\n    } catch (error) {\r\n      openNotification('danger', 'Something went wrong while exporting');\r\n      console.error(error);\r\n    }\r\n  };\r\n\r\n  /* HELPER FUNCTIONS */\r\n  const getTableData = () => {\r\n    try {\r\n      let tableData = [];\r\n      let startRow = null,\r\n        endRow = null;\r\n      for (let index = 1; index < schedulingTableData.length; index++) {\r\n        const row = schedulingTableData[index];\r\n        if (!startRow && row.Tel_Time >= time.startTime) {\r\n          startRow = row;\r\n        }\r\n        if (\r\n          startRow &&\r\n          row.rowIndex > startRow.rowIndex &&\r\n          row.Tel_Time <= time.endTime\r\n        ) {\r\n          endRow = row;\r\n        }\r\n        if (!endRow && index === schedulingTableData.length - 1) {\r\n          endRow = row;\r\n        }\r\n      }\r\n      if (startRow && endRow)\r\n        tableData = [...schedulingTableData].slice(\r\n          startRow.rowIndex,\r\n          endRow.rowIndex + 1,\r\n        );\r\n      return tableData;\r\n    } catch (error) {\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Dialog\r\n      isOpen={isDialogOpen}\r\n      onClose={onDialogClose}\r\n      onRequestClose={onDialogClose}\r\n    >\r\n      <h5 className=\"mb-4\">Partial Playout Export</h5>\r\n      <div className=\"mb-4\">\r\n        <p className=\"mb-1 text-white\">\r\n          Start Time <span className=\"text-red-500\">*</span>\r\n        </p>\r\n        <Input\r\n          size=\"sm\"\r\n          value={time.startTime}\r\n          onChange={(event) =>\r\n            setTime((prev) => ({\r\n              ...prev,\r\n              startTime: getFormattedTime(event, time.startTime),\r\n            }))\r\n          }\r\n          onBlur={() =>\r\n            setTime((prev) => ({\r\n              ...prev,\r\n              startTime: autoCompleteTime(time.startTime),\r\n            }))\r\n          }\r\n          placeholder=\"HH:MM:SS:FF\"\r\n        />\r\n      </div>\r\n      <div>\r\n        <p className=\"mb-1 text-white\">\r\n          End Time <span className=\"text-red-500\">*</span>\r\n        </p>\r\n        <Input\r\n          size=\"sm\"\r\n          value={time.endTime}\r\n          onChange={(event) =>\r\n            setTime((prev) => ({\r\n              ...prev,\r\n              endTime: getFormattedTime(event, time.endTime),\r\n            }))\r\n          }\r\n          onBlur={() =>\r\n            setTime((prev) => ({\r\n              ...prev,\r\n              endTime: autoCompleteTime(time.endTime),\r\n            }))\r\n          }\r\n          placeholder=\"HH:MM:SS:FF\"\r\n        />\r\n      </div>\r\n      <div className=\"text-right mt-6\">\r\n        <Button\r\n          variant=\"solid\"\r\n          disabled={time.startTime.length !== 11 || time.endTime.length !== 11}\r\n          onClick={handleExport}\r\n        >\r\n          Export\r\n        </Button>\r\n      </div>\r\n    </Dialog>\r\n  );\r\n}\r\n\r\nexport default PartialPlayoutExportDialog;\r\n"],"names":["isDialogOpen","setIsDialogOpen","channel","useSelector","state","locale","selectedChannel","channelSettings","auth","session","ChannelSettingMain","schedulingTableData","date","useContext","SchedulerContext","time","setTime","useState","startTime","endTime","onDialogClose","getTableData","tableData","startRow","endRow","index","length","row","Tel_Time","rowIndex","slice","error","isOpen","onClose","onRequestClose","className","size","value","onChange","event","prev","getFormattedTime","onBlur","autoCompleteTime","placeholder","variant","disabled","onClick","async","openNotification","exportPlayout","filter","item","Channel","ChannelCode","locations","LocationCode","console"],"sourceRoot":""}