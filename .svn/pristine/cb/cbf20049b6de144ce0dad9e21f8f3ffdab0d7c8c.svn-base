"use strict";(self.webpackChunkelstar=self.webpackChunkelstar||[]).push([[7194],{97194:(e,t,s)=>{s.r(t),s.d(t,{default:()=>N});var a=s(72791),n=s(81721),r=s(60364),l=s(91615),c=s(81320),o=s(54748),i=s(36064),d=s(2803),h=s(43235),u=s(80184);const m=function(e){let{isOpen:t,setIsOpen:s,clickedDateEvent:n,setClickedDateEvent:c}=e;const o=(0,r.useSelector)((e=>e.locale.selectedChannel)),{setDate:i,setLoadUnsavedWork:m,unsavedWorkState:x}=(0,a.useContext)(l.Z),p=()=>{try{c(null),s(!1)}catch(e){console.error(e)}},y=e=>{try{i(n.start),m(e),p()}catch(t){console.error(t)}};return(0,u.jsx)(u.Fragment,{children:n&&x&&(0,u.jsxs)(d.Vq,{isOpen:t,onClose:p,onRequestClose:p,children:[(0,u.jsx)("h5",{className:"mb-4",children:"Unsaved work detected"}),(0,u.jsxs)("div",{className:"mt-4 flex flex-col",children:[(0,u.jsxs)("div",{className:"py-3 border-b border-dashed border-b-gray-700 flex justify-between",children:[(0,u.jsx)("p",{className:"text-[0.95rem]",children:"Channel"}),(0,u.jsxs)("p",{className:"text-white text-base",children:[o.LocationName," ",o.ChannelName]})]}),(0,u.jsxs)("div",{className:"py-3 border-b border-dashed border-b-gray-700 flex justify-between",children:[(0,u.jsx)("p",{className:"text-[0.95rem]",children:"Schedule date"}),(0,u.jsx)("p",{className:"text-white  text-base",children:(0,h.WU)(n.start,"dd-MMM-yyyy")})]}),(0,u.jsxs)("div",{className:"py-3 border-b border-dashed border-b-gray-700 flex justify-between",children:[(0,u.jsx)("p",{className:"text-[0.95rem]",children:"Last worked timestamp"}),(0,u.jsx)("p",{className:"text-white text-base",children:(0,h.WU)(x.timeStamp,"hh:mm aaaa, dd-MMM-yyyy").replaceAll(".","")})]})]}),(0,u.jsxs)("div",{className:"mt-6 flex justify-between items-center",children:[(0,u.jsx)("p",{className:"text-white",children:"Do you want to load unsaved work now?"}),(0,u.jsxs)("div",{children:[(0,u.jsx)(d.zx,{className:"mr-2",variant:"plain",onClick:()=>y(!1),children:"No"}),(0,u.jsx)(d.zx,{variant:"solid",onClick:()=>y(!0),children:"Yes"})]})]})]})})};var x=s(87350),p=s(21260),y=s(1680),b=s(9494);const g=e=>{let{isPageOpen:t,setIsPageOpen:s,messageShowToUser:a,setMessageShowToUser:n,handleUnsavedEvent:l,clickedDateEvent:c}=e;const o=(0,r.useSelector)((e=>e.locale.selectedChannel)),i=()=>{try{n(""),s(!1)}catch(e){console.error(e)}};return(0,u.jsx)("div",{children:c&&t&&(0,u.jsxs)(d.Vq,{isOpen:t,onClose:i,onRequestClose:i,width:600,children:[(0,u.jsx)("h5",{className:"mb-4",children:"Working On Same Page"}),(0,u.jsxs)("div",{className:"mt-4 flex flex-col",children:[(0,u.jsxs)("div",{className:"py-3 border-b border-dashed border-b-gray-700 flex justify-between",children:[(0,u.jsx)("p",{className:"text-[0.95rem]",children:"Channel"}),(0,u.jsxs)("p",{className:"text-white text-base",children:[o.LocationName," ",o.ChannelName]})]}),(0,u.jsxs)("div",{className:"py-3 border-b border-dashed border-b-gray-700 flex justify-between",children:[(0,u.jsx)("p",{className:"text-[0.95rem]",children:"Schedule date"}),(0,u.jsx)("p",{className:"text-white text-base",children:(0,h.WU)(c.start,"dd-MMM-yyyy")})]}),(0,u.jsxs)("div",{className:"py-3 border-b border-dashed border-b-gray-700 flex justify-between",children:[(0,u.jsx)("p",{className:"text-base",children:"Message"}),(0,u.jsx)("p",{className:"text-white text-[1rem]",children:a})]})]}),(0,u.jsxs)("div",{className:"mt-6 flex justify-between items-center",children:[(0,u.jsx)("p",{className:"text-white text-[0.95rem]",children:"Do you want to load the screen again?"}),(0,u.jsxs)("div",{children:[(0,u.jsx)(d.zx,{className:"mr-2",onClick:i,children:"No"}),(0,u.jsx)(d.zx,{variant:"solid",onClick:()=>{try{l(c),i()}catch(e){console.error(e)}},children:"Yes"})]})]})]})})};const N=function(){const e=(0,r.useDispatch)(),t=(0,r.useSelector)((e=>e.locale.selectedChannel)),s=(0,r.useSelector)((e=>e.auth.session.LoginId)),h=(0,r.useSelector)((e=>e.auth.scheduling.unsavedWork)),N=t.label===y.CLIENT.USA_Forbes,{page:j,setDate:C,setUnsavedWorkState:S,setShowLoader:f}=(0,a.useContext)(l.Z),[w,v]=(0,a.useState)(!1),[O,k]=(0,a.useState)(""),[E,M]=(0,a.useState)(new Date),[D,L]=(0,a.useState)(null),[I,P]=(0,a.useState)(null),[U,F]=(0,a.useState)(!1);(0,a.useEffect)((()=>{(async()=>{try{j&&t&&E&&(f(!0),L(await A()),f(!1))}catch(e){L(null),(0,c.openNotification)("danger","Something went wrong. Failed to fetch Daily FPC Status"),console.error(e)}})()}),[j,E,t]);const T=e=>{R(e.startStr)?F(!0):C(e.start)},A=async()=>{try{const e=j===p.pagesEnum.PROMO?"promo":j===p.pagesEnum.COMMERCIAL?"COM":j===p.pagesEnum.SONG?"SONG":j===p.pagesEnum.NTC?"NTC":j===p.pagesEnum.FINAL_LOG?"FINAL":null;if(e){const s=await(0,x.c0)({LocationCode:t.LocationCode,ChannelCode:t.ChannelCode,Screen:e},(0,o.Tk)(E));if(200===s.status)return 0===s.data.length&&(0,c.openNotification)("info","Daily FPC Status not found"),W(s.data);204===s.status?(0,c.openNotification)("info","Daily FPC Status not found"):(0,c.openNotification)("danger","Failed to fetch Daily FPC Status. Server responded with status code ".concat(s.status))}return null}catch(e){throw e}},W=e=>{try{let t=null;return j===p.pagesEnum.PROMO?t=(0,o.Jl)(e,"promoScheduling"):j===p.pagesEnum.COMMERCIAL?t=(0,o.Jl)(e,"commercialScheduling"):j===p.pagesEnum.SONG?t=(0,o.Jl)(e,"songScheduling"):j===p.pagesEnum.NTC?t=(0,o.Jl)(e):j===p.pagesEnum.FINAL_LOG&&(t=(0,o.Ad)(e,N)),t}catch(t){throw t}},R=e=>{try{return!!Object.keys(h[j]).includes(e)&&(S(h[j][e]),!0)}catch(t){throw t}};return(0,u.jsxs)(d.Zb,{className:"h-full",bodyClass:"h-full",children:[(0,u.jsx)(n.wr,{height:"parent",events:D,select:a=>{(async(e,a,n,r)=>{try{const l=(await(0,b.apiCallstoreprocedure)("USP_Sch_SchedulingSameDay",{Channel:t.ChannelCode,Location:t.LocationCode,TelecastDate:n,IsOpen:e,OpenBy:s,Page:a})).data[0].StatusMsg;v("Insert"!==l),r&&r("Insert"!==l),"Insert"!==l&&k(l)}catch(l){console.error(l),(0,c.openNotification)("danger","Unable to open schedule. Please try again later."),window.location.reload()}})(1,j,a.startStr,(s=>{if((0,c.isChannelSelected)(t)){D.some((e=>e.start===a.startStr))?(P(a),s||T(a)):(0,c.openNotification)("info","Daily FPC not available for selected date")}else e((0,i.ar)(!0))}))},datesSet:e=>{try{M(e.view.currentStart)}catch(t){(0,c.openNotification)("danger","Something went wrong while changing month"),console.error(t)}},selectable:!0}),(0,u.jsx)(m,{isOpen:U,setIsOpen:F,clickedDateEvent:I,setClickedDateEvent:P}),(0,u.jsx)(g,{isPageOpen:w,setIsPageOpen:v,messageShowToUser:O,setMessageShowToUser:k,handleUnsavedEvent:T,clickedDateEvent:I})]})}}}]);
//# sourceMappingURL=7194.b897c13c.chunk.js.map