(self.webpackChunkelstar=self.webpackChunkelstar||[]).push([[17,5682],{14509:(e,t,a)=>{"use strict";a.d(t,{Z:()=>D});var n=a(1413),s=a(45987),o=a(72791),r=a(81694),l=a.n(r),i=a(52007),c=a.n(i),d=a(81358),u=a(60676),h=a(45743),m=a(53388),p=a(66364),x=a.n(p),f=a(42854),g=a.n(f),N=a(26181),C=a.n(N),w=a(58617),v=a(80184);const y=["asElement","className","disabled","invalid","prefix","size","suffix","textArea","type","style","unstyle","field","form"],j=o.forwardRef(((e,t)=>{var a,r;const{asElement:i,className:c,disabled:p,invalid:f,prefix:N,size:j,suffix:D,textArea:b,type:S,style:R,unstyle:A,field:T,form:I}=e,z=(0,s.Z)(e,y),[Z,k]=(0,o.useState)(0),[B,F]=(0,o.useState)(0),[O,L]=(0,o.useState)(!1),[P,E]=(0,o.useState)(e.value||""),{themeColor:K,controlSize:q,primaryColorLevel:M,direction:V}=(0,d.ZR)(),G=null===(a=(0,u.cI)())||void 0===a?void 0:a.size,U=null===(r=(0,h.J2)())||void 0===r?void 0:r.size,J=j||U||G||q;var Y;"value"in e&&(z.value="undefined"===typeof(Y=e.value)||null===Y?"":Y,delete z.defaultValue);const _=(0,o.useMemo)((()=>{let e=!1;if(!x()(I)){const{touched:t,errors:a}=I,n=C()(t,null===T||void 0===T?void 0:T.name),s=C()(a,null===T||void 0===T?void 0:T.name);e=n&&s}return"boolean"===typeof f&&(e=f),e}),[I,f,T]),W="input-".concat(J," h-").concat(m.WS[J]),H="focus:ring-".concat(K,"-").concat(M," focus-within:ring-").concat(K,"-").concat(M," focus-within:border-").concat(K,"-").concat(M," focus:border-").concat(K,"-").concat(M),$="input-wrapper ".concat(N||D?c:""),Q=l()("input",!b&&W,!_&&H,N||D?"":c,p&&"input-disabled",_&&"input-invalid",b&&"input-textarea"),X=(0,o.useRef)(),ee=(0,o.useRef)(),te=(0,o.useRef)(),ae=(0,o.useRef)();(0,o.useEffect)((()=>{(()=>{var e,t;if(!X.current&&!ee.current)return;const a=null===X||void 0===X||null===(e=X.current)||void 0===e?void 0:e.offsetWidth,n=null===ee||void 0===ee||null===(t=ee.current)||void 0===t?void 0:t.offsetWidth;g()(a)&&g()(n)||(a&&k(a),n&&F(n))})()}),[N,D]),(0,o.useEffect)((()=>{if("webkitSpeechRecognition"in window){const t=new window.webkitSpeechRecognition;t.continuous=!1,t.interimResults=!1,t.lang="en-US",t.onresult=t=>{const a=t.results[0][0].transcript;if(E(a),null!==T&&void 0!==T&&T.onChange)T.onChange({target:{value:a,name:T.name}});else{if(te.current){te.current.value=a;const e=new Event("input",{bubbles:!0});te.current.dispatchEvent(e)}e.onChange&&e.onChange({target:{value:a,name:null===T||void 0===T?void 0:T.name}})}L(!1)},t.onend=()=>{L(!1)},t.onerror=e=>{L(!1)},ae.current=t}}),[T,e.onChange]);const ne=e=>.0625*e,se=(0,n.Z)((0,n.Z)({className:A?"":Q,disabled:p,type:S,ref:te,value:P,onChange:t=>{E(t.target.value),null!==T&&void 0!==T&&T.onChange&&T.onChange(t),e.onChange&&e.onChange(t)}},T),z),oe=(0,v.jsx)("textarea",(0,n.Z)({style:R},se)),re=(0,v.jsxs)("div",{className:"relative flex items-center",children:[(0,v.jsx)(i,(0,n.Z)({style:(0,n.Z)((0,n.Z)((0,n.Z)({},(()=>{const e="".concat(ne(Z)+1,"rem"),t="".concat(ne(B)+1,"rem");let a={};return"ltr"===V&&(N&&(a.paddingLeft=e),D&&(a.paddingRight=t)),"rtl"===V&&(N&&(a.paddingRight=e),D&&(a.paddingLeft=t)),a})()),R),{},{paddingRight:D?"2.5rem":void 0})},se)),"text"==S&&(0,v.jsx)(w.Vel,{className:l()("absolute right-3 text-xl cursor-pointer",{"text-blue-500":O}),onClick:()=>{ae.current&&(L(!0),ae.current.start())}})]});return b?oe:N||D?(0,v.jsxs)("span",{className:$,children:[N?(0,v.jsx)("div",{className:"input-suffix-start",ref:e=>X.current=e,children:N}):null,re,D?(0,v.jsx)("div",{className:"input-suffix-end",ref:e=>ee.current=e,children:D}):null]}):re}));j.propTypes={asElement:c().string,type:c().string,className:c().string,size:c().oneOf([m.zf.LG,m.zf.SM,m.zf.MD]),value:c().any,invalid:c().bool,suffix:c().oneOfType([c().string,c().node]),prefix:c().oneOfType([c().string,c().node]),unstyle:c().bool,onChange:c().func},j.defaultProps={type:"text",asElement:"input",className:"",unstyle:!1};const D=j},22900:(e,t,a)=>{"use strict";a.d(t,{ZA:()=>r,fp:()=>i,yS:()=>l});var n=a(54048),s=a(46152);const o=a(74569),r=async(e,t)=>{try{return s.Z.fetchData({method:"get",url:"/creditdebitmaster/?LocationCode=".concat(e.LocationCode,"&ChannelCode=").concat(e.ChannelCode),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}})}catch(a){throw a}},l=async(e,t)=>{try{return new Promise(((a,s)=>{let r={method:"post",maxBodyLength:1/0,url:n.Z.apiPrefix+"/creditdebitmaster/",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},data:e};o.request(r).then((e=>{a(e)})).catch((e=>{s(e)}))}))}catch(a){throw a}},i=(e,t)=>{try{return new Promise(((a,s)=>{let r={method:"put",maxBodyLength:1/0,url:n.Z.apiPrefix+"/invoice/invoicepaymentupdate/",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},data:e};o.request(r).then((e=>{a(e)})).catch((e=>{s(e)}))}))}catch(a){throw a}}},42264:(e,t,a)=>{"use strict";a.d(t,{Kc:()=>r,Ms:()=>i,Rd:()=>g,U2:()=>m,Vg:()=>l,Vm:()=>h,Yd:()=>c,ZI:()=>x,bn:()=>p,mz:()=>u,pf:()=>d,xS:()=>N,yv:()=>f});var n=a(54048),s=a(46152);const o=a(74569),r=(e,t,a,s,r)=>{try{return new Promise(((l,i)=>{let c={method:"post",maxBodyLength:1/0,url:n.Z.apiPrefix+"/asrun/?TelecastDate=".concat(t,"&LocationCode=").concat(a,"&ChannelCode=").concat(s),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},data:e};o.request(c).then((e=>{l(e)})).catch((e=>{i(e)}))}))}catch(l){throw new Error(l)}},l=(e,t)=>{let{filter:a,id:s,loginCode:r,fromDate:l,uptoDate:i,channelCode:c,locationCode:d}=e;try{return new Promise(((e,u)=>{let h={method:"get",url:n.Z.apiPrefix+"/invoice/getinvoice/?Filter=".concat(a,"&ID=").concat(s,"&LoginCode=").concat(r,"&FromDate=").concat(l,"&UptoDate=").concat(i,"&ChannelCode=").concat(c,"&LocationCode=").concat(d),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}};o.request(h).then((t=>{e(t)})).catch((e=>{u(e)}))}))}catch(u){throw new Error(u)}},i=(e,t)=>{try{return s.Z.fetchData({method:"get",url:"/invoiceseries/?LocationCode=".concat(e.LocationCode,"&ChannelCode=").concat(e.ChannelCode),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}})}catch(a){throw new Error(a)}},c=(e,t)=>{let{filter:a,id:s,loginCode:r,fromDate:l,uptoDate:i,channelCode:c,locationCode:d,SpotTypeCode:u}=e;try{return new Promise(((e,h)=>{let m={method:"get",url:n.Z.apiPrefix+"/invoice/gettelecastreport/?Filter=".concat(a,"&ID=").concat(s,"&LoginCode=").concat(r,"&FromDate=").concat(l,"&UptoDate=").concat(i,"&ChannelCode=").concat(c,"&LocationCode=").concat(d,"&SpotType=").concat(u),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}};o.request(m).then((t=>{e(t)})).catch((e=>{h(e)}))}))}catch(h){throw new Error(h)}},d=async(e,t)=>{try{return new Promise(((a,s)=>{let r={method:"post",maxBodyLength:1/0,url:n.Z.apiPrefix+"/invoiceseries/",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},data:e};o.request(r).then((e=>{a(e)})).catch((e=>{s(e)}))}))}catch(a){throw a}},u=(e,t,a)=>{try{return new Promise(((s,r)=>{let l={method:"put",maxBodyLength:1/0,url:n.Z.apiPrefix+"/invoiceseries/".concat(t),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},data:e};o.request(l).then((e=>{s(e)})).catch((e=>{r(e)}))}))}catch(s){throw new Error(s)}},h=(e,t)=>{let{filter:a,id:s,loginCode:r,fromDate:l,uptoDate:i,channelCode:c,locationCode:d}=e;try{return new Promise(((e,u)=>{let h={method:"get",url:n.Z.apiPrefix+"/invoice/getinvoiceNTC/?Filter=".concat(a,"&ID=").concat(s,"&LoginCode=").concat(r,"&FromDate=").concat(l,"&UptoDate=").concat(i,"&ChannelCode=").concat(c,"&LocationCode=").concat(d),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}};o.request(h).then((t=>{e(t)})).catch((e=>{u(e)}))}))}catch(u){throw new Error(u)}},m=(e,t)=>{try{return s.Z.fetchData({method:"get",url:"/invoiceseriesntc/?LocationCode=".concat(e.LocationCode,"&ChannelCode=").concat(e.ChannelCode),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}})}catch(a){throw new Error(a)}},p=async(e,t)=>{try{return new Promise(((a,s)=>{let r={method:"post",maxBodyLength:1/0,url:n.Z.apiPrefix+"/invoiceseriesntc/",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},data:e};o.request(r).then((e=>{a(e)})).catch((e=>{s(e)}))}))}catch(a){throw a}},x=(e,t,a)=>{try{return new Promise(((s,r)=>{let l={method:"put",maxBodyLength:1/0,url:n.Z.apiPrefix+"/invoiceseriesntc/".concat(t),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},data:e};o.request(l).then((e=>{s(e)})).catch((e=>{r(e)}))}))}catch(s){throw new Error(s)}},f=e=>{try{return s.Z.fetchData({method:"get",url:"/yeartaxdetail/",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}})}catch(t){throw t}},g=(e,t,a)=>{try{return new Promise(((s,r)=>{let l={method:"post",maxBodyLength:1/0,url:n.Z.apiPrefix+"/yeartaxdetail/?YearCode=".concat(e),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},data:t};o.request(l).then((e=>{s(e)})).catch((e=>{r(e)}))}))}catch(s){throw s}},N=(e,t,a,s)=>{try{return new Promise(((r,l)=>{let i={method:"post",maxBodyLength:1/0,url:n.Z.apiPrefix+"/asrun/asrunmatch/?LocationCode=".concat(t.LocationCode,"&ChannelCode=").concat(t.ChannelCode,"&IsNTC=").concat(s),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},data:e};o.request(i).then((e=>{r(e)})).catch((e=>{l(e)}))}))}catch(r){throw r}}},69744:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>V});var n=a(1413),s=a(45987),o=a(2803),r=a(14509),l=a(72791),i=a(58617),c=a(60364),d=a(81320),u=a(96361),h=a(87537),m=a(54748),p=a(76053),x=a(84373),f=a(42264),g=a(34786),N=a(80184);const C=function(e){let{isAddCNDialogOpen:t,setIsAddCNDialogOpen:a,noteType:s,setNoteType:r,setBills:i,setShowLoader:c,setCurPage:u,channel:C,loginId:w,token:v}=e;const[y,j]=(0,l.useState)([]),[D,b]=(0,l.useState)({client:"",datesRange:[null,null]});(0,l.useEffect)((()=>{try{(async()=>{if(t){const e=await(0,g.Q8)();if(200===e.status){let t=[];t=e.data.map((e=>({label:e.ClientName,value:e.ClientCode}))),j(t)}else 204===e.status?(0,d.openNotification)("info","No clients found!"):(0,d.openNotification)("error","Something went wrong. Server responded with status code ".concat(e.status))}})()}catch(e){console.error(e)}}),[t]);const S=()=>{try{j([]),b({client:"",datesRange:[null,null]}),a(!1)}catch(e){console.error(e)}},R=e=>{try{return 1!==s.value&&0!==s.value?((0,d.openNotification)("danger","Please select Credit/Debit note type!"),!1):""===e.client?((0,d.openNotification)("danger","Please select client!"),!1):null!==e.datesRange[0]&&null!==e.datesRange[1]||((0,d.openNotification)("danger","Please select valid date range!"),!1)}catch(t){throw t}};return(0,N.jsxs)(o.Vq,{isOpen:t,onClose:S,onRequestClose:S,closable:!1,children:[(0,N.jsxs)("div",{className:"flex justify-between relative items-center mb-4",children:[(0,N.jsx)("h5",{children:"Add Credit/Debit Note"}),(0,N.jsx)(o.zx,{shape:"circle",variant:"plain",icon:(0,N.jsx)(p.nfZ,{className:"text-gray-500"}),onClick:S,className:"absolute -top-4 -right-4"})]}),(0,N.jsxs)("div",{children:[(0,N.jsxs)("div",{children:[(0,N.jsxs)("p",{className:"text-white",children:["Type ",(0,N.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,N.jsxs)(o.Y8.Group,{value:s.value,onChange:e=>{r({value:e,label:1===e?"Credit":"Debit"})},className:"mt-2",children:[(0,N.jsx)(o.Y8,{value:1,children:"Credit"}),(0,N.jsx)(o.Y8,{value:0,children:"Debit"})]})]}),(0,N.jsxs)("div",{className:"mt-4",children:[(0,N.jsxs)("p",{className:"text-white",children:["Client ",(0,N.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,N.jsx)(o.Ph,{placeholder:"Select",className:"mt-1 caret-white",size:"sm",options:y,onChange:e=>{b((0,n.Z)((0,n.Z)({},D),{},{client:null===e||void 0===e?void 0:e.value}))},name:"client",autoFocus:!0,defaultMenuIsOpen:!0,closeMenuOnSelect:!0})]}),(0,N.jsxs)("div",{className:"mt-4",children:[(0,N.jsxs)("p",{className:"text-white",children:["Dates Range ",(0,N.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,N.jsx)(h.Z,{value:D.datesRange,onChange:e=>{b((0,n.Z)((0,n.Z)({},D),{},{datesRange:e}))},placeholder:"Select",size:"sm",className:"mt-1",disabled:!D.client,maxDate:new Date((new Date).setDate((new Date).getDate()+30)),name:"datesRange"})]}),(0,N.jsxs)("div",{className:"text-right mt-8 flex gap-2 items-center justify-end",children:[(0,N.jsx)(o.zx,{variant:"plain",onClick:S,className:"!px-4",children:"Cancel"}),(0,N.jsx)(o.zx,{variant:"solid",disabled:0!=s.value&&1!=s.value||!D.datesRange[0]||!D.datesRange[1]||!D.client,onClick:async()=>{try{if(!R(D))return;S(),c(!0);let e={loginCode:w,locationCode:C.LocationCode,fromDate:(0,m.Tk)(D.datesRange[0]),uptoDate:(0,m.Tk)(D.datesRange[1]),channelCode:C.ChannelCode,id:4,filter:"".concat(D.client)},t=await(0,f.Vg)(e,v);200===t.status?(i(t.data),u("bills")):204===t.status?(i([]),u("bills")):(0,d.openNotification)("danger","Something went wrong. Server responded with status code ".concat(t.status,"."),"Error"),c(!1)}catch(e){"message"in e?(0,d.openNotification)("danger","".concat(e.message),"Error"):(0,d.openNotification)("danger","Something went wrong.","Error"),c(!1),console.error(e)}},icon:(0,N.jsx)(x.VFe,{}),className:"!px-4",children:"Get Bills"})]})]})]})};var w=a(45682),v=a(22900),y=a(83659),j=a(56355),D=a(67207);const b=function(e){let{bill:t,cdnDate:a,setCDNDate:n,newRateTotal:s}=e;const[r,i]=(0,l.useState)(null),[c,u]=(0,l.useState)(!1),m=(0,l.useRef)(null);return(0,l.useEffect)((()=>{try{m.current&&(a?m.current.blur():m.current.focus())}catch(e){console.error(e)}}),[a]),(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)(o.Zb,{bodyClass:"grid grid-cols-4 gap-4 p-3",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("p",{for:"client",className:"text-white",children:"Invoice No"}),(0,N.jsx)(o.II,{className:"mt-1",disabled:!0,value:t.INVOICENO,size:"sm"})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("p",{for:"client",className:"text-white",children:"Invoice Date"}),(0,N.jsx)(o.II,{className:"mt-1",disabled:!0,value:t.InvoiceDate,size:"sm"})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("p",{for:"client",className:"text-white",children:"Gross Amount"}),(0,N.jsx)(o.II,{className:"mt-1",disabled:!0,value:t.GrossAmount,size:"sm"})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("p",{for:"client",className:"text-white",children:"Dates Range"}),(0,N.jsx)(h.Z,{size:"sm",disabled:!0,className:"mt-1",clearable:!1,value:[new Date(t.FromDate),new Date(t.UptoDate)]})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("p",{for:"client",className:"text-white",children:"Client"}),(0,N.jsx)(o.II,{className:"mt-1",disabled:!0,value:t.ClientName,size:"sm"})]}),(0,N.jsxs)("div",{children:[(0,N.jsxs)("p",{for:"client",className:"text-white",children:["Date ",(0,N.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,N.jsx)(o.Mt,{ref:m,value:a,placeholder:"Select",className:"mt-1",size:"sm",defaultOpen:!0,onChange:e=>{a?(i(e),u(!0)):n(e)},maxDate:new Date((new Date).setDate((new Date).getDate()+30)),minDate:new Date((new Date).setDate((new Date).getDate()-15))})]}),(0,N.jsx)("div",{}),(0,N.jsxs)("div",{className:"flex flex-col justify-center",children:[(0,N.jsx)("p",{for:"client",className:"text-white",children:"New Rate Total"}),(0,N.jsxs)("h5",{children:["\u20b9\xa0",(0,d.numberToINRFormat)(s)]})]})]}),(0,N.jsx)(D.Z,{isDialogOpen:c,title:"Change Date",description:"All the New Rate Amounts will be reset. Are you sure to continue?",submitButtonTitle:"Reset",handleDialogSubmit:()=>{n(r),u(!1)},handleDialogClose:()=>{i(null),u(!1)}})]})};var S=a(1063),R=a(99917),A=a(55533);const T=[{field:"TelecastDate",header:"Telecast Date"},{field:"TelecastTime",header:"Telecast Time"},{field:"CommercialCaption",header:"Caption"},{field:"DurInSec",header:"Duration"},{field:"SpotRate",header:"Rate"},{field:"SpotAmount",header:"Amount"},{field:"ContentName",header:"Program"},{field:"NewRateAmount",header:"New Rate Amount (\u20b9)"}];const I=function(e){let{spots:t,setSpots:a,generateCDNDate:n,newRateTotal:s,setNewRateTotal:r,firstNewRate:i,setFirstNewRate:c,isResetAllNewRateDialogOpen:u,setIsResetAllNewRateDialogOpen:h,setLoader:m,scrollHeight:p}=e;const[x,f]=(0,l.useState)(null),[g,C]=(0,l.useState)(null),[w,v]=(0,l.useState)(!1);(0,l.useEffect)((()=>{try{I()}catch(e){console.error(e)}}),[n]);const y=e=>{let{generateCDNDate:t,options:a}=e;try{return(0,N.jsx)(o.u,{title:t?"Enter new amount":"Select date to enter new amount",wrapperClass:"w-full border border-slate-500 rounded m-1 p-1 hover:cursor-pointer w-full",children:(0,N.jsx)("div",{onClick:()=>(0,d.openNotification)("danger","Please select a date to enter new rate"),className:"w-full text-center",children:a.value})})}catch(n){throw n}},j=(e,t,a)=>{try{null===e.value||e.value<=0?(t.editorCallback(0),C(0),r(parseFloat((s-a).toFixed(2)))):"-"===e.originalEvent.key?(t.editorCallback(""),C(null),r(parseFloat((s-a).toFixed(2))),(0,d.openNotification)("danger","Amount cannot be negative")):e.value>0&&(t.editorCallback(e.value),C(e.value),r(parseFloat((s+e.value-a).toFixed(2))))}catch(n){console.error(n)}},b=e=>{try{let{rowData:n,newValue:s,field:o,originalEvent:r}=e;if(null===s||""===s||0===s||"-"===s){n[o]="-";let e=JSON.parse(JSON.stringify(t));e.forEach((e=>{e.Id===n.Id&&(e.NewRateAmount="-")})),a(e)}else if(i)v(!0),f(n);else{n[o]=s;let e=JSON.parse(JSON.stringify(t));e.forEach((e=>{e.Id===n.Id&&(e.NewRateAmount=s)})),a(e)}r.preventDefault()}catch(n){console.error(n)}},I=()=>{try{let e=JSON.parse(JSON.stringify(t));e.forEach((e=>{e.NewRateAmount="-"})),a(e),c(!0),r(0),h(!1)}catch(e){console.error(e)}};return(0,N.jsxs)(N.Fragment,{children:[t.length>0?(0,N.jsx)(R.w,{value:t,editMode:"cell",tableStyle:{width:"100%"},size:"small",paginator:!0,rows:10,rowsPerPageOptions:[5,10,25,50],scrollable:!0,scrollHeight:p,children:T.map((e=>{let{field:t,header:a}=e;return"NewRateAmount"===t?(0,N.jsx)(S.s,{field:t,header:a,style:{width:"max-content"},editor:e=>(e=>{try{if(e){if(n){if("NewRateAmount"===e.field&&e.rowData){const t=e.rowData.NewRateAmount&&"-"===e.rowData.NewRateAmount?"":e.rowData.NewRateAmount;return(0,N.jsx)(A.R,{value:t,onChange:a=>{j(a,e,t)},onKeyDown:e=>e.stopPropagation(),locale:"en-IN",minFractionDigits:2,maxFractionDigits:2,inputClassName:"text-white p-1",className:"hover:cursor-pointer m-1 w-full",prefix:"\u20b9 "})}return(0,N.jsx)(y,{generateCDNDate:n,options:e})}return(0,N.jsx)(y,{generateCDNDate:n,options:e})}}catch(t){throw t}})(e),onCellEditComplete:b,bodyClassName:"hover:cursor-pointer",headerClassName:"px-1 py-3",headerStyle:{paddingInline:"0.25rem",paddingBlock:"0.75rem"},body:e=>(0,N.jsx)(o.u,{title:n?"Enter new amount":"Select date to enter new amount",wrapperClass:"w-full border border-slate-500 rounded m-1 p-1",children:(0,N.jsx)("div",{className:"w-full text-center",children:"-"===e[t]?e[t]:(0,d.numberToINRFormat)(e[t])})})},t):(0,N.jsx)(S.s,{field:t,header:a,style:{width:"max-content"}},t)}))}):(0,N.jsx)("div",{className:"h-[".concat(p,"] flex justify-center items-center"),children:"No Spots to show"}),(0,N.jsx)(D.Z,{isDialogOpen:w,title:"Apply to all",description:"Do you wish to apply INR ".concat((0,d.numberToINRFormat)(g)," to all the spots?"),submitButtonTitle:"Apply",handleDialogSubmit:()=>{try{m(!0);let e=JSON.parse(JSON.stringify(t)),n=0;e.forEach((e=>{e.NewRateAmount=g,n+=g})),a(e),r(parseFloat(n.toFixed(2))),c(!1),v(!1),m(!1)}catch(e){console.error(e)}},handleDialogClose:()=>{try{let e=JSON.parse(JSON.stringify(t));e.forEach((e=>{e.Id===x.Id&&(e.NewRateAmount=g)})),a(e),r(parseFloat(s.toFixed(2))),c(!1),v(!1)}catch(e){console.error(e)}}}),(0,N.jsx)(D.Z,{isDialogOpen:u,title:"Reset New Rate Amounts",description:"All the New Rate Amounts will be reset. Are you sure to continue?",submitButtonTitle:"Reset",handleDialogSubmit:I,handleDialogClose:()=>h(!1)})]})};var z=a(9494);const Z=function(e){let{isSaveDialogOpen:t,setIsSaveDialogOpen:a,noteType:n,invoiceNo:s,clientName:r,cdNoteDate:l,spotsWithNewRate:i,newRateTotal:c,remarks:u,setRemarks:h,cdNoteBill:m,resetPage:p,channel:x,token:f}=e;const g=()=>{try{a(!1),h("")}catch(e){console.error(e)}};return(0,N.jsxs)(o.Vq,{isOpen:t,onClose:g,onRequestClose:g,className:"!w-[27%]",children:[(0,N.jsxs)("h5",{className:"mb-4 border-b pb-3 border-gray-600",children:[n.label," Note"]}),(0,N.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsx)("span",{children:"Invoice No"}),(0,N.jsx)("span",{className:"font-medium max-w-[50%] text-end",children:s})]}),(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsx)("span",{children:"Client"}),(0,N.jsx)("span",{className:"font-medium max-w-[50%] text-end",children:r})]}),(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsxs)("span",{children:[n.label," Note Date"]}),(0,N.jsx)("span",{className:"font-medium max-w-[50%] text-end",children:l})]}),(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsx)("span",{children:"Spots count"}),(0,N.jsx)("span",{className:"font-medium max-w-[50%] text-end",children:i.filter((e=>"-"!==e.NewRateAmount&&e.NewRateAmount>0)).length})]}),(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsx)("span",{children:"New rate total"}),(0,N.jsx)("span",{className:"font-medium max-w-[50%] text-end",children:(0,d.numberToINRFormat)(c)})]}),(0,N.jsx)("div",{children:(0,N.jsx)(o.II,{className:"mt-1",size:"sm",textArea:!0,placeholder:"Remarks",autoFocus:!0,value:u,maxLength:150,onChange:e=>h(e.target.value)})})]}),(0,N.jsxs)("div",{className:"text-right mt-4 flex items-center justify-end",children:[(0,N.jsx)(o.zx,{className:"ltr:mr-2 rtl:ml-2",variant:"plain",size:"sm",onClick:g,children:"Cancel"}),(0,N.jsx)(o.zx,{variant:"solid",size:"sm",onClick:async()=>{try{let e=[];i.forEach((t=>{"-"!==t.NewRateAmount&&t.NewRateAmount>0&&e.push({BookingNumber:m.BookingNumber,BookingDetailID:t.BookingDetailID,DealNumber:t.DealNumber,DealLineItemID:t.DealLineItemNo,CreditDebitCode:n.value,CreditDebitamount:t.NewRateAmount})}));const t={request:{LocationCode:x.LocationCode,ChannelCode:x.ChannelCode,BookingNumber:m.BookingNumber,InvoiceNumber:m.BillNumber,InvoiceDate:m.InvoiceDate,CancelDate:"",Amount:c,Remarks:u,CreditDebitStatus:n.value,ServiceTax:0,QRCODE:"",IRNNumber:"",AckNo:"",IRNStatus:"",SignedInvoice:"",IsActive:1,RefDate:l},details:e},a=await(0,v.yS)(t,f);200===a.status?(0,d.openNotification)("success","Credit Note created successfully"):(0,d.openNotification)("danger","Unable to create ".concat(n.label," note. Server responded with status code ").concat(a.status)),g(),p()}catch(e){(0,d.openNotification)("danger","Something went wrong. Unable to create credit note."),console.error(e)}},children:"Confirm"})]})]})};var k=a(81721),B=a(40071);const F=function(e){let{setIsResetAllNewRateDialogOpen:t,setIsDiscardDialogOpen:a,isSaveDialogOpen:n,setIsSaveDialogOpen:s,firstNewRate:r,newRateTotal:i,cdnDate:c,noteType:u,cdNoteBill:h,spotsWithNewRate:p,remarks:x,setRemarks:f,resetPage:g,channel:C,token:w}=e;const[v,y]=(0,l.useState)(!0);return(0,l.useEffect)((()=>{if(Array.isArray(p)){const e=p.filter((e=>"-"===e.NewRateAmount||0===e.NewRateAmount)).length===p.length;y(e)}}),[p]),(0,N.jsxs)(k.gi,{className:"-mx-8 px-8 flex items-center justify-end py-4",stickyClass:"border-t bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:[(0,N.jsxs)("div",{className:"flex gap-3",children:[(0,N.jsx)(o.u,{title:"Reset New Rate Amounts",children:(0,N.jsx)(o.zx,{size:"sm",variant:"plain",onClick:()=>t(!0),disabled:r,children:"Reset"})}),(0,N.jsx)(o.zx,{size:"sm",onClick:()=>{a(!0)},children:"Discard"}),(0,N.jsx)(o.zx,{variant:"solid",size:"sm",icon:(0,N.jsx)(B.Tri,{}),onClick:()=>s(!0),disabled:v,children:"Save"})]}),(0,N.jsx)(Z,{isSaveDialogOpen:n,setIsSaveDialogOpen:s,noteType:u,invoiceNo:h.INVOICENO,clientName:h.ClientName,cdNoteDate:(0,d.formatDateToDDMMMYYYY)((0,m.Tk)(c)),spotsWithNewRate:p,newRateTotal:i,remarks:x,setRemarks:f,cdNoteBill:h,resetPage:g,channel:C,token:w})]})};var O=a(93673),L=a(41578);const P=["value","onChange","debounce"],E=[{header:"Date",accessorKey:"RefDate"},{header:"Type",accessorKey:"CreditDebitStatus"},{header:"Reference No",accessorKey:"RefNumber"},{header:"Invoice No",accessorKey:"InvoiceNumber"},{header:"Amount",accessorKey:"Amount"}],K=[{header:"Invoice No",accessorKey:"INVOICENO"},{header:"Invoice Date",accessorKey:"InvoiceDate"},{header:"Client",accessorKey:"ClientName"},{header:"Gross Amount",accessorKey:"GrossAmount"},{header:"Discount",accessorKey:"AgencyShare"},{header:"Taxes",accessorKey:"TotalTaxAmount"},{header:"Payable",accessorKey:"PayableAmount"}];function q(e){let{value:t,onChange:a,debounce:o=500}=e,i=(0,s.Z)(e,P);const[c,d]=(0,l.useState)(t);return(0,l.useEffect)((()=>{d(t)}),[t]),(0,l.useEffect)((()=>{const e=setTimeout((()=>{a(c)}),o);return()=>clearTimeout(e)}),[c]),(0,N.jsx)("div",{className:"flex justify-end",children:(0,N.jsx)("div",{className:"flex items-center font-semibold",children:(0,N.jsx)(r.Z,(0,n.Z)((0,n.Z)({},i),{},{value:c,onChange:e=>{/^[0-9a-zA-Z\s.]*$/.test(e.target.value)&&d(e.target.value)}}))})})}const M=(e,t,a,n,s,r,l)=>(0,N.jsxs)("div",{className:"flex items-center gap-2",children:["home"===e&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(n,{value:null!==s&&void 0!==s?s:"",placeholder:"Search all columns...",size:"sm",onChange:e=>{/^[0-9a-zA-Z\s.]*$/.test(e)&&r(e)}}),(0,N.jsx)(o.zx,{variant:"solid",size:"sm",icon:(0,N.jsx)(i.yEd,{}),onClick:()=>t(!0),disabled:!(0,d.isChannelSelected)(l),children:"Add Credit/Debit Note"})]}),"bills"===e&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(n,{value:null!==s&&void 0!==s?s:"",placeholder:"Search all columns...",size:"sm",onChange:e=>{/^[0-9a-zA-Z\s.]*$/.test(e)&&r(e)}}),(0,N.jsx)(o.u,{title:"Discard",children:(0,N.jsx)(o.zx,{variant:"twoTone",size:"sm",icon:(0,N.jsx)(j.lp8,{}),onClick:()=>{a(!0)}})})]})]});const V=function(){const e=(0,c.useSelector)((e=>e.locale.selectedChannel)),t=(0,c.useSelector)((e=>e.auth.session.LoginId)),a=(0,c.useSelector)((e=>e.auth.session.token)),[s,r]=(0,l.useState)(null),[i,h]=(0,l.useState)({value:1,label:"Credit"}),[m,p]=(0,l.useState)(null),[x,f]=(0,l.useState)(null),[g,S]=(0,l.useState)(null),[R,A]=(0,l.useState)(null),[T,Z]=(0,l.useState)(0),[k,B]=(0,l.useState)(!0),[P,V]=(0,l.useState)(""),[G,U]=(0,l.useState)(""),[J,Y]=(0,l.useState)([]);console.log(J);const[_,W]=(0,l.useState)(null),[H,$]=(0,l.useState)(null),[Q,X]=(0,l.useState)(""),[ee,te]=(0,l.useState)([]),[ae,ne]=(0,l.useState)([]),[se,oe]=(0,l.useState)(null),[re]=(0,l.useState)(function(){try{return[...E,{header:"Action",accessorKey:"action",actions:[{action:(e,t)=>(0,N.jsx)("div",{className:"text-xs font-medium !w-max",children:(0,N.jsxs)("div",{className:"flex gap-2 justify-center",children:[(0,N.jsx)(o.u,{title:"View Note",children:(0,N.jsx)(o.zx,{size:"xs",icon:(0,N.jsx)(j.z5B,{}),onClick:()=>{W(t),$(e),fe(!0)}})}),(0,N.jsx)(o.u,{title:"Download Note",children:(0,N.jsx)(o.zx,{size:"xs",icon:(0,N.jsx)(L.HXz,{}),onClick:()=>{W(t),$(e),fe(!0)}})})]})})}]}]}catch(e){console.error(e)}}()),[le,ie]=(0,l.useState)(!1),[ce,de]=(0,l.useState)(!1),[ue,he]=(0,l.useState)(!1),[me,pe]=(0,l.useState)(!1),[xe,fe]=(0,l.useState)(!1),[ge,Ne]=(0,l.useState)(!1),[Ce,we]=(0,l.useState)(!1),[ve,ye]=(0,l.useState)("home"),je=(0,l.useMemo)((()=>[{header:"Agency Name",accessorKey:"AgencyName"},{header:"Address Line1",accessorKey:"AddressLine1"},{header:"Payable Amount",accessorKey:"PayableAmount"},{header:"Client",accessorKey:"ClientName"},{header:"Amount",accessorKey:"Amount"},{header:"Ref Date",accessorKey:"RefDate"},{header:"Invoice Date",accessorKey:"InvoiceDate"},{header:"GSTN Id",accessorKey:"GSTN_id"},{header:"Brand",accessorKey:"BrandName"},{header:"Booking Ref",accessorKey:"BookingRefNumber"}]),[]);(0,l.useEffect)((()=>{try{(0,d.isChannelSelected)(e)&&be()}catch(t){(0,d.openNotification)("danger","Something went wrong while fetching credit notes."),we(!1),console.error(t)}}),[]),(0,l.useEffect)((()=>{try{(0,d.isChannelSelected)(e)?Se():(0,d.openNotification)("warning","Please select a channel to view credit notes")}catch(t){console.error(t)}}),[e]),(0,l.useEffect)((()=>{null!==_&&De(_.CreditDebitCode)}),[H]);const De=async t=>{de(!0);let a={};a.par_LocationCode=e.LocationCode,a.par_ChannelCode=e.ChannelCode,a.par_CreditDebitCode=t,a.par_Flag=0,(0,z.apiCallstoreprocedure)("usp_Billing_CreditDebitPrint",a).then((e=>{200==e.status?(de(!1),Y(e.data),console.log(e.status)):204==e.status&&(de(!1),Y([]))})).catch((e=>{e.response.status&&(Y([]),de(!1))}))},be=async()=>{try{we(!0);const t=await(0,v.ZA)(e,a);200===t.status?r(t.data):204===t.status?r([]):(0,d.openNotification)("danger","Something went wrong. Server responded with status code ".concat(t.status," while fetching credit notes.")),we(!1)}catch(t){throw t}},Se=()=>{try{Re(),be()}catch(e){console.error(e)}},Re=()=>{try{r(null),h({value:1,label:"Credit"}),p(null),f(null),S(null),A(null),Z(0),V(""),B(!0),U(""),X(""),ie(!1),he(!1),pe(!1),Ne(!1),we(!1),ye("home")}catch(e){throw e}};return(0,l.useEffect)((()=>{s&&s.length>0&&oe(s.map((e=>(0,n.Z)((0,n.Z)({},e),{},{CreditDebitStatus:0===e.CreditDebitStatus?"Debit Note":"Credit Note",RefDate:(0,d.getDateFromDateTime)(e.RefDate),Amount:(0,d.numberToINRFormat)(e.Amount)}))))}),[s]),(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(w.default,{showLoader:ce}),(0,N.jsxs)(o.Zb,{header:(0,N.jsx)(u.Z,{}),headerExtra:M(ve,ie,pe,q,"home"===ve?G:"bills"===ve?Q:"","home"===ve?U:"bills"===ve?X:"",e),className:"flex flex-col min-h-[87vh] mb-4",bodyClass:"grow p-3",children:[!(0,d.isChannelSelected)(e)&&(0,N.jsx)("div",{className:"h-full flex justify-center items-center",children:"Please select a channel to view credit notes"}),(0,d.isChannelSelected)(e)&&(0,N.jsxs)(N.Fragment,{children:["home"===ve&&(0,N.jsxs)(N.Fragment,{children:[s&&0===s.length&&(0,N.jsx)("div",{className:"h-full flex justify-center items-center",children:"No Credit/Debit notes to show"}),s&&s.length>0&&(0,N.jsx)(O.Z,{tableData:se,originalColumns:re,managedColumns:ee,setManagedColumns:te,exportFileName:"Credit & Debit Note",columnsToFormatInINR:[]})]}),"bills"===ve&&(0,N.jsxs)(N.Fragment,{children:[m&&0===m.tmpbilldata.length&&(0,N.jsx)("div",{className:"h-full flex justify-center items-center",children:"No bills to show"}),m&&m.tmpbilldata.length>0&&(0,N.jsxs)("div",{className:"h-full flex flex-col",children:[(0,N.jsx)("h5",{className:"mb-3",children:"".concat(i.label," Note")}),(0,N.jsx)("div",{className:"grow",children:(0,N.jsx)(y.Z,{data:m.tmpbilldata.map((e=>(0,n.Z)((0,n.Z)({},e),{},{TotalTaxAmount:(0,d.numberToINRFormat)(e.TotalTaxAmount),InvoiceDate:(0,d.getDateFromDateTime)(e.InvoiceDate),PayableAmount:(0,d.numberToINRFormat)(e.PayableAmount),GrossAmount:(0,d.numberToINRFormat)(e.GrossAmount),noteType:i}))),columns:K,globalFilter:Q,setGlobalFilter:X,seteditData:async t=>{try{let a={LocationCode:e.LocationCode,ChannelCode:e.ChannelCode,InvoiceNumber:t.BillNumber},s=await(0,z.apiCallstoreprocedure)("USP_ShowInvoiceDetail",a);200===s.status?A((0,d.columnsToINRFormat)(s.data,["SpotRate","SpotAmount"]).map((e=>(0,n.Z)((0,n.Z)({},e),{},{TelecastDate:(0,d.getDateFromDateTime)(e.TelecastDate),TelecastTime:e.TelecastTime,NewRateAmount:"-"})))):(204===s.status||(0,d.openNotification)("danger","Something went wrong. Server responded with status code ".concat(s.status," while fetching spots")),A([])),f(t),ye("generateNote")}catch(a){(0,d.openNotification)("danger","Something went wrong while fetching spots"),console.error(a)}},ExportName:"Credit/Debit Note Bills"})})]})]}),"generateNote"===ve&&(0,N.jsxs)(N.Fragment,{children:[x&&Array.isArray(R)&&0===R.length&&(0,N.jsx)("div",{className:"h-full flex justify-center items-center",children:"No Spots to show"}),x&&Array.isArray(R)&&R.length>0&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("h5",{className:"mb-3",children:"".concat(i.label," Note")}),(0,N.jsx)(b,{bill:x,cdnDate:g,setCDNDate:S,newRateTotal:T}),(0,N.jsxs)(o.Zb,{className:"mt-4",bodyClass:"p-3 pt-2",children:[(0,N.jsx)("h6",{className:"mb-2",children:"Spots"}),(0,N.jsx)(I,{spots:R,setSpots:A,generateCDNDate:g,newRateTotal:T,setNewRateTotal:Z,firstNewRate:k,setFirstNewRate:B,isResetAllNewRateDialogOpen:ue,setIsResetAllNewRateDialogOpen:he,setLoader:we,scrollHeight:"65vh"})]})]})]})]})]}),"generateNote"===ve&&(0,N.jsx)(F,{setIsResetAllNewRateDialogOpen:he,setIsDiscardDialogOpen:pe,isSaveDialogOpen:ge,setIsSaveDialogOpen:Ne,firstNewRate:k,newRateTotal:T,cdnDate:g,noteType:i,cdNoteBill:x,spotsWithNewRate:R,remarks:P,setRemarks:V,resetPage:Se,channel:e,token:a}),(0,N.jsx)(C,{isAddCNDialogOpen:le,setIsAddCNDialogOpen:ie,noteType:i,setNoteType:h,setBills:p,setShowLoader:we,setCurPage:ye,channel:e,loginId:t,token:a}),(0,N.jsx)(w.default,{showLoader:Ce}),(0,N.jsx)(D.Z,{isDialogOpen:me,title:"Discard",description:"Are you sure you want to discard?",submitButtonTitle:"Discard",handleDialogSubmit:Se,handleDialogClose:()=>pe(!1)}),(0,N.jsxs)(o.Vq,{isOpen:xe,onClose:()=>fe(!1),width:"90vw",height:"80vh",contentClassName:"pt-3 flex flex-col",children:[(0,N.jsxs)("h5",{className:"border-b border-gray-700 pb-2",children:["Credit & Debit Note Info"," "]}),J.length>0?(0,N.jsx)("div",{className:"grow mt-3",children:(0,N.jsx)(O.Z,{tableData:J,originalColumns:je,managedColumns:ae,setManagedColumns:ne,exportFileName:"Credit & Debit Note",columnsToFormatInINR:[]})}):(0,N.jsx)("p",{className:"text-center",children:"No Spots Found"})]})]})}},96361:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l});var n=a(79139),s=a(60364),o=a(11087),r=a(80184);const l=e=>{let{ModuleText:t="Admin",Component:a,links:l}=e;(0,s.useSelector)((e=>e.auth.session.currentRouteKey));const i=(0,s.useSelector)((e=>e.base.common.currentRouteTitle));console.log(i);const{title:c,Moduletitle:d}=(0,s.useSelector)((e=>e.auth.user));return(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xl font-medium",children:i}),(0,r.jsxs)(n.Breadcrumbs,{style:{marginLeft:"-15px",width:"auto"},children:[(0,r.jsx)(o.rU,{to:"/home",className:"opacity-60 text-xs",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{d:"M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"})})}),(0,r.jsx)(o.rU,{to:"/".concat("SALES ADMIN"===d?"SalesAdmin":d),className:"opacity-60 text-xs",children:(0,r.jsx)("span",{children:d})}),(0,r.jsx)(o.rU,{to:"#",className:"text-xs",children:(0,r.jsx)("span",{children:i})})]})]})}},45682:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>o});var n=a(2803),s=(a(72791),a(80184));const o=function(e){let{showLoader:t}=e;return(0,s.jsx)(s.Fragment,{children:t?(0,s.jsx)("div",{className:"dialog-overlay flex justify-center items-center z-50",children:(0,s.jsx)(n.$j,{size:"3.25rem"})}):(0,s.jsx)(s.Fragment,{})})}},67207:(e,t,a)=>{"use strict";a.d(t,{Z:()=>o});var n=a(2803),s=(a(72791),a(80184));const o=function(e){let{isDialogOpen:t,title:a,description:o,descClassName:r,submitButtonTitle:l,submitButtonColor:i,handleDialogSubmit:c,handleDialogClose:d,overlayClassName:u,secondaryDescription:h}=e;return(0,s.jsxs)(n.Vq,{isOpen:t,onClose:d,onRequestClose:d,overlayClassName:u,children:[(0,s.jsx)("h5",{className:"mb-4",children:a}),(0,s.jsx)("p",{className:r,children:o}),(0,s.jsxs)("div",{className:"flex justify-between items-center mt-6",children:[(0,s.jsx)("p",{children:h}),(0,s.jsx)(n.zx,{variant:"solid",color:i,onMouseDown:c,children:l})]})]})}},72950:()=>{},22868:()=>{},14777:()=>{},99830:()=>{},70209:()=>{},87414:()=>{}}]);
//# sourceMappingURL=17.88c8881b.chunk.js.map