"use strict";(self.webpackChunkelstar=self.webpackChunkelstar||[]).push([[481],{10481:(e,t,n)=>{n.r(t),n.d(t,{default:()=>y});var r=n(1413),s=n(72791),a=n(84373),l=n(2803),o=n(91615),c=n(21260),i=n(29851),u=n(81320);const d=(e,t,n)=>{t.current&&!t.current.contains(e.target)&&n((e=>(0,r.Z)((0,r.Z)({},e),{},{isManageColumnsDropdownVisible:!1})))};var m=n(60364),h=n(84870),p=n(41578),f=n(73516),x=n(81694),T=n.n(x),g=n(17051),b=n(8458),E=n(9281),N=n(78638),w=n(54748),v=n(80184);const y=function(){const e=(0,m.useSelector)((e=>e.auth.session.token)),t=(0,m.useSelector)((e=>e.locale.selectedChannel)),{date:n,schedulingTableData:x,setSecondaryTableType:y,setOgSecTableData:C,secondaryTableData:S,setSecondaryTableData:j,secondaryTableManagedColumns:R,setSecondaryTableManagedColumns:_,setActiveFeatures:I,secTableToolbarState:A,setSecTableToolbarState:D,secondaryTableOffset:O,secondaryTableSelectedRows:F,setSecondaryTableSelectedRows:L,secondaryTableRef:M,dropBucket:P,page:k,lastMinuteSpots:z,setLastMinuteSpots:B,resetSecondaryTableStates:Z}=(0,s.useContext)(o.Z),[Y,q]=(0,s.useState)(""),[J,U]=(0,s.useState)(!1),W=(0,s.useRef)(null),[G]=(0,E.Nr)(Y,500);(0,s.useEffect)((()=>((async()=>{try{U(!0),y(c.secondaryTableTypesEnum.LAST_MINUTE_SPOTS),B((await(0,N.getLastMinuteSpots)(t,(0,w.Tk)(n),x,P,k)).map(((e,t)=>(0,r.Z)((0,r.Z)({},e),{},{rowId:(0,i.XQ)(c.tableTypesEnum.SECONDARY,e),rowIndex:t})))),U(!1)}catch(e){(0,u.openNotification)("danger","Something went wrong while fetching Last Minute Spots"),U(!1),console.error(e)}})(),Z)),[]),(0,s.useEffect)((()=>{try{Array.isArray(z)&&V(z)}catch(e){console.error(e)}}),[G,z]),(0,s.useEffect)((()=>{(async()=>{try{if(0===R.originalColumns.length){const{visibleColumns:t,removedColumns:n}=await(0,i.tn)(b.T9.SECONDARY_TABLE_NAMES.INSERT_LAST_MINUTE_SPOTS,S,e);_({originalColumns:(0,i.UW)(S),visibleColumns:t,removedColumns:n})}}catch(t){(0,u.openNotification)("danger","Something went wrong while setting columns for Last Minute Spots"),console.error(t)}})()}),[S]),(0,s.useEffect)((()=>(document.addEventListener("mousedown",(e=>d(e,W,D))),()=>{document.removeEventListener("mousedown",(e=>d(e,W,D)))})),[W,D]);const V=async e=>{try{if(!G){const t=H(e);return C(t),void j(t)}let t=!1;const n=[];return e.forEach(((e,s)=>{if(0===s)n.push(e);else{const s=e.Event_Name.toLowerCase().includes(G.toLowerCase());s&&(t=!0),n.push((0,r.Z)((0,r.Z)({},e),{},{isFiltered:s}))}})),C(n),j(n),t}catch(t){(0,u.openNotification)("danger","Something went wrong while searching"),console.error(t)}},H=e=>e.map(((e,t)=>0===t?e:(0,r.Z)((0,r.Z)({},e),{},{isFiltered:!0}))),K=S.filter((e=>e.isFiltered));return(0,v.jsxs)("div",{className:"h-full w-full flex flex-col overflow-auto no-scrollbar bg-gray-800 p-3 pt-2 rounded-lg",children:[(0,v.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,v.jsxs)("div",{className:"flex items-center gap-3",children:[(0,v.jsx)("h5",{children:"Last Minute Spots"}),K.length>0&&(0,v.jsx)("h6",{className:"p-1 rounded-full  text-sm font-black bg-emerald-600 text-white mr-2 w-8 text-center",children:K.length})]}),(0,v.jsxs)("div",{className:"flex gap-1.5",children:[K.length>0&&(0,v.jsxs)(l.u,{title:"Manage Columns",wrapperClass:"relative",children:[(0,v.jsx)(l.zx,{size:"xs",icon:(0,v.jsx)(p.Rqg,{}),className:T()(R.removedColumns.length>0?"!bg-teal-700 hover:!bg-teal-700":"hover:!bg-teal-800","transition-all"),onClick:()=>D((0,r.Z)((0,r.Z)({},A),{},{isManageColumnsDropdownVisible:!0}))}),A.isManageColumnsDropdownVisible&&(0,v.jsx)(f.default,{tableType:c.tableTypesEnum.SECONDARY,dropdownRef:W,position:"right-1/2"})]}),(0,v.jsx)(l.u,{title:"Close",children:(0,v.jsx)(l.zx,{size:"xs",icon:(0,v.jsx)(a.QAE,{}),onClick:()=>(0,i.FG)(I,c.featuresEnum.INSERT)})})]})]}),(0,v.jsx)(l.BZ,{className:"mb-3 flex",children:(0,v.jsx)(l.II,{placeholder:"Search Drop Box",size:"sm",className:"h-[38px]",onChange:e=>q(e.target.value),value:Y,autoFocus:!0})}),(0,v.jsx)("div",{className:"h-[92%] flex flex-col gap-3",children:K.length>0?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{className:"grow",children:(0,v.jsx)(h.default,{tableName:b.T9.SECONDARY_TABLE_NAMES.INSERT_LAST_MINUTE_SPOTS,tableType:c.tableTypesEnum.SECONDARY,tableData:S,columns:R.visibleColumns,droppableId:c.droppableIdsEnum.SECONDARY,selectedRows:F,setSelectedRows:L,scrolledOffset:O,tableRef:M})}),(0,v.jsx)(g.Z,{insertType:c.rowDataTypesEnum.COMMERCIAL})]}):(0,v.jsx)(l.Zb,{className:"h-full",bodyClass:"h-full flex justify-center items-center",children:J?(0,v.jsx)(l.$j,{size:"45px"}):"No last minute spots to show"})})]})}},17051:(e,t,n)=>{n.d(t,{Z:()=>E});var r=n(72791),s=n(2803),a=n(30203),l=n(19129),o=n(10050),c=n(3479),i=n(63524),u=n(91615),d=n(21260),m=n(45682),h=n(81320),p=n(16856),f=n(29184),x=n(80184);const T=function(e){let{isDialogOpen:t,setIsDialogOpen:n}=e;const{executeOperation:a}=(0,r.useContext)(u.Z),[l,o]=(0,r.useState)("sequentialInsert"),c=()=>n(!1);return(0,x.jsx)(s.Vq,{isOpen:t,onClose:c,onRequestClose:c,width:"40%",contentClassName:"mt-8",children:(0,x.jsxs)("div",{className:"flex flex-col h-full",children:[(0,x.jsx)("h4",{className:"border-b border-b-gray-700 pb-2 mb-3",children:"Repeat Insert"}),(0,x.jsxs)("div",{className:"max-h-[60vh] overflow-y-auto flex flex-col gap-6 pr-2 text-white",children:[(0,x.jsx)(f.Z,{}),(0,x.jsxs)("div",{children:[(0,x.jsx)("p",{className:"text-sm mb-1",children:"Insert Type"}),(0,x.jsxs)(s.Y8.Group,{value:l,onChange:o,children:[(0,x.jsx)(s.Y8,{value:"sequentialInsert",className:"text-gray-300",children:"Sequential Insert"}),(0,x.jsx)(s.Y8,{value:"randomizeInsert",className:"text-gray-300",children:"Randomize Insert"})]})]})]}),(0,x.jsx)("div",{className:"text-right mt-6",children:(0,x.jsx)(s.zx,{variant:"solid",onClick:async()=>{try{const e=await a({operation:d.operationTypesEnum.REPEAT_INSERT_ROW,repeatInsertType:l});c(),e&&(0,h.openNotification)("success","Events inserted successfully")}catch(e){(0,h.openNotification)("danger","Something went wrong while inserting events"),console.error(e)}},children:"Insert"})})]})})},g=(0,r.lazy)((()=>n.e(880).then(n.bind(n,99129)))),b=(0,r.lazy)((()=>n.e(327).then(n.bind(n,20327))));const E=function(e){var t;let{insertType:n}=e;const{schedulingTableSelectedRows:f,secondaryTableSelectedRows:E,setSecondaryTableSelectedRows:N,secondaryTableData:w,executeOperation:v,isAutoCalcNtcOffsetTime:y,isNtcGroupingEnabled:C}=(0,r.useContext)(u.Z),[S,j]=(0,r.useState)(!1),[R,_]=(0,r.useState)(!1),[I,A]=(0,r.useState)(!1),D=E.length===w.length-1;return(0,x.jsx)(r.Suspense,{fallback:(0,x.jsx)(m.default,{showLoader:!0}),children:(0,x.jsxs)("div",{className:"bg-gray-700 bg-opacity-50 flex gap-0.5 p-0.5 rounded-lg border border-gray-600",children:[(0,x.jsx)(s.u,{title:D?"Un-select all":"Select All",children:(0,x.jsx)(s.zx,{className:"hover:!bg-teal-700 transition-all !h-8 !w-8 ".concat(D&&"!bg-teal-700"),variant:"plain",size:"sm",icon:(0,x.jsx)(p.WHv,{className:"text-[1.2rem]"}),onClick:()=>{try{E.length===w.length-1?N([]):N([...w].splice(1))}catch(e){(0,h.openNotification)("danger","Something went wrong while selecting all events"),console.error(e)}}})}),(0,x.jsx)(s.u,{title:"Insert",children:(0,x.jsx)(s.zx,{className:(0,o.f6)(),variant:"plain",size:"sm",icon:(0,x.jsx)(a.zHT,{className:"text-base"}),disabled:(0,o.JT)(f,E,d.secTableBottomToolbarFeaturesEnum.INSERT,y,C),onClick:()=>{try{v({operation:d.operationTypesEnum.INSERT_ROW})}catch(e){console.error(e),(0,h.openNotification)("danger","Something went wrong while inserting events")}}})}),n!==d.rowDataTypesEnum.COMMERCIAL&&(0,x.jsxs)(x.Fragment,{children:[y&&n===d.rowDataTypesEnum.NTC&&!(null!==(t=w[0])&&void 0!==t&&t.BookingDetailID)&&(0,x.jsxs)(s.u,{title:"Repeat Insert",children:[(0,x.jsx)("div",{onClick:()=>{(0,o.JT)(f,E,d.secTableBottomToolbarFeaturesEnum.REPEAT_INSERT,y,C)?(0,h.openNotification)("danger","Please select a valid NTC parent event"):j(!0)},children:(0,x.jsx)(s.zx,{className:(0,o.f6)(),variant:"plain",size:"sm",icon:(0,x.jsx)(p.LkC,{className:"text-[1.4rem]"}),disabled:(0,o.JT)(f,E,d.secTableBottomToolbarFeaturesEnum.REPEAT_INSERT,y,C)})}),S&&(0,x.jsx)(T,{isDialogOpen:S,setIsDialogOpen:j})]}),(0,x.jsxs)(s.u,{title:"Bulk Insert",wrapperClass:"relative",children:[(0,x.jsx)(s.zx,{className:(0,o.f6)(),variant:"plain",size:"sm",icon:(0,x.jsx)(l.gy$,{className:"text-lg"}),disabled:(0,o.JT)(f,E,d.secTableBottomToolbarFeaturesEnum.BULK_INSERT,y,C),onClick:()=>A(!0)}),I&&(0,x.jsx)(b,{isDialogOpen:I,setIsDialogOpen:A,insertType:n})]}),(0,x.jsx)(s.u,{title:"Replace",children:(0,x.jsx)(s.zx,{className:(0,o.f6)(),variant:"plain",size:"sm",icon:(0,x.jsx)(c.ux5,{className:"text-[1.12rem]"}),disabled:(0,o.JT)(f,E,d.secTableBottomToolbarFeaturesEnum.REPLACE,y,C),onClick:()=>{try{v({operation:d.operationTypesEnum.REPLACE_ROW}),(0,h.openNotification)("success","Events replaced successfully")}catch(e){console.error(e),(0,h.openNotification)("danger","Something went wrong while replacing events")}}})}),(0,x.jsxs)(s.u,{title:"Replace All",children:[(0,x.jsx)(s.zx,{className:(0,o.f6)(),variant:"plain",size:"sm",icon:(0,x.jsx)(i.p2I,{className:"text-xl"}),disabled:(0,o.JT)(f,E,d.secTableBottomToolbarFeaturesEnum.REPLACE_ALL,y,C),onClick:()=>_(!0)}),R&&(0,x.jsx)(g,{isDialogOpen:R,setIsDialogOpen:_})]})]})]})})}},29184:(e,t,n)=>{n.d(t,{Z:()=>o});var r=n(2803),s=n(72791),a=n(91615),l=n(80184);const o=function(){const{secondaryTableSelectedRows:e}=(0,s.useContext)(a.Z);return(0,l.jsxs)("div",{children:[(0,l.jsxs)("p",{className:"text-sm mb-1",children:["Events (",e.length,")"]}),(0,l.jsx)("div",{className:"max-h-24 overflow-y-scroll",children:(0,l.jsx)("div",{className:"grid grid-cols-2 gap-x-2 gap-y-2 p-2 bg-gray-700 bg-opacity-70 rounded",children:e.map((e=>(0,l.jsx)(r.u,{title:e.Event_Name,wrapperClass:"w-full",placement:"top-start",children:(0,l.jsxs)("div",{className:"flex items-center gap-1.5 w-full",children:[(0,l.jsx)("span",{className:"bg-gray-500 rounded-full w-[0.4rem] h-[0.4rem]"}),(0,l.jsx)("span",{className:"text-sm text-gray-200 w-full text-ellipsis overflow-hidden whitespace-nowrap",children:e.Event_Name})]},e.rowId)},e.rowId)))})})]})}},10050:(e,t,n)=>{n.d(t,{JT:()=>o,f6:()=>a,x2:()=>c});var r=n(21260);const s=n(81694),a=e=>{try{return s(e?"!bg-teal-700 hover:!bg-teal-700":"hover:!bg-teal-800","transition-all !h-8 !w-8")}catch(t){console.error(t)}},l=(e,t,n,s)=>{try{if(1===t.length&&e.length>0){const a=t[0];let l;return l=a.F_C_S_P===r.rowDataTypesEnum.NTC&&(n||s)?e.every((e=>e.F_C_S_P===a.F_C_S_P&&e.NTCGroupCode===a.NTCGroupCode)):e.every((e=>e.F_C_S_P===a.F_C_S_P)),!l}return!0}catch(a){throw a}},o=(e,t,n,s,a)=>{try{switch(n){case r.secTableBottomToolbarFeaturesEnum.INSERT:return i(e,t);case r.secTableBottomToolbarFeaturesEnum.REPEAT_INSERT:return u(e,t);case r.secTableBottomToolbarFeaturesEnum.BULK_INSERT:return 0===t.length;case r.secTableBottomToolbarFeaturesEnum.REPLACE:case r.secTableBottomToolbarFeaturesEnum.REPLACE_ALL:return l(e,t,s,a);default:return!1}}catch(o){console.error(o)}},c=e=>{try{let t=[],n=0;e.forEach((e=>{Number(e.BreakNumber)>n&&(n=Number(e.BreakNumber))}));for(let e=1;e<=n;e++)t.push({value:e,label:"Break ".concat(e)});return t}catch(t){console.error(t)}},i=(e,t)=>1!==e.length||0===t.length||t.length>0&&t[0].F_C_S_P===r.rowDataTypesEnum.NTC&&1===e.length&&(e[0].F_C_S_P===r.rowDataTypesEnum.COMMERCIAL||e[0].F_C_S_P===r.rowDataTypesEnum.CONTENT_TERMINATION),u=(e,t)=>1!==e.length||0===t.length||t.length>0&&t[0].F_C_S_P===r.rowDataTypesEnum.NTC&&1===e.length&&(e[0].F_C_S_P===r.rowDataTypesEnum.COMMERCIAL||e[0].F_C_S_P===r.rowDataTypesEnum.CONTENT_TERMINATION||e[0].F_C_S_P===r.rowDataTypesEnum.NTC)},9281:(e,t,n)=>{n.d(t,{Nr:()=>l});var r=n(72791);function s(e,t,n){var s=this,a=(0,r.useRef)(null),l=(0,r.useRef)(0),o=(0,r.useRef)(null),c=(0,r.useRef)([]),i=(0,r.useRef)(),u=(0,r.useRef)(),d=(0,r.useRef)(e),m=(0,r.useRef)(!0);d.current=e;var h="undefined"!=typeof window,p=!t&&0!==t&&h;if("function"!=typeof e)throw new TypeError("Expected a function");t=+t||0;var f=!!(n=n||{}).leading,x=!("trailing"in n)||!!n.trailing,T="maxWait"in n,g="debounceOnServer"in n&&!!n.debounceOnServer,b=T?Math.max(+n.maxWait||0,t):null;(0,r.useEffect)((function(){return m.current=!0,function(){m.current=!1}}),[]);var E=(0,r.useMemo)((function(){var e=function(e){var t=c.current,n=i.current;return c.current=i.current=null,l.current=e,u.current=d.current.apply(n,t)},n=function(e,t){p&&cancelAnimationFrame(o.current),o.current=p?requestAnimationFrame(e):setTimeout(e,t)},r=function(e){if(!m.current)return!1;var n=e-a.current;return!a.current||n>=t||n<0||T&&e-l.current>=b},E=function(t){return o.current=null,x&&c.current?e(t):(c.current=i.current=null,u.current)},N=function e(){var s=Date.now();if(r(s))return E(s);if(m.current){var o=t-(s-a.current),c=T?Math.min(o,b-(s-l.current)):o;n(e,c)}},w=function(){if(h||g){var d=Date.now(),p=r(d);if(c.current=[].slice.call(arguments),i.current=s,a.current=d,p){if(!o.current&&m.current)return l.current=a.current,n(N,t),f?e(a.current):u.current;if(T)return n(N,t),e(a.current)}return o.current||n(N,t),u.current}};return w.cancel=function(){o.current&&(p?cancelAnimationFrame(o.current):clearTimeout(o.current)),l.current=0,c.current=a.current=i.current=o.current=null},w.isPending=function(){return!!o.current},w.flush=function(){return o.current?E(Date.now()):u.current},w}),[f,T,t,b,x,p,h,g]);return E}function a(e,t){return e===t}function l(e,t,n){var l=n&&n.equalityFn||a,o=(0,r.useRef)(e),c=(0,r.useState)({})[1],i=s((0,r.useCallback)((function(e){o.current=e,c({})}),[c]),t,n),u=(0,r.useRef)(e);return l(u.current,e)||(i(e),u.current=e),[o.current,i]}}}]);
//# sourceMappingURL=481.d93540b5.chunk.js.map