import { useEffect, useState } from 'react'
import Table from 'components/ui/Table'
import { Button, Input, Notification, Select, toast } from 'components/ui'
import {
    apiGetStarCastTypemaster,
    apiGetStarCastmaster,
    apiStarcastmasterDrop,
    apicontentepsrestriction,
} from 'services/ProgrammingService'
import { useSelector } from 'react-redux'
import { openNotification } from 'views/Controls/GLOBALFUNACTION'

const { Tr, Th, Td, THead, TBody } = Table
const THD = [
    {
        name: 'StarCast Type 123',
    },
    {
        name: 'StarCast',
    },
    {
        name: 'Action',
    },
]


const MapStarcastPop = () => {
    const { Content } = useSelector((state) => state.base.common)
    const [sMapStarcast, setMapStarcast] = useState([])
    const [StarCastType, setStarCastType] = useState('')
    const [StartCast, setStartCast] = useState('')
    const [StarCastTypeList, setStarCastTypeList] = useState([])
    const [StarCastList, setStarCastList] = useState([])
    useEffect(() => {
        ; (async (values) => {
            const StarCastTypeList = await apiGetStarCastTypemaster(values)

            const formattedOptions = StarCastTypeList.data.map((option) => ({
                value: option.StarCastTypeCode,
                label: option.StarCastTypeName,
            }))
            setStarCastTypeList(formattedOptions)
        })()


    }, [])
    const StarCastListgetapi = async (id) => {
        const StarCastList = await apiStarcastmasterDrop(id)
        const formattedOptions = StarCastList.data.map((option) => ({
            value: option.StarCastCode,
            label: option.StarCastName,
        }))
        setStarCastList(formattedOptions)
    }
    const handleAdd = () => {
        if (!StarCastType || !StartCast) {
            openNotification('danger', ` All Field Are Required`)
        } else {
            const newData = {
                StarCastType: StarCastType, // provide the value from the input field for Season
                StartCast: StartCast, // provide the value from the input field for End
            }
            setMapStarcast([...sMapStarcast, newData])
        }

        setStarCastType('')
        setStartCast('')
    }
    return (
        <div>
            <Table
                compact
                style={{
                    height: 'auto',
                }}
            >
                <THead>
                    <Tr>
                        {THD.map((Td, index) => (
                            <Th key={index}>{Td.name}</Th>
                        ))}
                    </Tr>
                </THead>
                <TBody>
                    <Tr>
                        <Td>
                            <Select
                                options={StarCastTypeList}
                                value={StarCastTypeList.find(
                                    (option) => option.value === StarCastType
                                )}
                                onChange={(e) => {
                                    setStarCastType(e.value)
                                    StarCastListgetapi(e.value)
                                }}
                            />
                        </Td>
                        <Td>
                            <Select
                                options={StarCastList}
                                value={StarCastList.find(
                                    (option) => option.value === StartCast
                                )}
                                onChange={(e) => setStartCast(e.value)}
                            />
                        </Td>
                        <Td>
                            <Button
                                size="xs"
                                onClick={() => handleAdd()}
                                type="button"
                            >
                                Add
                            </Button>
                        </Td>
                    </Tr>
                    {sMapStarcast.map((e, index) => (
                        <Tr key={index} style={{ border: '1px solid #E3E5EB' }}>
                            <Td style={{ border: '1px solid #E3E5EB' }}>
                                {e.StarCastType}
                            </Td>
                            <Td style={{ border: '1px solid #E3E5EB' }}>
                                {e.StartCast}
                            </Td>
                        </Tr>
                    ))}
                </TBody>
            </Table>
        </div>
    )
}
export default MapStarcastPop
