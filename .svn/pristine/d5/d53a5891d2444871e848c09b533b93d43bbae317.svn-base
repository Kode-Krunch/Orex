"use strict";(self.webpackChunkelstar=self.webpackChunkelstar||[]).push([[2773],{32773:(e,t,o)=>{o.r(t),o.d(t,{default:()=>C});var s=o(2803),a=o(54748),n=o(43235),i=o(72791),r=o(60364),l=o(87350),c=o(81320),d=o(91615),u=o(21260),h=o(80184);const C=e=>{let{isOpen:t,setIsOpen:o}=e;const{page:C,date:p,setShowLoader:m,executeOperation:g}=(0,i.useContext)(d.Z),v=(0,r.useSelector)((e=>e.locale.selectedChannel)),[w,f]=(0,i.useState)([]),[N,S]=(0,i.useState)({value:"",label:""});(0,i.useEffect)((()=>{t&&E((0,a.Tk)(p))}),[v,t]);const x=()=>{try{if(C)return C===u.pagesEnum.PROMO?"PromoScheduling":C===u.pagesEnum.SONG?"SongScheduling":C===u.pagesEnum.NTC?"NTCScheduling":"TransmissionLog"}catch(e){throw e}},E=async e=>{try{let o;if(m(!0),o=C===u.pagesEnum.COMMERCIAL?await(0,l.f7)(v,e):await(0,l.DD)({LocationCode:v.LocationCode,ChannelCode:v.ChannelCode,FormName:x(),TelecastDate:e}),200===o.status){var t;const e=null===(t=o.data)||void 0===t?void 0:t.map((e=>({value:e.D_date.substr(0,23),label:(0,n.WU)(new Date(e.D_date),"dd-MMM-yyyy - HH:mm:ss")})));f([...e])}else 204===o.status&&((0,c.openNotification)("info","Previous version not found."),f([]));m(!1)}catch(o){(0,c.openNotification)("danger","Something went wrong while fetching previous versions"),m(!1)}},L=()=>{try{S({value:"",label:""}),o(!1)}catch(e){console.error(e)}};return(0,h.jsxs)(s.Vq,{isOpen:t,onClose:L,onRequestClose:L,children:[(0,h.jsx)("h5",{className:"mb-4",children:"Restore Previous Version"}),(0,h.jsxs)("p",{className:"text-white mb-1",children:["Versions ",(0,h.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,h.jsx)(s.Ph,{placeholder:"Select",options:w,onChange:e=>S(e),size:"sm"}),(0,h.jsx)("div",{className:"text-right mt-6",children:(0,h.jsx)(s.zx,{variant:"solid",disabled:!N.value,onClick:async()=>{try{let e;m(!0),e=C===u.pagesEnum.COMMERCIAL?await(0,l.cn)({LocationCode:v.LocationCode,ChannelCode:v.ChannelCode,ScheduleDate:(0,a.Tk)(p),D_date:N.value}):await(0,l.FN)({LocationCode:v.LocationCode,ChannelCode:v.ChannelCode,FormName:x(),TelecastDate:(0,a.Tk)(p),D_date:N.value}),200===e.status?(await g({operation:u.operationTypesEnum.INITIALIZE_SCHEDULER,isGenerateLog:!1,mode:"Edit"}),(0,c.openNotification)("success","Restored previous version successfully.")):204!==e.status&&(0,c.openNotification)("danger","Something went wrong while restoring previous version. Server responded with status code ".concat(e.status)),L(),m(!1)}catch(e){(0,c.openNotification)("danger","Something went wrong while restoring previous version"),m(!1)}},children:"Restore"})})]})}}}]);
//# sourceMappingURL=2773.d31804cc.chunk.js.map