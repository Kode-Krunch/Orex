"use strict";(self.webpackChunkelstar=self.webpackChunkelstar||[]).push([[8315],{54301:(e,a,t)=>{t.d(a,{Z:()=>r});var s=t(72791),l=t(80184);const r=e=>{let{date:a,Name:t=""}=e;const r=(0,s.useCallback)((()=>{const e=new Date,s=((e,a)=>{const t="Admin"===a?new Date:new Date(e);return t.setHours(23,59,0,0),t})(a,t),l=s-e;return l>0?{days:Math.floor(l/864e5),hours:Math.floor(l%864e5/36e5),minutes:Math.floor(l%36e5/6e4),seconds:Math.floor(l%6e4/1e3)}:{days:0,hours:0,minutes:0,seconds:0}}),[a,t]),[n,o]=(0,s.useState)(r());(0,s.useEffect)((()=>{const e=setInterval((()=>{o(r())}),1e3);return()=>clearInterval(e)}),[r]);const i=[{unit:"Days",value:n.days},{unit:"Hours",value:n.hours},{unit:"Min",value:n.minutes},{unit:"Sec",value:n.seconds}];return(0,l.jsx)("div",{className:"flex justify-between mb-2",children:i.map((e=>{let{unit:a,value:t}=e;return(0,l.jsxs)("div",{className:"text-center px-4 py-2 dark:bg-[#191F31] bg-[#191F31]` dark:text-[#307EF3] text-[#307EF3] min-w-[58px] mr-3",children:[(0,l.jsx)("p",{className:"text-sm font-extrabold",children:t}),(0,l.jsx)("span",{className:"text-[0.7rem] font-semibold  text-slate-400 dark:text-slate-400",children:a})]},a)}))})}},46069:(e,a,t)=>{t.d(a,{Z:()=>o});var s=t(1413),l=t(72791),r=t(2803),n=t(80184);const o=e=>{let{progression:a}=e;const t=(0,l.useMemo)((()=>a<100?{color:"green-500"}:100==a?{color:"blue-500"}:a>100?{color:"red-500"}:{}),[a]);return(0,n.jsx)(r.Ex,(0,s.Z)({size:"sm",percent:a},t))}},78315:(e,a,t)=>{t.r(a),t.d(a,{default:()=>M});var s=t(1413),l=t(72791),r=t(9494),n=t(25808),o=t(94604),i=t(60364),d=t(81320),c=t(20724),m=t(27450),x=t(97261),u=t(2803),h=t(39126),p=t(16856),b=t(57689),v=t(95717),f=t(25123),j=t(54301),N=t(46069),g=t(80184);const k=e=>{let{deals:a,onShowDetails:t}=e;const s=(0,b.s0)(),l=(0,i.useDispatch)();return(0,g.jsxs)("div",{className:"col-span-3 web-card px-5 py-3 slider-container h-[380px] dark:bg-[#1f2639] bg-[#fff]",children:[(0,g.jsxs)("h6",{className:"pb-3 mt-3 flex items-center border-b border-gray-500",children:[(0,g.jsx)(p.dKE,{className:"mr-2",size:23}),"Expiring Deal"]}),(0,g.jsx)(v.Z,{dots:!0,infinite:a.length>1,speed:500,slidesToShow:a.length>1?1:a.length,slidesToScroll:1,children:a.map(((e,a)=>{var r;return(0,g.jsx)("div",{children:(0,g.jsxs)("div",{className:"ml-3",children:[(0,g.jsxs)("div",{className:"flex items-center mt-5 mb-2",children:[(0,g.jsx)("p",{className:"text-base  font-semibold cursor-pointer dark:!text-white text-black",onClick:()=>{l((0,f.Us)(e)),s("/DealMasterAdd")},children:e.DealCode}),(0,g.jsx)("div",{className:"ml-5",children:(0,g.jsx)(u.u,{title:"Show Details",children:(0,g.jsx)(u.zx,{shape:"circle",icon:(0,g.jsx)(h.DpK,{className:"text-xs "}),size:"xs",className:"!h-5 !w-5",onClick:()=>t(e)})})})]}),(0,g.jsxs)("p",{className:"text-2xl  font-semibold dark:!text-white text-black",children:[e.CurrencySymbol,null===(r=e.TotalAmount)||void 0===r?void 0:r.toLocaleString("en-IN")]}),(0,g.jsx)("div",{className:"flex mt-2 items-center text-sm font-medium px-2 py-3 dark:bg-[#21283b] bg-[#2e62f188] text-black dark:text-[#307EF3]",children:e.AgencyName}),(0,g.jsx)("h1",{className:"text-xl mt-3 mb-4 font-semibold dark:!text-white text-black",children:"Deal Expires In"}),(0,g.jsx)(j.Z,{date:e.DealPeriodToDate}),(0,g.jsx)(N.Z,{progression:Math.round(e.BalanceAmount/e.TotalAmount*100)})]})},a)}))})]})},y=e=>{let{data:a,keyS:t,name:s}=e;return(0,g.jsxs)("div",{className:"mt-3",children:[(0,g.jsxs)("div",{className:"flex justify-between items-center px-2 py-2 dark:!bg-[#191f31] bg-white",style:{borderBottom:"1px solid #9d9d9d7a"},children:[(0,g.jsx)("p",{className:"font-semibold dark:!text-white text-black",children:s}),(0,g.jsx)("p",{className:"font-semibold dark:!text-white text-black",children:"Amount"})]}),(0,g.jsx)("div",{style:{height:250},className:"overflow-hidden hover:overflow-y-scroll  hover:overflow-x-scroll hover:pr-2",children:a&&a.map(((e,a)=>{var s;return(0,g.jsxs)("div",{className:"flex justify-between items-center px-1 py-2",style:{borderBottom:"1px solid #9d9d9d7a",borderStyle:"dashed"},children:[(0,g.jsx)(u.u,{title:e[t],placement:"top-start",children:(0,g.jsxs)("div",{className:"flex items-center",children:[(0,g.jsx)(u.qE,{size:"sm",className:"mr-2 dark:".concat(e.color," ").concat(e.color," dark:!text-white text-black"),children:e[t].slice(0,1)}),(0,g.jsx)("p",{className:"font-semibold text-xs dark:!text-white text-black",style:{width:160,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:e[t]})]})}),(0,g.jsxs)("p",{className:"font-semibold text-md dark:!text-white text-black",children:["\u20b9",null===(s=e.TotalAmount)||void 0===s?void 0:s.toLocaleString("en-IN"),".00"]})]},a)}))})]})},{TabNav:w,TabList:D,TabContent:C}=u.mQ,S=e=>{let{topAgencies:a,topClients:t}=e;return(0,g.jsx)("div",{style:{borderRadius:".5rem",padding:"10px"},className:"col-span-3 web-card dark:!bg-[#1f2639] !bg-[#fff] px-5 py-3",children:(0,g.jsxs)(u.mQ,{defaultValue:"tab1",children:[(0,g.jsxs)(D,{children:[(0,g.jsx)(w,{value:"tab1",icon:(0,g.jsx)(h.t$p,{}),children:"Top Agency"}),(0,g.jsx)(w,{value:"tab2",icon:(0,g.jsx)(h.hpB,{}),children:"Top Client"})]}),(0,g.jsxs)("div",{className:"px-4",children:[(0,g.jsx)(C,{value:"tab1",children:(0,g.jsx)(y,{data:a,keyS:"AgencyName",name:"Agency Name"})}),(0,g.jsx)(C,{value:"tab2",children:(0,g.jsx)(y,{data:t,keyS:"ClientName",name:"Client Name"})})]})]})})};var A=t(56355),E=t(13496);const T=e=>{let{salesData:a=[],chartRef:t}=e;const s=(0,l.useMemo)((()=>{var e;return{plotOptions:{bar:{horizontal:!1,columnWidth:"30%",borderRadius:4}},colors:["#4675bb"],dataLabels:{enabled:!1},stroke:{show:!0,width:2,colors:["transparent"]},xaxis:{categories:a.length>0&&(null===(e=a[0])||void 0===e?void 0:e.monthNames)||[]},fill:{opacity:.9},tooltip:{y:{formatter:e=>"".concat(e," Lakh")}}}}),[a]);return(0,g.jsxs)("div",{className:"col-span-3 web-card dark:!bg-[#1f2639] !bg-[#fff] px-2 py-2  h-[380px]",children:[(0,g.jsxs)("h6",{className:"pb-3 mt-3 flex items-center border-b border-gray-600",children:[(0,g.jsx)(A.NMh,{className:"mr-2",size:23}),"Sales In Month ",(0,g.jsx)("span",{className:"text-xs ml-2",children:"[Lakh]"})]}),a.length>0?(0,g.jsx)(E.Z,{ref:t,options:s,series:a,height:"85%",width:"100%",type:"bar"}):(0,g.jsx)("p",{className:"text-center text-gray-500 mt-10",children:"No sales data available"})]})},Z=[{id:"01",name:"Jan"},{id:"02",name:"Feb"},{id:"03",name:"Mar"},{id:"04",name:"Apr"},{id:"05",name:"May"},{id:"06",name:"Jun"},{id:"07",name:"Jul"},{id:"08",name:"Aug"},{id:"09",name:"Sep"},{id:"10",name:"Oct"},{id:"11",name:"Nov"},{id:"12",name:"Dec"}],M=()=>{const e=(0,l.useRef)(null),a=(0,i.useSelector)((e=>e.locale.selectedChannel)),[t,u]=(0,l.useState)([]),[h,p]=(0,l.useState)([]),[b,v]=(0,l.useState)([{monthNames:[]}]),[f,j]=(0,l.useState)([]),[N,y]=(0,l.useState)(!1),[w,D]=(0,l.useState)({DealNumber:"",DealCode:""}),C=(0,l.useCallback)((async()=>{if(!a)return;const e={par_LocationCode:a.LocationCode,par_ChannelCode:a.ChannelCode};try{var t,l,n;const[a,h,b,f]=await Promise.allSettled([(0,r.apiCallstoreprocedure)("USP_DEAL_GetTopAgencyClient",(0,s.Z)((0,s.Z)({},e),{},{par_Flag:"CLIENT"})),(0,r.apiCallstoreprocedure)("USP_DEAL_GetTopAgencyClient",(0,s.Z)((0,s.Z)({},e),{},{par_Flag:"AGENCY"})),(0,r.apiCallstoreprocedure)("usp_Deal_GetMonthlySales",e),(0,r.apiCallstoreprocedure)("USP_DEAL_GetExpiringDeal",e)]);if("fulfilled"===a.status&&null!==(t=a.value)&&void 0!==t&&t.data){const e=a.value.data.map((e=>(0,s.Z)({color:(0,x.H)()},e)));u(e)}else console.error("Failed to fetch Top Clients:",a.reason);if("fulfilled"===h.status&&null!==(l=h.value)&&void 0!==l&&l.data){const e=h.value.data.map((e=>(0,s.Z)({color:(0,x.H)()},e)));p(e)}else console.error("Failed to fetch Top Agencies:",h.reason);var o,i,c,m;if("fulfilled"===b.status&&null!==(n=b.value)&&void 0!==n&&n.data?v([{name:"Revenue",data:b.value.data.map((e=>e.TotalSalesAmount)),monthNames:b.value.data.map((e=>A(e.SalesMonth))).filter(Boolean)}]):console.error("Failed to fetch Sales Data:",b.reason),"fulfilled"===f.status)204===(null===(o=f.value)||void 0===o?void 0:o.status)?j([]):200===(null===(i=f.value)||void 0===i?void 0:i.status)&&j(f.value.data.slice(0,3));else console.error("Failed to fetch Expiring Deals:",f.reason),404===(null===(c=f.reason)||void 0===c||null===(m=c.response)||void 0===m?void 0:m.status)&&(0,d.openNotification)("warning","Deal Not Found"),j([])}catch(h){console.error("Unexpected error in fetchData:",h)}}),[a]),A=e=>{var a;return(null===(a=Z.find((a=>a.id===e)))||void 0===a?void 0:a.name)||null};return(0,l.useEffect)((()=>{C()}),[C]),(0,l.useEffect)((()=>{var a;null!==(a=e.current)&&void 0!==a&&a.chart&&e.current.chart.windowResizeHandler()}),[b]),(0,g.jsxs)("div",{children:[(0,g.jsx)(c.Z,{Name:"Deal Dashboard",Page:"Deal",Links:"Deal"}),(0,g.jsx)("div",{className:"grid grid-cols-".concat(o.JJ.length," gap-4"),children:(0,g.jsx)(n.Z,{shortcuts:o.JJ})}),(0,g.jsxs)("div",{className:"grid grid-cols-9 gap-4",children:[(0,g.jsx)(k,{deals:f,onShowDetails:e=>{D({DealNumber:e.DealNumber,DealCode:e.DealCode}),y(!0)}}),(0,g.jsx)(S,{topAgencies:h,topClients:t}),(0,g.jsx)(T,{salesData:b,chartRef:e})]}),N&&(0,g.jsx)(m.Z,{isDialogOpen:N,setIsDialogOpen:y,dealNumber:w.DealNumber,dealCode:w.DealCode})]})}}}]);
//# sourceMappingURL=8315.6df7cc27.chunk.js.map