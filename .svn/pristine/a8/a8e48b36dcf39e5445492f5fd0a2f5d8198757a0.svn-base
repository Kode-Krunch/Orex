"use strict";(self.webpackChunkelstar=self.webpackChunkelstar||[]).push([[3988,5682],{45682:(e,t,a)=>{a.r(t),a.d(t,{default:()=>s});var r=a(2803),n=(a(72791),a(80184));const s=function(e){let{showLoader:t}=e;return(0,n.jsx)(n.Fragment,{children:t?(0,n.jsx)("div",{className:"dialog-overlay flex justify-center items-center z-50",children:(0,n.jsx)(r.$j,{size:"3.25rem"})}):(0,n.jsx)(n.Fragment,{})})}},93988:(e,t,a)=>{a.r(t),a.d(t,{default:()=>p});var r=a(1413),n=a(72791),s=a(60364),i=a(2803),o=a(56355),l=a(16856),d=a(67388),c=a(81320),m=a(57689),u=a(45682),h=a(80184);const{Tr:x,Th:j,Td:v,THead:S,TBody:C}=i.iA,N=Array.from({length:12},((e,t)=>({value:"".concat(5*(t+1)),label:"".concat(5*(t+1))}))),p=()=>{const e=(0,m.s0)(),{Content:t}=(0,s.useSelector)((e=>e.base.common)),a=(0,s.useSelector)((e=>e.auth.session.ChannelSetting)),[p,g]=(0,n.useState)([]),[f,P]=(0,n.useState)(!1),[b,y]=(0,n.useState)((null===t||void 0===t?void 0:t.PatternName)||""),[D,k]=(0,n.useState)((null===t||void 0===t?void 0:t.minFormat)||""),[w,A]=(0,n.useState)(""),[T,z]=(0,n.useState)(1),[B,E]=(0,n.useState)(1),F=()=>(e=>{const t=Math.floor(e/25),a=e%25;return[Math.floor(t/3600),Math.floor(t%3600/60),t%60,a].map((e=>String(e).padStart(2,"0"))).join(":")})(p.reduce(((e,t)=>e+("BREAK"===t.EventType?(e=>{const[t,a,r,n]=e.split(":").map(Number);return 3600*t*25+60*a*25+25*r+n})(t.EventDuration):0)),0)),I=e=>{const t={PatternCode:0,OrderNo:p.length,EventCode:0,EventType:e,EventDuration:"BREAK"===e?w:"00:00:00:00",StartTime:(new Date).toISOString(),PatternType:"NA",SegComNumber:"Content Segment"===e?B:0,ComBreakNumber:"BREAK"===e?T:0,IsActive:1};g([...p,t]),"BREAK"===e&&z(T+1),"Content Segment"===e&&E(B+1)};(0,n.useEffect)((()=>{(async()=>{if(null!==t&&void 0!==t&&t.PatternCode){const e=(await(0,d.apiGetpatterndetailsmasterbyid)(t.PatternCode)).data.map((e=>(0,r.Z)((0,r.Z)({},e),{},{IsActive:1})));g(e)}})()}),[]);return(0,h.jsxs)(i.Zb,{header:"Add Break Pattern",children:[(0,h.jsx)(u.default,{showLoader:f}),(0,h.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("h6",{children:"Name"}),(0,h.jsx)(i.II,{size:"sm",value:b,onChange:e=>y(e.target.value)})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("h6",{children:"Format (Mins)"}),(0,h.jsx)(i.Ph,{size:"sm",options:N,value:N.find((e=>e.value===D)),onChange:e=>k(e.value)})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("h6",{children:"Commercial Duration"}),(0,h.jsx)(i.II,{size:"sm",value:w,onChange:e=>(0,c.handleChangeWithFrameSingleValue)(e,A),onBlur:e=>{var t;return A((0,c.formatOnHHMMSSFFBlur)(e.target.value,Number((null===(t=a[0])||void 0===t?void 0:t.FramePerSec)||24)))}})]})]}),(0,h.jsxs)("div",{className:"flex justify-end mt-5 mb-5",children:[(0,h.jsx)(i.zx,{variant:"solid",size:"sm",className:"mr-2",onClick:()=>I("BREAK"),children:"Add Break"}),(0,h.jsx)(i.zx,{variant:"twoTone",size:"sm",onClick:()=>I("Content Segment"),children:"Add Segment"})]}),(0,h.jsx)(i.Zb,{header:"Pattern Details",children:(0,h.jsxs)(i.iA,{compact:!0,borderlessRow:!1,children:[(0,h.jsx)(S,{children:(0,h.jsxs)(x,{children:[(0,h.jsx)(j,{children:"Sr No"}),(0,h.jsx)(j,{children:"EventType"}),(0,h.jsx)(j,{children:"EventDuration"}),(0,h.jsx)(j,{children:"SegComNumber"}),(0,h.jsx)(j,{children:"ComBreakNumber"}),(0,h.jsx)(j,{children:"Action"})]})}),(0,h.jsx)(C,{children:p.length>0?p.map(((e,t)=>(0,h.jsxs)(x,{children:[(0,h.jsx)(v,{children:e.OrderNo+1}),(0,h.jsx)(v,{children:e.EventType}),(0,h.jsx)(v,{children:e.EventDuration}),(0,h.jsx)(v,{children:e.SegComNumber}),(0,h.jsx)(v,{children:e.ComBreakNumber}),(0,h.jsx)(v,{children:(0,h.jsx)(i.zx,{size:"xs",type:"button",onClick:()=>(e=>{g(p.filter(((t,a)=>a!==e)))})(t),icon:(0,h.jsx)(o.AMf,{})})})]},t))):(0,h.jsx)(x,{children:(0,h.jsx)(v,{colSpan:"6",children:"No Rows Found"})})})]})}),(0,h.jsxs)("div",{className:"flex justify-between mt-5 mb-5",children:[(0,h.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,h.jsx)(i.zx,{size:"sm",className:"mr-2",icon:(0,h.jsx)(l.KYK,{}),onClick:()=>e("/BreakPatternMaster"),children:"Discard"}),(0,h.jsx)(i.zx,{variant:"solid",size:"sm",icon:(0,h.jsx)(o.ZNz,{}),onClick:async()=>{P(!0);const a={PatternName:b,ActualDuration:"08:59:12.638Z",TotalDuration:F(),minFormat:D,NoOfSeg:0,CommercialDuration:F(),SegmentDuration:"00:00:00:00",TotalDurInSec:(0,c.parseDuration)(F()),KillDate:"2024-12-27T08:59:12.638Z",ProgramType:0,IsActive:1},n=null!==t&&void 0!==t&&t.PatternCode?await(0,d.PutpatternNew)(a,t.PatternCode):await(0,d.PostpatternNew)(a);if(200===n.status){const a=(null===t||void 0===t?void 0:t.PatternCode)||n.data.PatternCode,s=p.map((e=>(0,r.Z)((0,r.Z)({},e),{},{PatternCode:a,StartTime:new Date})));200===(await(0,d.PostpatternDeatilsNew)(s,a)).status?((0,c.openNotification)("success","Pattern Saved Successfully"),e("/BreakPatternMaster"),P(!1)):((0,c.openNotification)("error","Pattern Details already exist"),P(!1))}else(0,c.openNotification)("error","Pattern Name already exists"),P(!1)},children:"Save"})]}),(0,h.jsxs)(i.Vp,{showCloseButton:!1,className:"text-xl bg-emerald-100 text-emerald-600 dark:bg-emerald-500/20 dark:text-emerald-100 border-0 rounded",children:["Total Duration: ",F()]})]})]})}}}]);
//# sourceMappingURL=3988.f3b729f7.chunk.js.map